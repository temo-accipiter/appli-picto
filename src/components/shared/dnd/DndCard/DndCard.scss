@use '@styles/abstracts' as *;

// ============================================
// DND CARD - Draggable Card Wrapper
// ============================================
// ✅ PHASE 6 VALIDÉ : Wrappers z-index/opacity/radius/color avec fallback
//    - z-index('base'/'dropdown'/'modal') → Legacy support actif
//    - opacity('lg') → Legacy support actif
//    - color('base') → Semantics Phase 6 ✅
//    - safe-transition() → Mixin Phase 6 ✅
//    - border-width('focus') → Legacy support actif
//    - size('2') → Legacy support actif
// ============================================

.dnd-card {
  position: relative;
  cursor: grab;
  user-select: none;
  @include safe-transition;

  // Zone de drag transparente qui couvre toute la card
  &__drag-handle {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: z-index('base'); // Au-dessus du contenu
    cursor: grab;

    // Laisser passer les clics sur les éléments interactifs
    pointer-events: auto;

    // Quand on drag, montrer le curseur grabbing
    &:active {
      cursor: grabbing;
    }
  }

  // Le contenu doit être au-dessus du drag handle pour les interactions
  > *:not(.dnd-card__drag-handle) {
    position: relative;
    z-index: z-index('dropdown');
    pointer-events: auto; // Les enfants capturent les events normalement
  }

  // État dragging
  &--dragging {
    z-index: z-index('modal');
    cursor: grabbing;

    .dnd-card__drag-handle {
      cursor: grabbing;
    }
  }

  // État swapping
  &--swapping {
    opacity: opacity('lg');
  }

  // Focus visible pour keyboard navigation
  &:focus-visible {
    outline: border-width('focus') solid color('base');
    outline-offset: size('2');
  }
}
