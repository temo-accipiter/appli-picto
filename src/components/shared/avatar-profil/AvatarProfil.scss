@use '@styles/abstracts' as *;

// ============================================
// AVATAR PROFIL - REDESIGN MODERNE 2025
// Taille responsive: 120px mobile → 160px desktop
// ============================================
// ✅ PHASE 6 VALIDÉ : Wrappers size/radius/border/color/surface/shadow avec fallback
//    - size('avatar-md'/'avatar-lg'/'touch-target-optimal'/'touch-target-min') → Legacy support actif
//    - radius('full'/'sm') → Primitives Phase 6 (50%/6px) ✅
//    - color('base'/'light') → Semantics Phase 6 ✅
//    - surface('soft') → Semantics Phase 6 ✅
//    - text('invert') → Semantics Phase 6 (#ffffff) ✅
//    - spacing('xs'/'sm'/'md'/'lg') → Primitives Phase 6 (4px/8px/16px/24px) ✅
//    - shadow('elevation-md'/'elevation-lg') → Primitives Phase 6 ✅
//    - semantic('error', all variants) → Semantics Phase 6 ✅
//    - timing('fast') → Primitives Phase 6 (0.15s) ✅
//    - easing('ease-out') → Primitives Phase 6 ✅
//    - safe-transition() → Mixin Phase 6 ✅
//    - focus-ring() → Mixin Phase 6 ✅
//    - respond-to() → Mixin responsive Phase 6 ✅
//    - border-width('thick'/'base'/'thin'/'focus') → Legacy support actif
//    - font-size('5xl'/'base'/'lg'/'sm') → Legacy support actif
//    - font-weight('bold'/'medium') → Legacy support actif
//    - z-index('dropdown') → Legacy support actif
// ============================================

.avatar-container {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

// === AVATAR IMAGE & FALLBACK ===
.avatar-profil,
.avatar-fallback {
  // Mobile par défaut (320px-767px)
  width: size('avatar-md');
  height: size('avatar-md');
  font-size: font-size('5xl');

  // Styles communs
  border-radius: radius('full');
  border: border-width('thick') solid color('base');
  background-color: surface('soft');
  object-fit: cover;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: font-weight('bold');
  color: text();
  box-shadow: shadow('elevation-md');
  @include safe-transition(
    transform box-shadow border-color,
    timing('fast'),
    easing('ease-out')
  );

  // Tablette & Desktop (768px+)
  @include respond-to(md) {
    width: size('avatar-lg');
    height: size('avatar-lg');
    font-size: font-size('5xl');
    border-width: border-width('thick');
  }

  // Effet hover léger
  &:hover {
    transform: scale(1.02);
    box-shadow: shadow('elevation-lg');
    border-color: color('light');
  }
}

// === BUTTONS OVERLAY ===
.avatar-upload-btn,
.avatar-delete-btn {
  position: absolute;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: radius('full');
  padding: 0;
  font-size: font-size('base');
  line-height: 1;
  z-index: z-index('dropdown');
  cursor: pointer;
  border: border-width('base') solid text('invert');
  @include safe-transition(
    transform box-shadow,
    timing('fast'),
    easing('ease-out')
  );
  @include focus-ring(color('base'), border-width('focus'), size('2'));

  // Mobile par défaut (320px-767px)
  width: size('touch-target-optimal');
  height: size('touch-target-optimal');

  // Tablette & Desktop (768px+)
  @include respond-to(md) {
    width: size('touch-target-min');
    height: size('touch-target-min');
    font-size: font-size('lg');
  }

  &:hover,
  &:focus {
    transform: scale(1.15);
    box-shadow: shadow('elevation-lg');
  }

  &:active {
    transform: scale(1.05);
  }
}

.avatar-upload-btn {
  // Mobile par défaut
  bottom: calc(#{spacing('xs')} * -1);
  right: calc(#{spacing('xs')} * -1);
  background: linear-gradient(135deg, color('base'), color('light'));
  color: text('invert');

  &:hover {
    box-shadow: shadow('elevation-lg');
  }

  // Tablette & Desktop (768px+)
  @include respond-to(md) {
    bottom: calc(#{spacing('sm')} * -1);
    right: calc(#{spacing('sm')} * -1);
  }
}

.avatar-delete-btn {
  // Mobile par défaut
  top: calc(#{spacing('xs')} * -1);
  right: calc(#{spacing('xs')} * -1);
  background: linear-gradient(
    135deg,
    semantic('error'),
    semantic('error', 'dark')
  );
  color: text('invert');

  &:hover {
    box-shadow: shadow('elevation-lg');
  }

  // Tablette & Desktop (768px+)
  @include respond-to(md) {
    top: calc(#{spacing('sm')} * -1);
    right: calc(#{spacing('sm')} * -1);
  }
}

// === MESSAGE ERREUR ===
.message-erreur {
  white-space: pre-line;
  margin-top: spacing('md');
  padding: spacing('sm') spacing('md');
  background: semantic('error', 'bg');
  border: border-width('thin') solid semantic('error');
  border-radius: radius('sm');
  color: semantic('error');
  font-size: font-size('sm');
  font-weight: font-weight('medium');
  text-align: center;

  // Tablette & Desktop (768px+)
  @include respond-to(md) {
    padding: spacing('md') spacing('lg');
    font-size: font-size('base');
  }
}

// === ACCESSIBILITY ===
// Réduction mouvement pour utilisateurs TSA
@media (prefers-reduced-motion: reduce) {
  .avatar-profil,
  .avatar-fallback,
  .avatar-upload-btn,
  .avatar-delete-btn {
    transition: none;
    transform: none !important;

    &:hover {
      transform: none !important;
    }
  }
}
