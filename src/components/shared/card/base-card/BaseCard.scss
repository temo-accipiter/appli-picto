@use '@styles/abstracts' as *;

// ============================================
// BASE CARD - TSA-FRIENDLY STYLES
// ============================================
// ✅ PHASE 6 VALIDÉ : Wrappers spacing/radius/shadow/tsa-pastel/semantic avec fallback
//    - spacing('md'/'sm'/'xs') → Primitives Phase 6 (16px/8px/4px) ✅
//    - radius('md') → Primitives Phase 6 (12px) ✅
//    - shadow('elevation-sm'/'elevation-md') → Primitives Phase 6 ✅
//    - tsa-pastel('bg-soft'/'green-soft') → Semantics TSA Phase 6 ✅
//    - semantic('success'/'info'/'error') → Semantics Phase 6 ✅
//    - timing('fast') → Primitives Phase 6 (0.15s) ✅
//    - easing('ease-out') → Primitives Phase 6 ✅
//    - safe-transition() → Mixin Phase 6 ✅
//    - respond-to() → Mixin responsive Phase 6 ✅
//    - text() → Semantics Phase 6 (#1e293b) ✅
//    - border-width('base') → Legacy support actif
//    - font-size('sm'/'base') → Legacy support actif
//    - font-weight('semibold') → Legacy support actif
//    - line-height('snug') → Legacy support actif
//    - opacity('lg'/'half') → Legacy support actif
//    - size('touch-target-min'/'touch-target-optimal') → Legacy support actif
// ============================================

.base-card {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: spacing('md');
  background: tsa-pastel('bg-soft');
  border-radius: radius('md');
  padding: spacing('sm');
  box-shadow: shadow('elevation-sm');
  border: border-width('base') solid transparent;

  @include safe-transition(
    border-color background-color box-shadow,
    timing('fast'),
    easing('ease-out')
  );

  /* [Mobile-first] Responsive sizing */
  &--sm {
    gap: spacing('xs');
    padding: spacing('xs');

    .base-card__label {
      font-size: font-size('sm');
    }
  }

  &--md {
    gap: spacing('sm');
    padding: spacing('sm');
  }

  &--lg {
    gap: spacing('md');
    padding: spacing('md');
  }

  /* États visuels FRANCS pour TSA */
  &--checked {
    border: border-width('base') solid semantic('success');
    background-color: tsa-pastel('green-soft');
  }

  &--completed {
    opacity: opacity('lg');
    border-color: semantic('info');
    background-color: semantic('info', 'bg');
  }

  &--disabled {
    opacity: opacity('half');
    pointer-events: none;
    cursor: not-allowed;
  }

  &--editable {
    /* Retiré : la bordure orange n'est plus appliquée */
  }

  /* Container pour image + actions */
  &__image-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: spacing('xs');
  }

  &__image {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    /* Pas de background, pas de wrapper visible - juste l'image */
  }

  /* Actions : layout optimisé pour mobile (56px touch target min) */
  &__actions {
    display: flex;
    flex-direction: column;
    gap: spacing('xs');
    width: 100%;

    /* Sur desktop : layout horizontal */
    @include respond-to(sm) {
      flex-direction: row;
      justify-content: space-between;
      gap: spacing('sm');
    }

    button,
    [role='checkbox'] {
      min-height: size('touch-target-min'); /* Touch target minimum */
      min-width: size('touch-target-min');
      padding: spacing('xs');

      @include respond-to(sm) {
        min-height: size('touch-target-optimal');
        min-width: auto;
      }
    }
  }

  /* Contenu : label + catégorie */
  &__content {
    display: flex;
    flex-direction: column;
    gap: spacing('sm');
    justify-content: flex-start;
    min-width: 0; /* Force text truncation */
  }

  &__label {
    font-weight: font-weight('semibold');
    font-size: font-size('base');
    line-height: line-height('snug');
    color: text();

    /* Ellipsis sur long texte */
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    word-break: break-word;
    white-space: pre-wrap;
  }

  /* Focus visible pour accessibility clavier (WCAG 2.2 AA - TSA CRITIQUE) */
  &:focus-within {
    box-shadow: shadow('elevation-md');
    outline: border-width('base') solid semantic('info');
    outline-offset: spacing('xs');
  }

  /* Focus visible explicite avec :focus-visible (navigation clavier) */
  &:focus-visible {
    outline: border-width('base') solid semantic('info');
    outline-offset: spacing('xs');
    box-shadow: shadow('elevation-md');
  }
}

/* Mobile-first: Responsiveness déjà gérée par les modifiers --sm, --md, --lg */
