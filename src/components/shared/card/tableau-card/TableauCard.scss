@use '@styles/abstracts' as *;

// ============================================================================
// TABLEAU CARD COMPONENT
// ============================================================================
// âœ… PHASE 6 VALIDÃ‰ : Wrappers radius/spacing/surface avec fallback
//    - radius('md') â†’ Primitives Phase 6 (12px) âœ…
//    - spacing('xs'/'sm'/'md') â†’ Primitives Phase 6 (4px/8px/16px) âœ…
//    - surface('hover') â†’ Semantics Phase 6 âœ…
//    - tsa-pastel('bg-soft') â†’ Legacy TSA support actif
//    - Mobile-first responsive avec respond-to() âœ…
//    - Autres tokens : Legacy support actif
// ============================================================================

.tableau-card {
  // Base card styling
  background: tsa-pastel('bg-soft');
  border-radius: radius('md');
  box-shadow: shadow('elevation-sm');
  border: border-width('base') solid transparent;

  cursor: grab;
  user-select: none;
  position: relative;

  // Override du overflow pour permettre Ã  l'image de dÃ©passer lors du hover
  overflow: visible;

  // Animation d'apparition lors du swap
  animation: card-swap-in timing('base') easing('bounce');

  // Transitions optimisÃ©es pour Ã©viter les sauts
  @include safe-transition(
    transform opacity box-shadow background-color,
    timing('base'),
    easing('ease-out')
  );

  // Drag actif
  &.dragging {
    opacity: opacity('half');
    cursor: grabbing;
    transform: scale(0.98);
    z-index: z-index('modal');
  }

  // Carte cochÃ©e (tÃ¢che accomplie)
  &.done {
    opacity: opacity('half');
    filter: grayscale(100%);

    span {
      text-decoration: line-through;
    }
  }

  // Image avec transition pour le hover
  img,
  .tableau-card__image {
    @include safe-transition(transform, timing('base'), easing('ease-out'));
  }

  // Hover (si non touch)
  @include on-event {
    background-color: surface('hover');
    transform: scale(1.02);

    // Animation de rotation sur l'image au hover
    img,
    .tableau-card__image {
      transform: scale(1.15) rotate(8deg);
    }
  }

  // ðŸ“± Responsive mobile-first
  /* Base = mobile (320px+) */
  padding: spacing('xs');

  /* Tablet (576px+) */
  @include respond-to(sm) {
    padding: spacing('sm');
  }

  /* Desktop (768px+) */
  @include respond-to(md) {
    padding: spacing('md');
  }
}

// Label du tableau
.tableau-card__label {
  font-weight: font-weight('semibold');
  font-size: font-size('sm');
  line-height: line-height('snug');
  word-break: break-word;
}

// Wrapper checkbox - isolÃ© du drag
.tableau-card__checkbox-wrapper {
  pointer-events: auto;
}

// Animation de swap fluide
@keyframes card-swap-in {
  0% {
    opacity: opacity('md');
    transform: scale(0.9);
  }
  100% {
    opacity: opacity('opaque');
    transform: scale(1);
  }
}
