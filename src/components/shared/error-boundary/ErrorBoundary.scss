@use '@styles/abstracts' as *;

// src/components/shared/error-boundary/ErrorBoundary.scss
// Styles TSA-friendly : couleurs pastel, animations douces, layout apaisant

// ============================================================================
// ERROR BOUNDARY COMPONENT
// ============================================================================
// ✅ PHASE 6 VALIDÉ : Wrappers spacing/surface/radius/shadow/text/semantic avec fallback
//    - spacing('xl'/'3xl'/'md'/'sm'/'lg'/'2') → Primitives Phase 6 ✅
//    - surface('bg'/'soft'/'hover'/'border') → Semantics Phase 6 ✅
//    - radius('lg'/'md'/'sm') → Primitives Phase 6 (20px/12px/6px) ✅
//    - shadow('elevation-lg'/'elevation-md') → Primitives Phase 6 ✅
//    - text('muted'/'invert') → Semantics Phase 6 ✅
//    - semantic('error') → Semantics Phase 6 ✅
//    - timing('base'/'fast'/'slower') → Primitives Phase 6 (0.2s/0.15s/1.5s) ✅
//    - easing('ease-out'/'ease-in-out') → Primitives Phase 6 ✅
//    - color('base'/'dark') → Semantics Phase 6 ✅
//    - safe-transition() → Mixin Phase 6 ✅
//    - respond-to() → Mixin responsive Phase 6 ✅
//    - size('modal-width-md'/'touch-target-min'/'card-min-height'/'2') → Legacy support actif
//    - font-size('5xl'/'2xl'/'base'/'sm') → Legacy support actif
//    - font-weight('semibold'/'medium') → Legacy support actif
//    - line-height('snug'/'relaxed') → Legacy support actif
//    - border-width('focus'/'thin') → Legacy support actif
// ============================================================================

.error-boundary {
  // Plein écran centré
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: spacing('xl');
  background: surface('bg');

  &__content {
    max-width: size('modal-width-md');
    text-align: center;
    background: surface('bg');
    padding: spacing('3xl') spacing('xl');
    border-radius: radius('lg');
    box-shadow: shadow('elevation-lg');

    // Animation douce d'apparition (TSA-friendly)
    animation: fadeInScale timing('base') easing('ease-out');
  }

  &__icon {
    font-size: font-size('5xl');
    margin-bottom: spacing('md');

    // Animation douce de balancement
    animation: gentleSwing timing('slower') easing('ease-in-out') infinite;
  }

  &__title {
    font-size: font-size('2xl');
    font-weight: font-weight('semibold');
    color: text();
    margin-bottom: spacing('md');
    line-height: line-height('snug');
  }

  &__message {
    font-size: font-size('base');
    color: text('muted');
    margin-bottom: spacing('xl');
    line-height: line-height('relaxed');
  }

  &__actions {
    display: flex;
    flex-direction: column;
    gap: spacing('sm');
    margin-bottom: spacing('xl');

    @include respond-to(sm) {
      flex-direction: row;
      justify-content: center;
    }
  }

  &__button {
    padding: spacing('sm') spacing('lg');
    font-size: font-size('base');
    font-weight: font-weight('medium');
    border-radius: radius('md');
    border: none;
    cursor: pointer;

    @include safe-transition(
      background-color transform box-shadow,
      timing('fast'),
      easing('ease-out')
    );

    // Taille minimum accessible (WCAG AA)
    min-height: size('touch-target-min');
    min-width: size('card-min-height');

    &:focus {
      outline: border-width('focus') solid color('base');
      outline-offset: size('2');
    }

    &--primary {
      background: color('base');
      color: text('invert');

      &:hover:not(:disabled) {
        background: color('dark');
        transform: translateY(-#{size('2')});
        box-shadow: shadow('elevation-md');
      }

      &:active {
        transform: translateY(0);
      }
    }

    &--secondary {
      background: surface('soft');
      color: text();

      &:hover:not(:disabled) {
        background: surface('hover');
        transform: translateY(-#{spacing('2')});
      }

      &:active {
        transform: translateY(0);
      }
    }
  }

  &__details {
    margin-top: spacing('xl');
    text-align: left;
    background: surface('soft');
    padding: spacing('md');
    border-radius: radius('md');
    border: border-width('thin') solid surface('border');
  }

  &__details-summary {
    cursor: pointer;
    font-weight: font-weight('semibold');
    color: text('muted');
    padding: spacing('sm');
    user-select: none;

    &:hover {
      color: text();
    }
  }

  &__details-content {
    margin-top: spacing('md');
    padding: spacing('md');
    background: surface('bg');
    border-radius: radius('sm');
    font-size: font-size('sm');
    color: semantic('error');
    overflow-x: auto;
    white-space: pre-wrap;
    word-break: break-word;
  }
}

// Animation douce d'apparition (TSA-friendly, max 0.3s)
@keyframes fadeInScale {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

// Animation douce de balancement pour l'icône
@keyframes gentleSwing {
  0%,
  100% {
    transform: rotate(0deg);
  }
  25% {
    transform: rotate(-3deg);
  }
  75% {
    transform: rotate(3deg);
  }
}

// Support prefers-reduced-motion (accessibilité)
@media (prefers-reduced-motion: reduce) {
  .error-boundary__content {
    animation: none;
  }

  .error-boundary__icon {
    animation: none;
  }

  .error-boundary__button {
    transition: none;

    &:hover {
      transform: none;
    }
  }
}
