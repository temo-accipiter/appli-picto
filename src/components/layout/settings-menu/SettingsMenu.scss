@use '@styles/abstracts' as *;

// ============================================================================
// SETTINGS MENU COMPONENT
// ============================================================================
// ✅ PHASE 6 VALIDÉ : Wrappers spacing/surface/radius/shadow/text/timing/respond-to avec fallback
//    - spacing('md'/'sm'/'xs'/'2xl') → Primitives Phase 6 ✅
//    - surface('soft'/'hover'/'border') → Semantics Phase 6 ✅
//    - radius('md'/'lg'/'xs') → Primitives Phase 6 (12px/20px/3px) ✅
//    - shadow('elevation-sm') → Primitives Phase 6 ✅
//    - text() → Semantics Phase 6 ✅
//    - timing('fast'/'base') → Primitives Phase 6 (0.15s/0.2s) ✅
//    - easing('ease-out') → Primitives Phase 6 ✅
//    - safe-transition() → Mixin Phase 6 ✅
//    - respond-to() → Mixin responsive Phase 6 ✅
//    - size('touch-target-min'/'24'/'300'/'4'/'100') → Legacy support actif
//    - border-width('thin'/'base') → Legacy support actif
//    - color('base') → Legacy support actif
//    - a11y('focus-ring-width'/'focus-ring-offset') → Legacy support actif
//    - font-weight('semibold') → Legacy support actif
// ============================================================================

.settings-menu {
  display: inline-block;

  &__trigger {
    display: flex;
    align-items: center;
    justify-content: center;
    width: size('touch-target-min');
    height: size('touch-target-min');
    padding: 0;
    background: surface('soft');
    border: border-width('thin') solid surface('border');
    border-radius: radius('md');
    cursor: pointer;
    color: text();
    @include safe-transition(
      background-color transform box-shadow,
      timing('fast'),
      easing('ease-out')
    );

    &:hover {
      background: surface('hover');
      transform: translateY(calc(-1 * #{border-width('thin')}));
      box-shadow: shadow('elevation-sm');
    }

    &:focus-visible {
      outline: a11y('focus-ring-width') solid color('base');
      outline-offset: a11y('focus-ring-offset');
    }
  }

  // Burger icon (3 barres horizontales)
  &__burger {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: size('24');
    height: size('24');
    gap: spacing('xs');
  }

  &__burger-line {
    display: block;
    width: size('4');
    height: border-width('base');
    background-color: text();
    border-radius: radius('xs');
    @include safe-transition(
      transform opacity,
      timing('base'),
      easing('ease-out')
    );
  }

  // Animation burger → X
  &__trigger--active &__burger-line {
    &:nth-child(1) {
      transform: translateY(spacing('xs')) rotate(45deg);
    }

    &:nth-child(2) {
      opacity: 0;
      transform: scaleX(0);
    }

    &:nth-child(3) {
      transform: translateY(calc(-1 * #{spacing('xs')})) rotate(-45deg);
    }
  }

  // Styles spécifiques pour le dropdown
  &__dropdown {
    // Override les styles du Dropdown pour les besoins de SettingsMenu

    // Mobile par défaut (320px-767px) : positioned bottom-right
    position: fixed !important;
    bottom: spacing('md') !important;
    right: spacing('md') !important;
    left: auto !important;
    top: auto !important;
    width: min(size('300'), 90vw) !important;
    border-radius: radius('lg');
    overflow-y: auto;
    max-height: 70vh;
    animation: slideInUp timing('fast') easing('ease-out') !important;

    // Desktop (768px+) : positioned top-right
    @include respond-to(md) {
      position: fixed !important;
      top: spacing('2xl') !important;
      right: spacing('md') !important;
      left: auto !important;
      bottom: auto !important;
      max-height: calc(100vh - #{size('100')});
      animation: slideInDown timing('fast') easing('ease-out') !important;
    }
  }

  &__header {
    display: flex;
    align-items: center;
    gap: spacing('sm');
    padding: spacing('md');
    border-bottom: border-width('thin') solid surface('border');
    font-weight: font-weight('semibold');
    color: text();
  }

  &__content {
    display: flex;
    flex-direction: column;
    gap: spacing('xs');
    padding: spacing('md');

    // Style wrapper pour les checkboxes dans le menu
    // Utilise le composant Checkbox unifié, ajoute uniquement le style de conteneur
    .checkbox-field {
      padding: spacing('sm') spacing('md');
      background: surface('soft');
      border-radius: radius('md');
      cursor: pointer;
      @include safe-transition(
        background-color transform,
        timing('fast'),
        easing('ease-out')
      );

      &:hover {
        background: surface('hover');
        transform: translateX(spacing('xs'));
      }
    }
  }
}

// Animation pour desktop (depuis le haut)
@keyframes slideInDown {
  from {
    transform: translateY(calc(-1 * #{spacing('xs')}));
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

// Animation pour mobile (depuis le bas)
@keyframes slideInUp {
  from {
    transform: translateY(spacing('xs'));
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}
