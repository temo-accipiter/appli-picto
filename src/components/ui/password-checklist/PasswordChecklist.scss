// src/components/ui/password-checklist/PasswordChecklist.scss
@use '@styles/abstracts' as *;

/// ============================================================================
/// PASSWORD CHECKLIST COMPONENT - Tokens-First
/// ============================================================================
/// Composant checklist validation mot de passe avec états visuels
/// - States: is-ok (validé), is-ko (non validé)
/// - Collapsible avec animation douce
/// - WCAG 2.2 AA compliant (focus visible, contrastes)
/// - TSA-friendly (couleurs pastel, animations ≤ 0.3s, prefers-reduced-motion)
///
/// ✅ CONFORME TOKENS-FIRST : Toutes valeurs via fonctions tokens
/// ✅ PHASE 6 VALIDÉ : Wrappers spacing/radius/surface/text/semantic avec fallback
///    - spacing('sm'/'md'/'lg'/'xs'/'2'/'500') → Primitives Phase 6 ✅
///      (8px/16px/24px/4px/8px/500px collapse)
///    - radius('md'/'lg'/'full') → Primitives Phase 6 (12px/20px/50%) ✅
///    - surface('border'/'surface') → Semantics Phase 6 ✅
///    - text() → Semantics Phase 6 (#1e293b) ✅
///    - semantic('success'/'warning', all variants) → Semantics Phase 6 ✅
///    - size('icon-sm') → Legacy support actif
///    - Mobile-first responsive avec respond-to() ✅
/// ============================================================================

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// TOGGLE BUTTON (COLLAPSIBLE)
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

.password-checklist__toggle {
  // Spacing
  margin-block-start: spacing('sm');
  padding: spacing('sm') spacing('md');

  // Layout
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: spacing('md');

  // Apparence
  background: transparent;
  border: border-width('base') solid surface('border');
  border-radius: radius('md'); // 8px
  text-align: left;

  // Typographie
  font-size: font-size('sm');
  color: text();

  // Accessibilité WCAG AA
  @include touch-target('min');

  // UX
  cursor: pointer;
  @include safe-transition(background-color, timing('fast'), easing('smooth'));

  &:hover {
    background-color: surface('surface'); // Hover subtil
  }

  // Focus WCAG 2.2 AA
  @include focus-ring;
}

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// CHEVRON ICON (COLLAPSE INDICATOR)
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

.password-checklist__chev {
  display: inline-flex;
  align-items: center;
  justify-content: center;

  @include safe-transition(transform, timing('fast'), easing('smooth'));

  svg {
    width: size('icon-sm'); // 20px
    height: size('icon-sm');
    stroke: currentColor;
  }

  &.is-open {
    transform: rotate(180deg);
  }
}

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// COLLAPSE PANEL
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

.password-checklist__collapse {
  overflow: hidden;
  max-height: 0;
  opacity: opacity('none'); // 0
  transform: translateY(-2px); // -2px (valeur fixe animation OK)

  @include safe-transition(
    max-height opacity transform,
    timing('base'),
    easing('smooth')
  );

  &.is-open {
    max-height: spacing(
      '500'
    ); // 500px - Tolérance : max-height collapse animation
    opacity: opacity('opaque'); // 1
    transform: translateY(0);
    margin-block-start: spacing('xs');
  }
}

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// CHECKLIST CONTAINER
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

.password-checklist {
  margin-block-start: spacing('sm');
  padding: spacing('md') spacing('lg');
  border-radius: radius('lg'); // 12px
  background-color: surface('surface'); // Fond doux
  border: border-width('base') solid surface('border');
}

.password-checklist__title {
  margin: 0 0 spacing('sm') 0;
  font-size: font-size('sm');
  font-weight: font-weight('semibold');
  color: text();
}

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// CHECKLIST GRID
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

.password-checklist__list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: spacing('xs');
  grid-template-columns: 1fr;

  // Desktop: 2 colonnes
  @include respond-to(sm) {
    grid-template-columns: 1fr 1fr;
  }
}

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// CHECKLIST ITEM
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

.password-checklist__item {
  display: flex;
  align-items: center;
  gap: spacing('sm');
  padding: spacing('sm') spacing('md');
  border-radius: radius('md'); // 8px
  border: border-width('base') dashed transparent;
  outline: none;

  @include safe-transition(
    background-color border-color transform,
    timing('fast'),
    easing('smooth')
  );

  // Focus WCAG 2.2 AA
  @include focus-ring;

  // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  // STATE: VALIDÉ (is-ok)
  // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  &.is-ok {
    background-color: semantic('success', 'bg'); // Vert pastel doux
    border-color: semantic('success', 'border');

    .password-checklist__text {
      color: semantic('success', 'dark'); // Texte vert foncé pour contraste
      font-weight: font-weight('semibold');
    }

    .password-checklist__icon {
      background-color: semantic('success', 'light'); // Vert clair pour icône
      border-radius: radius('full');
    }

    // Animation subtile TSA-friendly (seulement si motion activé)
    @media (prefers-reduced-motion: no-preference) {
      transform: translateX(spacing('2')); // 2px shift doux
    }
  }

  // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  // STATE: NON VALIDÉ (is-ko)
  // ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  &.is-ko {
    background-color: semantic('warning', 'bg'); // Orange pastel doux
    border-color: semantic('warning', 'border');

    .password-checklist__text {
      color: semantic('warning', 'dark'); // Texte orange foncé pour contraste
    }

    .password-checklist__icon {
      background-color: semantic('warning', 'light'); // Orange clair pour icône
      border-radius: radius('full');
    }
  }
}

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// ICON
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

.password-checklist__icon {
  width: size('icon-sm'); // 20px
  height: size('icon-sm');
  flex: 0 0 size('icon-sm');
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: font-size('sm');

  svg {
    width: 100%;
    height: 100%;
    stroke: currentColor;
  }
}
