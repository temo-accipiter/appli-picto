// src/components/ui/input/Input.scss
@use '@styles/abstracts' as *;

/// ============================================================================
/// INPUT COMPONENT - Tokens-First
/// ============================================================================
/// Composant input atomique réutilisable
/// - States: default, error, success, focus
/// - Variantes: text, password, file
/// - WCAG 2.2 AA compliant (44px touch target, focus visible)
/// - TSA-friendly animations (≤ 0.3s, prefers-reduced-motion)
///
/// ✅ CONFORME TOKENS-FIRST : Toutes valeurs via fonctions tokens
/// ============================================================================

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// INPUT FIELD WRAPPER
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

.input-field {
  display: flex;
  flex-direction: column;
  gap: spacing('xs'); // 4px (au lieu de xxs inexistant)
  position: relative;
}

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// INPUT BASE
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

.input-field__input {
  // Spacing
  padding: spacing('8');

  // Typographie
  font-size: font-size('base');

  // Apparence
  border: border-width('base') solid surface('border');
  border-radius: radius('md'); // 8px
  box-sizing: border-box;
  background-color: surface('bg');
  color: text();

  // Dimensions
  max-width: spacing(
    '200'
  ); // ~11.5rem - Tolérance : max-width contextuel inputs courts
  @include touch-target('min'); // 44px WCAG AA

  // Transitions TSA-compliant
  @include safe-transition(border outline, timing('fast'), easing('smooth'));

  // Focus WCAG 2.2 AA
  @include focus-ring;
}

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// STATES
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

.input-field__input--error {
  border: border-width('base') solid semantic('error');
  outline: border-width('base') solid semantic('error');
  @include validation-glow('error');
}

.input-field__input--success {
  outline: border-width('base') solid semantic('success');
  @include validation-glow('success');
}

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// ERROR MESSAGE
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

.input-field__error {
  min-height: spacing(
    '16'
  ); // 16px - Tolérance : min-height message erreur (pas structurel strict)
  font-size: font-size('sm');
  color: semantic('error');
  line-height: line-height('tight'); // 1.2
  margin: 0;

  // Visibilité
  overflow: visible;
  white-space: normal;
  text-overflow: unset;

  @include safe-transition(opacity, timing('fast'), easing('smooth'));

  &:empty {
    opacity: opacity('none'); // 0
  }
}

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// FILE INPUT VARIANT
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

input[type='file'].input-field__input {
  padding: spacing('6');
  border-radius: radius('sm'); // 4px
  cursor: pointer;
}

// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
// PASSWORD TOGGLE BUTTON
// ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

.input-field__container {
  position: relative;
}

.input-field__toggle {
  // Position
  position: absolute;
  right: spacing('12');
  top: 50%;
  transform: translateY(-50%);

  // Accessibilité WCAG AA
  @include touch-target('min'); // 44px

  // Layout
  display: flex;
  align-items: center;
  justify-content: center;

  // Apparence
  background: none;
  border: none;
  border-radius: radius('sm'); // 4px
  font-size: font-size('base');

  // UX
  cursor: pointer;
  opacity: opacity('lg'); // 0.6
  padding: 0;

  @include safe-transition(
    opacity background-color,
    timing('fast'),
    easing('smooth')
  );

  &:hover {
    opacity: opacity('opaque'); // 1
    background-color: surface('hover'); // Token sémantique hover
  }

  &:focus-visible {
    outline: border-width('focus') solid color('base'); // Couleur focus principale
    outline-offset: border-width('focus');
    opacity: opacity('opaque'); // 1
  }
}
