@use 'sass:map';
@use './tokens' as *;

// =============================================================================
// SYST√àME DE COULEURS - WRAPPER + FONCTIONS
// =============================================================================
/// ‚ö†Ô∏è IMPORTANT - REFACTORING PHASE 1 COMPLET√â (2025-12-14)
///
/// Ce fichier est en transition vers un WRAPPER PUR (Phase 2 en cours).
///
/// √âTAT ACTUEL:
///   - Maps locales ci-dessous sont DEPRECATED (marqu√©es ‚ö†Ô∏è)
///   - SOURCE DE V√âRIT√â CANONIQUE = _tokens.scss
///   - Fonctions ci-dessous (color(), blue(), etc.) sont OK et seront conserv√©es
///
/// R√àGLES STRICTES:
///   1. ‚ùå NE PLUS cr√©er de nouvelles maps de couleurs ici
///   2. ‚ùå NE PLUS modifier les maps locales (read-only)
///   3. ‚úÖ UTILISER les fonctions publiques (color(), semantic(), blue(), etc.)
///   4. ‚úÖ Les fonctions liront depuis _tokens.scss (canonical source)
///
/// MIGRATION TIMELINE:
///   Phase 1 ‚úÖ : Maps migr√©es vers _tokens.scss
///   Phase 2 (EN COURS) : Supprimer maps locales, garder uniquement fonctions
///   Phase 3 : Migrer composants pour utiliser fonctions tokens
///
/// Usage correct (apr√®s Phase 2):
///   @use '@styles/abstracts' as *;
///   .my-class { background: color('base'); }          // ‚úÖ
///   .my-class { color: blue(500); }                   // ‚úÖ
///   .my-class { border-color: semantic('success'); }  // ‚úÖ
// =============================================================================

// === COULEURS PRINCIPALES ===
/// ‚ö†Ô∏è DEPRECATED - Use $primary-color-tokens from _tokens.scss instead
/// This map will be REMOVED in Phase 2 - use color() function
$primary-colors: (
  base: #0077c2,
  // Bleu principal (buttons, liens)
  light: #4dabf7,
  // Bleu clair (hover, accents)
  dark: #1565c0, // Bleu fonc√© (√©tats actifs)
);

/// ‚ö†Ô∏è DEPRECATED - Use $secondary-color-tokens from _tokens.scss instead
$secondary-colors: (
  base: #ef5350, // Rouge secondaire
);

/// ‚ö†Ô∏è DEPRECATED - Use $accent-color-tokens from _tokens.scss instead
$accent-colors: (
  base: #ffb400,
  // Jaune accent
  light: #fbbf24,
  // Jaune clair
  dark: #f59e0b, // Ambre fonc√©
);

// === COULEURS S√âMANTIQUES ===
/// ‚ö†Ô∏è DEPRECATED - Use $semantic-tokens from _tokens.scss instead
/// Note: $semantic-tokens has expanded structure (base, light, dark, bg, border)
$semantic-colors: (
  success: #4caf50,
  // Vert succ√®s
  warning: #ff9800,
  // Orange avertissement
  error: #f44336,
  // Rouge erreur
  info: #d1ecf9,
  // Bleu clair info
  info-primary: #66c3f7, // Bleu info principal
);

// === PALETTE BLEUE ===
/// ‚ö†Ô∏è DEPRECATED - Use $blue-palette-tokens from _tokens.scss instead
$blue-palette: (
  50: #eff6ff,
  100: #dbeafe,
  200: #bfdbfe,
  300: #93c5fd,
  400: #60a5fa,
  500: #3b82f6,
  // Bleu standard
  600: #2563eb,
  700: #1d4ed8,
  800: #1e3a8a,
  900: #1e40af,
);

// === PALETTE ROUGE ===
/// ‚ö†Ô∏è DEPRECATED - Use $red-palette-tokens from _tokens.scss instead
$red-palette: (
  50: #fef2f2,
  100: #fee2e2,
  200: #fecaca,
  300: #fca5a5,
  400: #f87171,
  500: #ef4444,
  // Rouge standard
  600: #dc2626,
  700: #b91c1c,
  800: #991b1b,
  900: #7f1d1d,
);

// === PALETTE VERTE ===
/// ‚ö†Ô∏è DEPRECATED - Use $green-palette-tokens from _tokens.scss instead
$green-palette: (
  50: #f0fdf4,
  // green-50 pastel
  100: #dcfce7,
  200: #bbf7d0,
  // green-200
  300: #86efac,
  400: #4ade80,
  500: #22c55e,
  600: #16a34a,
  700: #15803d,
  800: #166534,
  // green-800
  900: #14532d,
);

// === PALETTE ORANGE/AMBRE ===
/// ‚ö†Ô∏è DEPRECATED - Use $orange-palette-tokens from _tokens.scss instead
$orange-palette: (
  50: #fff7ed,
  // orange-50 pastel
  100: #ffedd5,
  200: #fed7aa,
  // orange-200
  300: #fdba74,
  400: #fb923c,
  500: #f97316,
  600: #ea580c,
  700: #c2410c,
  800: #9a3412,
  900: #7c2d12, // orange-900
);

// === PALETTE JAUNE ===
/// ‚ö†Ô∏è DEPRECATED - Use $yellow-palette-tokens from _tokens.scss instead
$yellow-palette: (
  50: #fefce8,
  100: #fef9c3,
  200: #fef08a,
  300: #fde047,
  400: #facc15,
  500: #eab308,
  600: #ca8a04,
  700: #a16207,
  800: #854d0e,
  900: #713f12,
);

// === PALETTE VIOLETTE ===
/// ‚ö†Ô∏è DEPRECATED - Use $purple-palette-tokens from _tokens.scss instead
$purple-palette: (
  50: #faf5ff,
  100: #f3e8ff,
  200: #e9d5ff,
  300: #d8b4fe,
  400: #c084fc,
  500: #a855f7,
  600: #9333ea,
  700: #7e22ce,
  800: #6b21a8,
  900: #581c87,
);

// === PALETTE SLATE/GRIS FONC√â ===
/// ‚ö†Ô∏è DEPRECATED - Use $slate-palette-tokens from _tokens.scss instead
$slate-palette: (
  50: #f8fafc,
  100: #f1f5f9,
  200: #e2e8f0,
  300: #cbd5e1,
  400: #94a3b8,
  500: #64748b,
  600: #475569,
  700: #334155,
  // slate-700 (texte principal)
  800: #1e293b,
  900: #0f172a,
);

// === PALETTE GRAY NEUTRE ===
/// ‚ö†Ô∏è DEPRECATED - Use $gray-palette-tokens from _tokens.scss instead
$gray-palette: (
  50: #fafafa,
  100: #f7f7f7,
  200: #e1e1e1,
  300: #cfcfcf,
  400: #b1b1b1,
  500: #9e9e9e,
  600: #7e7e7e,
  700: #626262,
  800: #515151,
  900: #3b3b3b,
);

// === COULEURS R√îLES [‚ö†Ô∏è DEPRECATED - READ FROM _tokens.scss INSTEAD] ===
/// üî¥ DEPRECATION WARNING (Phase 1 - Commit 1)
///
/// Cette map $role-colors est D√âPR√âCI√â depuis la canonicalisation de _tokens.scss.
///
/// ‚ùå ANCIEN √âTAT (NON-AUTORITATIF):
///   - admin base: #dc2626 (ROUGE - ANCIEN, INCORRECT)
///   - Autres: conflictant avec _tokens.scss
///
/// ‚úÖ NOUVEL √âTAT (AUTHORITATIVE):
///   - Lire depuis @use './tokens' et $role-color-tokens (ligne 24 dans _tokens.scss)
///   - Admin base: #667eea (VIOLET - NOUVEAU, CORRECT)
///   - role-color() function DOIT proxer vers tokens
///
/// üìù MIGRATION TIMELINE:
///   Phase 1 (NOW): Canonicalisation dans _tokens.scss + warnings ici
///   Phase 2: Propager aux variables & functions (proxer vers tokens)
///   Phase 3: Corriger usages hardcod√©s dans components
///   Phase 4+: Supprimer cette map DEPRECATED (apr√®s v√©rification)
///
/// Pour maintenant: Cette map est FIG√âE - ne pas la modifier.
/// Tout nouveau code DOIT lire depuis _tokens.$role-color-tokens.
$role-colors: (
  admin: (
    base: #dc2626,
    // ‚ö†Ô∏è DEPRECATED - Admin should be #667eea (violet) - see _tokens.scss
    gradient: #ef4444,
  ),
  abonne: (
    base: #0077c2,
    // Bleu abonn√©
    gradient: #4dabf7,
  ),
  visitor: (
    base: #9e9e9e,
    // Gris visiteur
    gradient: #cfcfcf,
  ),
  free: (
    base: #9e9e9e,
    // Alias visitor
    gradient: #cfcfcf,
  ),
  staff: (
    base: #8b5cf6,
    // Violet staff
    gradient: #a78bfa,
  ),
);

// === ADMIN UI COLORS ===
/// ‚ö†Ô∏è DEPRECATED - Use $admin-ui-color-tokens from _tokens.scss instead
$admin-ui: (
  primary: #007bff,
  // Bleu Bootstrap primary
  primary-hover: #0056b3,
  // Hover primary
  secondary: #6c757d,
  // Gris Bootstrap secondary
  secondary-hover: #545b62,
  // Hover secondary
  success: #28a745,
  // Vert Bootstrap success
  success-hover: #1e7e34,
  // Hover success
  danger: #dc3545,
  // Rouge Bootstrap danger
  danger-hover: #c82333,
  // Hover danger
  info: #2563eb,
  // Bleu info moderne
  info-light: rgba(37, 99, 235, 0.05),
  // Background info l√©ger
  item-bg: rgba(37, 99, 235, 0.05),
  // Background item
  item-alt: rgba(75, 85, 99, 0.05),
  // Background alternance
  success-bg: rgba(40, 167, 69, 0.1),
  // Background success light
  success-border: rgba(40, 167, 69, 0.3),
  // Bordure success
  danger-bg: rgba(220, 53, 69, 0.1),
  // Background danger light
  danger-border: rgba(220, 53, 69, 0.3), // Bordure danger
);

// === WARNING STATES ===
/// ‚ö†Ô∏è DEPRECATED - Use $warning-state-color-tokens from _tokens.scss instead
$warning-states: (
  warning: #f97316,
  // Orange warning principal
  warning-light: #fb923c,
  // Orange warning clair
  warning-bg: rgba(249, 115, 22, 0.08),
  // Background warning l√©ger
  warning-bg-strong: rgba(249, 115, 22, 0.1),
  // Background warning moyen
  warning-border: #f97316,
  // Bordure warning
  error: #ef4444,
  // Rouge error principal
  error-bg: rgba(239, 68, 68, 0.08),
  // Background error l√©ger
  error-bg-strong: rgba(239, 68, 68, 0.1),
  // Background error moyen
  error-border: rgba(239, 68, 68, 0.3),
  // Bordure error
  error-hover: rgba(239, 68, 68, 0.2), // Background error hover
);

// === GRADIENTS BADGES ===
/// ‚ö†Ô∏è DEPRECATED - Use $badge-gradients from _tokens.scss instead (already migrated)
/// Note: This local map conflicts with canonical $badge-gradients in _tokens.scss
$badge-gradients: (
  abonne: (
    start: #4ade80,
    end: #22c55e,
  ),
  // Gradient vert abonn√©
  free: (
      start: #94a3b8,
      end: #64748b,
    ),
  // Gradient gris free
  visitor: (
      start: #f97316,
      end: #ea580c,
    ),
  // Gradient orange visitor
  admin: (
      start: #dc2626,
      end: #ef4444,
    ),
  // Gradient rouge admin
  staff: (
      start: #8b5cf6,
      end: #a78bfa,
    ), // Gradient violet staff
);

// NOTE: $ui-gradients et $badge-shadows sont d√©finis dans _tokens.scss
// et import√©s via @use './tokens' au d√©but de ce fichier

// === TSA PASTELS ===
/// ‚ö†Ô∏è DEPRECATED - Use $tsa-pastel-color-tokens from _tokens.scss instead
$tsa-pastels: (
  blue-light: #eaf6ff,
  // Bleu pastel l√©ger
  green-soft: #d4f4dd,
  // Vert pastel doux
  info-soft: #d1ecf9,
  // Bleu info pastel
  bg-soft: #f0f8ff,
  // Background bleu tr√®s l√©ger
  page-soft: #f9f9f9, // Background page doux
);

// === SHADOWS & OVERLAYS ===
/// ‚ö†Ô∏è DEPRECATED - Use $shadow-color-tokens from _tokens.scss instead
$shadows: (
  black-light: rgba(0, 0, 0, 0.08),
  // Ombre noire l√©g√®re
  black-medium: rgba(0, 0, 0, 0.2),
  // Ombre noire moyenne
  black-strong: rgba(0, 0, 0, 0.3),
  // Ombre noire forte
  primary-light: rgba(66, 153, 225, 0.1),
  // Ombre primary l√©g√®re
  primary-medium: rgba(66, 153, 225, 0.3),
  // Ombre primary moyenne
  success-strong: rgba(16, 185, 129, 0.2), // Ombre success forte
);

// === COULEURS TEXTE & SURFACES ===
/// ‚ö†Ô∏è DEPRECATED - Use $text-color-tokens from _tokens.scss instead
$text-colors: (
  default: #333333,
  // Texte principal
  invert: #ffffff,
  // Texte invers√©
  light: #64748b,
  // Texte secondaire
  dark: #1f2937,
  // Texte accentu√©
  muted: #6b7280, // Texte d√©sactiv√©
);

/// ‚ö†Ô∏è DEPRECATED - Use $surface-color-tokens from _tokens.scss instead
$surface-colors: (
  bg: #ffffff,
  // Background principal
  surface: #f7f7f7,
  // Surface secondaire
  border: #e1e1e1,
  // Bordures
  soft: #f8fafc,
  // Background doux
  hover: #f9fafb, // Hover state
);

// =============================================================================
// FONCTIONS D'ACC√àS
// =============================================================================

/// R√©cup√®re une couleur principale
/// @param {String} $key - Cl√© de la couleur (base, light, dark)
/// @param {String} $type - Type de couleur (primary, secondary, accent)
/// @return {Color} La couleur demand√©e
@function color($key, $type: 'primary') {
  $map: $primary-colors;

  @if $type == 'secondary' {
    $map: $secondary-colors;
  } @else if $type == 'accent' {
    $map: $accent-colors;
  }

  @if map.has-key($map, $key) {
    @return map.get($map, $key);
  }

  @error "Color '#{$key}' not found in #{$type} colors";
}

/// R√©cup√®re une couleur s√©mantique
/// @param {String} $name - Nom de la couleur (success, warning, error, info)
/// @return {Color} La couleur demand√©e
@function semantic($name) {
  @if map.has-key($semantic-colors, $name) {
    @return map.get($semantic-colors, $name);
  }

  @error "Semantic color '#{$name}' not found";
}

/// R√©cup√®re une nuance de bleu
/// @param {Number} $shade - Nuance (50, 100, 200, ..., 900)
/// @return {Color} La couleur demand√©e
@function blue($shade) {
  @if map.has-key($blue-palette, $shade) {
    @return map.get($blue-palette, $shade);
  }

  @error "Blue shade '#{$shade}' not found";
}

/// R√©cup√®re une nuance de rouge
/// @param {Number} $shade - Nuance (50, 100, 200, ..., 900)
/// @return {Color} La couleur demand√©e
@function red($shade) {
  @if map.has-key($red-palette, $shade) {
    @return map.get($red-palette, $shade);
  }

  @error "Red shade '#{$shade}' not found";
}

/// R√©cup√®re une nuance de vert
/// @param {Number} $shade - Nuance (50, 100, 200, ..., 900)
/// @return {Color} La couleur demand√©e
@function green($shade) {
  @if map.has-key($green-palette, $shade) {
    @return map.get($green-palette, $shade);
  }

  @error "Green shade '#{$shade}' not found";
}

/// R√©cup√®re une nuance d'orange
/// @param {Number} $shade - Nuance (50, 100, 200, ..., 900)
/// @return {Color} La couleur demand√©e
@function orange($shade) {
  @if map.has-key($orange-palette, $shade) {
    @return map.get($orange-palette, $shade);
  }

  @error "Orange shade '#{$shade}' not found";
}

/// R√©cup√®re une nuance de jaune
/// @param {Number} $shade - Nuance (50, 100, 200, ..., 900)
/// @return {Color} La couleur demand√©e
@function yellow($shade) {
  @if map.has-key($yellow-palette, $shade) {
    @return map.get($yellow-palette, $shade);
  }

  @error "Yellow shade '#{$shade}' not found";
}

/// R√©cup√®re une nuance de violet
/// @param {Number} $shade - Nuance (50, 100, 200, ..., 900)
/// @return {Color} La couleur demand√©e
@function purple($shade) {
  @if map.has-key($purple-palette, $shade) {
    @return map.get($purple-palette, $shade);
  }

  @error "Purple shade '#{$shade}' not found";
}

/// R√©cup√®re une nuance de slate
/// @param {Number} $shade - Nuance (50, 100, 200, ..., 900)
/// @return {Color} La couleur demand√©e
@function slate($shade) {
  @if map.has-key($slate-palette, $shade) {
    @return map.get($slate-palette, $shade);
  }

  @error "Slate shade '#{$shade}' not found";
}

/// R√©cup√®re une couleur de r√¥le (CANONICAL - lire depuis _tokens.scss)
/// @param {String} $role - Nom du r√¥le (admin, abonne, visitor, free, staff)
/// @param {String} $variant - Variante (base, light, dark, gradient-start, gradient-end)
///                            or legacy 'gradient' (alias for 'gradient-start')
/// @return {Color} La couleur demand√©e
///
/// ‚úÖ Phase 2 UPDATE: Cette fonction proxe maintenant vers _tokens.$role-color-tokens
///    (source de v√©rit√© canonical) au lieu de lire la map locale deprecated.
///
/// üìù Exemples:
///   role-color('admin', 'base') ‚Üí #667eea (violet)
///   role-color('admin', 'gradient-start') ‚Üí #667eea
///   role-color('admin', 'gradient-end') ‚Üí #764ba2
///   role-color('admin', 'gradient') ‚Üí #667eea (legacy alias, redirects to 'gradient-start')
///
/// ‚ö†Ô∏è NOTE: La map locale $role-colors est NOW READ-ONLY (deprecated).
@function role-color($role, $variant: 'base') {
  // Legacy alias support: 'gradient' ‚Üí 'gradient-start'
  $normalized-variant: $variant;
  @if $variant == 'gradient' {
    $normalized-variant: 'gradient-start';
  }

  // CANONICAL SOURCE: _tokens.$role-color-tokens
  @if map.has-key($role-color-tokens, $role) {
    $role-map: map.get($role-color-tokens, $role);

    @if map.has-key($role-map, $normalized-variant) {
      @return map.get($role-map, $normalized-variant);
    }

    @error "Role color variant '#{$normalized-variant}' (requested: '#{$variant}') not found for role '#{$role}'. Available: base, light, dark, gradient-start, gradient-end. See _tokens.scss for canonical values.";
  }

  @error "Role '#{$role}' not found in $role-color-tokens (canonical source in _tokens.scss)";
}

/// R√©cup√®re une couleur de texte
/// @param {String} $type - Type de texte (default, invert, light, dark, muted)
/// @return {Color} La couleur demand√©e
@function text($type: 'default') {
  @if map.has-key($text-colors, $type) {
    @return map.get($text-colors, $type);
  }

  @error "Text color '#{$type}' not found";
}

/// R√©cup√®re une couleur de surface
/// @param {String} $type - Type de surface (bg, surface, border, soft, hover)
/// @return {Color} La couleur demand√©e
@function surface($type) {
  @if map.has-key($surface-colors, $type) {
    @return map.get($surface-colors, $type);
  }

  @error "Surface color '#{$type}' not found";
}

/// R√©cup√®re une couleur admin UI
/// @param {String} $key - Cl√© de la couleur (primary, secondary, success, danger, etc.)
/// @return {Color} La couleur demand√©e
@function admin-ui($key) {
  @if map.has-key($admin-ui, $key) {
    @return map.get($admin-ui, $key);
  }

  @error "Admin UI color '#{$key}' not found";
}

/// R√©cup√®re une couleur warning state
/// @param {String} $key - Cl√© de la couleur (warning, error, warning-bg, etc.)
/// @return {Color} La couleur demand√©e
@function warning($key) {
  @if map.has-key($warning-states, $key) {
    @return map.get($warning-states, $key);
  }

  @error "Warning state '#{$key}' not found";
}

/// R√©cup√®re un gradient badge
/// @param {String} $role - Nom du r√¥le (abonne, free, visitor, admin, staff)
/// @return {Map} Map avec start/end du gradient
@function badge-gradient($role) {
  @if map.has-key($badge-gradients, $role) {
    @return map.get($badge-gradients, $role);
  }

  @error "Badge gradient '#{$role}' not found";
}

/// R√©cup√®re un gradient UI moderne
/// @param {String} $name - Nom du gradient (purple-modern, purple-modern-hover, blue-soft)
/// @return {Map} Map avec start/end du gradient
@function ui-gradient($name) {
  @if map.has-key($ui-gradients, $name) {
    @return map.get($ui-gradients, $name);
  }

  @error "UI gradient '#{$name}' not found";
}

/// R√©cup√®re une ombre badge
/// @param {String} $role - Nom du r√¥le + variante (abonne, abonne-hover, etc.)
/// @return {Color} La couleur d'ombre demand√©e
@function badge-shadow($key) {
  @if map.has-key($badge-shadows, $key) {
    @return map.get($badge-shadows, $key);
  }

  @error "Badge shadow '#{$key}' not found";
}

/// R√©cup√®re une couleur pastel TSA
/// @param {String} $key - Cl√© de la couleur (blue-light, green-soft, etc.)
/// @return {Color} La couleur demand√©e
@function tsa-pastel($key) {
  @if map.has-key($tsa-pastels, $key) {
    @return map.get($tsa-pastels, $key);
  }

  @error "TSA pastel '#{$key}' not found";
}

/// R√©cup√®re une ombre/overlay
/// @param {String} $key - Cl√© de l'ombre (black-light, primary-medium, etc.)
/// @return {Color} La couleur d'ombre demand√©e
@function shadow($key) {
  @if map.has-key($shadows, $key) {
    @return map.get($shadows, $key);
  }

  @error "Shadow '#{$key}' not found";
}

/// R√©cup√®re une couleur de marque tierce
/// @param {String} $key - Cl√© de la marque (stripe, stripe-hover, etc.)
/// @return {Color} La couleur demand√©e
@function brand($key) {
  @if map.has-key($brand-colors, $key) {
    @return map.get($brand-colors, $key);
  }

  @error "Brand color '#{$key}' not found";
}
