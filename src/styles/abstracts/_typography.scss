@charset 'UTF-8';
@use 'sass:map';
@use 'tokens' as *;

/// ============================================================================
/// TYPOGRAPHY SYSTEM - Wrapper pur pour typographie
/// ============================================================================
/// ✅ CONFORME TOKENS-FIRST : Toutes les valeurs proviennent de tokens
/// Ce fichier NE DÉFINIT AUCUNE donnée, il expose uniquement des fonctions wrapper.
///
/// SOURCES DE VÉRITÉ :
///   - $font-size-tokens dans _tokens.scss
///   - $font-weight-tokens dans _tokens.scss
///   - $line-height-tokens dans _tokens.scss
///
/// Usage:
///   font-size: font-size('lg');           // 1.125rem (18px)
///   font-weight: font-weight('bold');     // 700
///   line-height: line-height('relaxed');  // 1.625
///
/// Migration v2.1:
///   - ✅ Supprimé toutes variables individuelles ($font-size-xxs, etc.)
///   - ✅ Supprimé toutes maps locales ($font-size-scale, etc.)
///   - ✅ Fonctions lisent uniquement depuis tokens
///   - ✅ Font stacks conservés (system fonts)
/// ============================================================================

/// ============================================================================
/// FONT STACKS - Polices d'écriture système
/// ============================================================================

/// Font stack pour le texte corps (lisibilité maximale)
$text-font-stack:
  system-ui,
  -apple-system,
  'Segoe UI',
  Roboto,
  Helvetica,
  Arial,
  sans-serif;

/// Font stack pour les headings (distinction)
$heading-font-stack: Georgia, 'Times New Roman', Times, serif;

/// Font stack pour accessibilité TSA
/// Lexend : meilleure distinction des lettres pour enfants dyslexiques
$lexend-font-stack:
  'Lexend',
  system-ui,
  -apple-system,
  'Segoe UI',
  sans-serif;

/// Monospace font stack (code, technical)
$mono-font-stack: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Courier New', monospace;

/// ============================================================================
/// FUNCTIONS - Accesseurs pour typographie
/// ============================================================================

/// Récupère une taille de police depuis $font-size-tokens
/// @param {String} $key - Clé dans $font-size-tokens (xs, sm, base, lg, xl, 2xl, 3xl, etc.)
/// @return {Length} Font size value (rem)
/// @example
///   font-size: font-size('lg');    // 1.125rem (18px)
///   font-size: font-size('2xl');   // 1.5rem (24px)
@function font-size($key) {
  @if not map.has-key($font-size-tokens, $key) {
    @error "Font-size key '#{$key}' not found in $font-size-tokens. Available keys: #{map.keys($font-size-tokens)}";
  }
  @return map.get($font-size-tokens, $key);
}

/// Récupère un poids de police depuis $font-weight-tokens
/// @param {String} $key - Clé dans $font-weight-tokens (light, normal, medium, semibold, bold, etc.)
/// @return {Number} Font weight value (100-900)
/// @example
///   font-weight: font-weight('bold');      // 700
///   font-weight: font-weight('semibold');  // 600
@function font-weight($key) {
  @if not map.has-key($font-weight-tokens, $key) {
    @error "Font-weight key '#{$key}' not found in $font-weight-tokens. Available keys: #{map.keys($font-weight-tokens)}";
  }
  @return map.get($font-weight-tokens, $key);
}

/// Récupère une hauteur de ligne depuis $line-height-tokens
/// @param {String} $key - Clé dans $line-height-tokens (tight, snug, normal, relaxed, loose)
/// @return {Number} Line height value (unitless ratio)
/// @example
///   line-height: line-height('relaxed');  // 1.625
///   line-height: line-height('normal');   // 1.5
@function line-height($key) {
  @if not map.has-key($line-height-tokens, $key) {
    @error "Line-height key '#{$key}' not found in $line-height-tokens. Available keys: #{map.keys($line-height-tokens)}";
  }
  @return map.get($line-height-tokens, $key);
}

/// ============================================================================
/// MIXINS - Helpers typographiques courants
/// ============================================================================

/// Applique un style typographique complet (h1-h6 ou patterns courants)
/// @param {String} $variant - Variant de typographie ('h1', 'h2', 'body', 'label', etc.)
/// @example
///   @include typography('h1');    // 3xl + bold + tight
///   @include typography('body');  // base + normal + normal
@mixin typography($variant) {
  @if $variant == 'h1' {
    font-size: font-size('3xl');
    font-weight: font-weight('bold');
    line-height: line-height('tight');
  } @else if $variant == 'h2' {
    font-size: font-size('2xl');
    font-weight: font-weight('bold');
    line-height: line-height('tight');
  } @else if $variant == 'h3' {
    font-size: font-size('xl');
    font-weight: font-weight('semibold');
    line-height: line-height('tight');
  } @else if $variant == 'h4' {
    font-size: font-size('lg');
    font-weight: font-weight('semibold');
    line-height: line-height('snug');
  } @else if $variant == 'h5' {
    font-size: font-size('base');
    font-weight: font-weight('semibold');
    line-height: line-height('snug');
  } @else if $variant == 'h6' {
    font-size: font-size('sm');
    font-weight: font-weight('semibold');
    line-height: line-height('snug');
  } @else if $variant == 'body' {
    font-size: font-size('base');
    font-weight: font-weight('normal');
    line-height: line-height('normal');
  } @else if $variant == 'small' {
    font-size: font-size('sm');
    font-weight: font-weight('normal');
    line-height: line-height('snug');
  } @else if $variant == 'caption' {
    font-size: font-size('xs');
    font-weight: font-weight('normal');
    line-height: line-height('snug');
  } @else if $variant == 'label' {
    font-size: font-size('sm');
    font-weight: font-weight('medium');
    line-height: line-height('snug');
  } @else if $variant == 'button' {
    font-size: font-size('base');
    font-weight: font-weight('medium');
    line-height: line-height('none');
  } @else {
    @warn "Typography variant '#{$variant}' not found. Available: h1-h6, body, small, caption, label, button";
  }
}

/// Applique le font stack TSA-friendly (Lexend)
/// @example
///   @include font-tsa;
@mixin font-tsa {
  font-family: $lexend-font-stack;
}

/// Applique le font stack corps de texte
/// @example
///   @include font-text;
@mixin font-text {
  font-family: $text-font-stack;
}

/// Applique le font stack headings
/// @example
///   @include font-heading;
@mixin font-heading {
  font-family: $heading-font-stack;
}

/// ============================================================================
/// CSS CUSTOM PROPERTIES - Pour accès runtime JavaScript
/// ============================================================================

:root {
  // Font sizes scale
  --font-size-xs: #{font-size('xs')};
  --font-size-sm: #{font-size('sm')};
  --font-size-base: #{font-size('base')};
  --font-size-lg: #{font-size('lg')};
  --font-size-xl: #{font-size('xl')};
  --font-size-2xl: #{font-size('2xl')};
  --font-size-3xl: #{font-size('3xl')};

  // Font weights common
  --font-weight-normal: #{font-weight('normal')};
  --font-weight-medium: #{font-weight('medium')};
  --font-weight-semibold: #{font-weight('semibold')};
  --font-weight-bold: #{font-weight('bold')};

  // Line heights common
  --line-height-tight: #{line-height('tight')};
  --line-height-normal: #{line-height('normal')};
  --line-height-relaxed: #{line-height('relaxed')};

  // Font stacks
  --font-text: #{$text-font-stack};
  --font-heading: #{$heading-font-stack};
  --font-tsa: #{$lexend-font-stack};
}

/// ============================================================================
/// GUIDELINES & BEST PRACTICES
/// ============================================================================
/// 1. JAMAIS hardcoder font-size/weight/line-height
/// 2. Utiliser fonctions font-size(), font-weight(), line-height()
/// 3. Pour combinaisons courantes (h1-h6), utiliser @include typography('h1')
/// 4. Font TSA-friendly : @include font-tsa pour accessibilité dyslexie
/// 5. Pour nouveaux tokens, ajouter à $font-*-tokens dans _tokens.scss
/// 6. Respecter WCAG : line-height minimum 1.5 pour body text
/// 7. Mobile-first : sizes adaptées tactile (minimum 16px pour inputs)
///
/// EXEMPLES :
///
/// ✅ CORRECT :
///   h1 { @include typography('h1'); }
///   p { font-size: font-size('base'); line-height: line-height('normal'); }
///   .label { font-size: font-size('sm'); font-weight: font-weight('medium'); }
///
/// ❌ INCORRECT :
///   h1 { font-size: 2.5rem; }               // Hardcodé !
///   p { font-weight: 500; }                 // Hardcodé !
///   .label { line-height: 1.4; }            // Hardcodé !
/// ============================================================================
