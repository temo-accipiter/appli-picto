[
  {
    "audit_report": {
      "tables_inventory": [
        {
          "schema": "public",
          "table_name": "abonnements",
          "kind": "r",
          "persistence": "p",
          "est_rows": 2,
          "total_size": "248 kB"
        },
        {
          "schema": "public",
          "table_name": "account_audit_logs",
          "kind": "r",
          "persistence": "p",
          "est_rows": 2,
          "total_size": "112 kB"
        },
        {
          "schema": "public",
          "table_name": "categories",
          "kind": "r",
          "persistence": "p",
          "est_rows": 13,
          "total_size": "144 kB"
        },
        {
          "schema": "public",
          "table_name": "consentements",
          "kind": "r",
          "persistence": "p",
          "est_rows": 40,
          "total_size": "136 kB"
        },
        {
          "schema": "public",
          "table_name": "consentements_latest",
          "kind": "v",
          "persistence": "p",
          "est_rows": -1,
          "total_size": "0 bytes"
        },
        {
          "schema": "public",
          "table_name": "demo_cards",
          "kind": "r",
          "persistence": "p",
          "est_rows": 10,
          "total_size": "80 kB"
        },
        {
          "schema": "public",
          "table_name": "features",
          "kind": "r",
          "persistence": "p",
          "est_rows": 1,
          "total_size": "64 kB"
        },
        {
          "schema": "public",
          "table_name": "parametres",
          "kind": "r",
          "persistence": "p",
          "est_rows": 1,
          "total_size": "24 kB"
        },
        {
          "schema": "public",
          "table_name": "permission_changes",
          "kind": "r",
          "persistence": "p",
          "est_rows": 88,
          "total_size": "224 kB"
        },
        {
          "schema": "public",
          "table_name": "profiles",
          "kind": "r",
          "persistence": "p",
          "est_rows": 5,
          "total_size": "104 kB"
        },
        {
          "schema": "public",
          "table_name": "recompenses",
          "kind": "r",
          "persistence": "p",
          "est_rows": 0,
          "total_size": "152 kB"
        },
        {
          "schema": "public",
          "table_name": "role_permissions",
          "kind": "r",
          "persistence": "p",
          "est_rows": 2,
          "total_size": "88 kB"
        },
        {
          "schema": "public",
          "table_name": "role_permissions_admin_view",
          "kind": "v",
          "persistence": "p",
          "est_rows": -1,
          "total_size": "0 bytes"
        },
        {
          "schema": "public",
          "table_name": "role_quotas",
          "kind": "r",
          "persistence": "p",
          "est_rows": 8,
          "total_size": "64 kB"
        },
        {
          "schema": "public",
          "table_name": "role_quotas_backup_legacy",
          "kind": "r",
          "persistence": "p",
          "est_rows": 14,
          "total_size": "16 kB"
        },
        {
          "schema": "public",
          "table_name": "roles",
          "kind": "r",
          "persistence": "p",
          "est_rows": 5,
          "total_size": "80 kB"
        },
        {
          "schema": "public",
          "table_name": "stations",
          "kind": "r",
          "persistence": "p",
          "est_rows": 84,
          "total_size": "152 kB"
        },
        {
          "schema": "public",
          "table_name": "subscription_logs",
          "kind": "r",
          "persistence": "p",
          "est_rows": 14,
          "total_size": "64 kB"
        },
        {
          "schema": "public",
          "table_name": "taches",
          "kind": "r",
          "persistence": "p",
          "est_rows": 0,
          "total_size": "208 kB"
        },
        {
          "schema": "public",
          "table_name": "user_assets",
          "kind": "r",
          "persistence": "p",
          "est_rows": 4,
          "total_size": "112 kB"
        },
        {
          "schema": "public",
          "table_name": "user_prefs",
          "kind": "r",
          "persistence": "p",
          "est_rows": 3,
          "total_size": "80 kB"
        },
        {
          "schema": "public",
          "table_name": "user_roles",
          "kind": "r",
          "persistence": "p",
          "est_rows": 8,
          "total_size": "184 kB"
        },
        {
          "schema": "public",
          "table_name": "user_usage_counters",
          "kind": "r",
          "persistence": "p",
          "est_rows": 5,
          "total_size": "56 kB"
        },
        {
          "schema": "public",
          "table_name": "v_role_quota_matrix",
          "kind": "v",
          "persistence": "p",
          "est_rows": -1,
          "total_size": "0 bytes"
        },
        {
          "schema": "public",
          "table_name": "v_user_storage_usage",
          "kind": "v",
          "persistence": "p",
          "est_rows": -1,
          "total_size": "0 bytes"
        },
        {
          "schema": "storage",
          "table_name": "buckets",
          "kind": "r",
          "persistence": "p",
          "est_rows": 3,
          "total_size": "48 kB"
        },
        {
          "schema": "storage",
          "table_name": "buckets_analytics",
          "kind": "r",
          "persistence": "p",
          "est_rows": 0,
          "total_size": "16 kB"
        },
        {
          "schema": "storage",
          "table_name": "migrations",
          "kind": "r",
          "persistence": "p",
          "est_rows": 44,
          "total_size": "40 kB"
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "kind": "r",
          "persistence": "p",
          "est_rows": 17,
          "total_size": "176 kB"
        },
        {
          "schema": "storage",
          "table_name": "prefixes",
          "kind": "r",
          "persistence": "p",
          "est_rows": 12,
          "total_size": "80 kB"
        },
        {
          "schema": "storage",
          "table_name": "s3_multipart_uploads",
          "kind": "r",
          "persistence": "p",
          "est_rows": 0,
          "total_size": "24 kB"
        },
        {
          "schema": "storage",
          "table_name": "s3_multipart_uploads_parts",
          "kind": "r",
          "persistence": "p",
          "est_rows": 0,
          "total_size": "16 kB"
        }
      ],
      "rls_overview": [
        {
          "schema": "public",
          "table_name": "abonnements",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 1
        },
        {
          "schema": "public",
          "table_name": "account_audit_logs",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 2
        },
        {
          "schema": "public",
          "table_name": "categories",
          "rls_enabled": true,
          "rls_forced": true,
          "policy_count": 4
        },
        {
          "schema": "public",
          "table_name": "consentements",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 4
        },
        {
          "schema": "public",
          "table_name": "demo_cards",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 1
        },
        {
          "schema": "public",
          "table_name": "features",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 1
        },
        {
          "schema": "public",
          "table_name": "parametres",
          "rls_enabled": true,
          "rls_forced": true,
          "policy_count": 4
        },
        {
          "schema": "public",
          "table_name": "permission_changes",
          "rls_enabled": true,
          "rls_forced": true,
          "policy_count": 4
        },
        {
          "schema": "public",
          "table_name": "profiles",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 3
        },
        {
          "schema": "public",
          "table_name": "recompenses",
          "rls_enabled": true,
          "rls_forced": true,
          "policy_count": 5
        },
        {
          "schema": "public",
          "table_name": "role_permissions",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 1
        },
        {
          "schema": "public",
          "table_name": "role_quotas",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 1
        },
        {
          "schema": "public",
          "table_name": "role_quotas_backup_legacy",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 1
        },
        {
          "schema": "public",
          "table_name": "roles",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 1
        },
        {
          "schema": "public",
          "table_name": "stations",
          "rls_enabled": true,
          "rls_forced": true,
          "policy_count": 2
        },
        {
          "schema": "public",
          "table_name": "subscription_logs",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 1
        },
        {
          "schema": "public",
          "table_name": "taches",
          "rls_enabled": true,
          "rls_forced": true,
          "policy_count": 5
        },
        {
          "schema": "public",
          "table_name": "user_assets",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 4
        },
        {
          "schema": "public",
          "table_name": "user_prefs",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 3
        },
        {
          "schema": "public",
          "table_name": "user_roles",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 3
        },
        {
          "schema": "public",
          "table_name": "user_usage_counters",
          "rls_enabled": true,
          "rls_forced": false,
          "policy_count": 1
        }
      ],
      "policies_detail": [
        {
          "schema": "public",
          "table_name": "abonnements",
          "policy_name": "abonnements_select_unified",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (( SELECT auth.uid() AS uid) = user_id))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "account_audit_logs",
          "policy_name": "account_audit_logs_insert_admin",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{public}",
          "using_expr": null,
          "with_check_expr": "is_admin()"
        },
        {
          "schema": "public",
          "table_name": "account_audit_logs",
          "policy_name": "account_audit_logs_select_unified",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{public}",
          "using_expr": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "categories",
          "policy_name": "categories_delete_own",
          "polcmd": "DELETE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((user_id = ( SELECT auth.uid() AS uid)) OR is_admin())",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "categories",
          "policy_name": "categories_insert_unified",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "(is_admin() OR ((user_id = ( SELECT auth.uid() AS uid)) AND check_user_quota(( SELECT auth.uid() AS uid), 'category'::text, 'total'::text) AND check_user_quota(( SELECT auth.uid() AS uid), 'category'::text, 'monthly'::text)))"
        },
        {
          "schema": "public",
          "table_name": "categories",
          "policy_name": "categories_select_auth",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((user_id = ( SELECT auth.uid() AS uid)) OR (user_id IS NULL) OR is_admin())",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "categories",
          "policy_name": "categories_update_own",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((user_id = ( SELECT auth.uid() AS uid)) OR is_admin())",
          "with_check_expr": "((user_id = ( SELECT auth.uid() AS uid)) OR is_admin())"
        },
        {
          "schema": "public",
          "table_name": "consentements",
          "policy_name": "consentements_delete",
          "polcmd": "DELETE",
          "mode": "PERMISSIVE",
          "roles": "{anon,authenticated}",
          "using_expr": "false",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "consentements",
          "policy_name": "consentements_insert_unified",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{public}",
          "using_expr": null,
          "with_check_expr": "((user_id IS NULL) OR (user_id = ( SELECT auth.uid() AS uid)))"
        },
        {
          "schema": "public",
          "table_name": "consentements",
          "policy_name": "consentements_select",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{public}",
          "using_expr": "((user_id = ( SELECT auth.uid() AS uid)) OR is_admin())",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "consentements",
          "policy_name": "consentements_update",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{anon,authenticated}",
          "using_expr": "false",
          "with_check_expr": "false"
        },
        {
          "schema": "public",
          "table_name": "demo_cards",
          "policy_name": "demo_cards_select_unified",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{public}",
          "using_expr": "(is_admin() OR (is_active = true))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "features",
          "policy_name": "features_select_unified",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (is_active = true))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "parametres",
          "policy_name": "parametres_delete_admin_only",
          "polcmd": "DELETE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "is_admin()",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "parametres",
          "policy_name": "parametres_insert_all_users",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "is_admin()"
        },
        {
          "schema": "public",
          "table_name": "parametres",
          "policy_name": "parametres_select_all_users",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "true",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "parametres",
          "policy_name": "parametres_update_all_users",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "is_admin()",
          "with_check_expr": "is_admin()"
        },
        {
          "schema": "public",
          "table_name": "permission_changes",
          "policy_name": "permission_changes_delete_admin",
          "polcmd": "DELETE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "is_admin()",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "permission_changes",
          "policy_name": "permission_changes_insert_admin",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "is_admin()"
        },
        {
          "schema": "public",
          "table_name": "permission_changes",
          "policy_name": "permission_changes_select_admin",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "is_admin()",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "permission_changes",
          "policy_name": "permission_changes_update_admin",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "is_admin()",
          "with_check_expr": "is_admin()"
        },
        {
          "schema": "public",
          "table_name": "profiles",
          "policy_name": "profiles_insert_unified",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "(is_admin() OR (( SELECT auth.uid() AS uid) = id))"
        },
        {
          "schema": "public",
          "table_name": "profiles",
          "policy_name": "profiles_select_unified",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (id = ( SELECT auth.uid() AS uid)))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "profiles",
          "policy_name": "profiles_update_unified",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (id = ( SELECT auth.uid() AS uid)))",
          "with_check_expr": "(is_admin() OR (id = ( SELECT auth.uid() AS uid)))"
        },
        {
          "schema": "public",
          "table_name": "recompenses",
          "policy_name": "recompenses_delete_unified",
          "polcmd": "DELETE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "recompenses",
          "policy_name": "recompenses_insert_unified",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "(is_admin() OR ((user_id = ( SELECT auth.uid() AS uid)) AND check_user_quota(( SELECT auth.uid() AS uid), 'reward'::text, 'total'::text) AND check_user_quota(( SELECT auth.uid() AS uid), 'reward'::text, 'monthly'::text)))"
        },
        {
          "schema": "public",
          "table_name": "recompenses",
          "policy_name": "recompenses_select_demo",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{anon}",
          "using_expr": "(visible_en_demo = true)",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "recompenses",
          "policy_name": "recompenses_select_unified",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)) OR ((user_id IS NULL) AND (visible_en_demo = true)))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "recompenses",
          "policy_name": "recompenses_update_unified",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
          "with_check_expr": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))"
        },
        {
          "schema": "public",
          "table_name": "role_permissions",
          "policy_name": "role_permissions_select_unified",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (EXISTS ( SELECT 1\n   FROM user_roles ur\n  WHERE ((ur.user_id = ( SELECT auth.uid() AS uid)) AND (ur.role_id = role_permissions.role_id) AND (ur.is_active = true)))))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "role_quotas",
          "policy_name": "role_quotas_select_public",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{public}",
          "using_expr": "true",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "role_quotas_backup_legacy",
          "policy_name": "block_all_access",
          "polcmd": "ALL",
          "mode": "PERMISSIVE",
          "roles": "{public}",
          "using_expr": "false",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "roles",
          "policy_name": "roles_select_unified",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (is_active = true))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "stations",
          "policy_name": "stations_select_anon",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{anon}",
          "using_expr": "true",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "stations",
          "policy_name": "stations_select_unified",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "true",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "subscription_logs",
          "policy_name": "logs_select_user_or_admin",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((user_id = ( SELECT auth.uid() AS uid)) OR is_admin())",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "taches",
          "policy_name": "taches_delete_unified",
          "polcmd": "DELETE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "taches",
          "policy_name": "taches_insert_unified",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "(is_admin() OR ((user_id = ( SELECT auth.uid() AS uid)) AND check_user_quota(( SELECT auth.uid() AS uid), 'task'::text, 'total'::text) AND check_user_quota(( SELECT auth.uid() AS uid), 'task'::text, 'monthly'::text)))"
        },
        {
          "schema": "public",
          "table_name": "taches",
          "policy_name": "taches_select_demo",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{anon}",
          "using_expr": "(visible_en_demo = true)",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "taches",
          "policy_name": "taches_select_owner_or_admin",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((user_id = ( SELECT auth.uid() AS uid)) OR is_admin())",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "taches",
          "policy_name": "taches_update_unified",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
          "with_check_expr": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))"
        },
        {
          "schema": "public",
          "table_name": "user_assets",
          "policy_name": "user_assets_delete_unified",
          "polcmd": "DELETE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (( SELECT auth.uid() AS uid) = user_id))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "user_assets",
          "policy_name": "user_assets_insert_self",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "(( SELECT auth.uid() AS uid) = user_id)"
        },
        {
          "schema": "public",
          "table_name": "user_assets",
          "policy_name": "user_assets_select_unified",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (( SELECT auth.uid() AS uid) = user_id))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "user_assets",
          "policy_name": "user_assets_update_unified",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (( SELECT auth.uid() AS uid) = user_id))",
          "with_check_expr": "(is_admin() OR (( SELECT auth.uid() AS uid) = user_id))"
        },
        {
          "schema": "public",
          "table_name": "user_prefs",
          "policy_name": "user_prefs_select_self",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(( SELECT auth.uid() AS uid) = user_id)",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "user_prefs",
          "policy_name": "user_prefs_update_self",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(( SELECT auth.uid() AS uid) = user_id)",
          "with_check_expr": "(( SELECT auth.uid() AS uid) = user_id)"
        },
        {
          "schema": "public",
          "table_name": "user_prefs",
          "policy_name": "user_prefs_upsert_self",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "(( SELECT auth.uid() AS uid) = user_id)"
        },
        {
          "schema": "public",
          "table_name": "user_roles",
          "policy_name": "user_roles_insert_unified",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "(is_admin() OR ((user_id = ( SELECT auth.uid() AS uid)) AND (role_id IN ( SELECT roles.id\n   FROM roles\n  WHERE ((roles.name = 'free'::text) AND (roles.is_active = true))))))"
        },
        {
          "schema": "public",
          "table_name": "user_roles",
          "policy_name": "user_roles_select_unified",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
          "with_check_expr": null
        },
        {
          "schema": "public",
          "table_name": "user_roles",
          "policy_name": "user_roles_update_unified",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
          "with_check_expr": "(is_admin() OR ((user_id = ( SELECT auth.uid() AS uid)) AND (role_id IN ( SELECT roles.id\n   FROM roles\n  WHERE ((roles.name = 'free'::text) AND (roles.is_active = true))))))"
        },
        {
          "schema": "public",
          "table_name": "user_usage_counters",
          "policy_name": "user_usage_counters_select_self",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "(( SELECT auth.uid() AS uid) = user_id)",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "buckets",
          "policy_name": "buckets_admin_all",
          "polcmd": "ALL",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "is_admin()",
          "with_check_expr": "is_admin()"
        },
        {
          "schema": "storage",
          "table_name": "buckets",
          "policy_name": "buckets_select_authenticated",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "true",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "avatars_delete_admin",
          "polcmd": "DELETE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'avatars'::text) AND is_admin())",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "avatars_delete_own_files",
          "polcmd": "DELETE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'avatars'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "avatars_select_admin",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'avatars'::text) AND is_admin())",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "avatars_select_own_files",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'avatars'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "avatars_update_admin",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'avatars'::text) AND is_admin())",
          "with_check_expr": "((bucket_id = 'avatars'::text) AND is_admin())"
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "avatars_update_own_files",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'avatars'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))",
          "with_check_expr": "((bucket_id = 'avatars'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))"
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "avatars_upload_admin",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "((bucket_id = 'avatars'::text) AND is_admin())"
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "avatars_upload_own_files",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "((bucket_id = 'avatars'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))"
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "demo_images_delete_admin",
          "polcmd": "DELETE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'demo-images'::text) AND is_admin())",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "demo_images_insert_admin",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "((bucket_id = 'demo-images'::text) AND is_admin())"
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "demo_images_select_public",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{public}",
          "using_expr": "(bucket_id = 'demo-images'::text)",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "demo_images_update_admin",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'demo-images'::text) AND is_admin())",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "images_delete_admin",
          "polcmd": "DELETE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'images'::text) AND is_admin())",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "images_delete_own_files",
          "polcmd": "DELETE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'images'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "images_select_admin",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'images'::text) AND is_admin())",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "images_select_own_files",
          "polcmd": "SELECT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'images'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))",
          "with_check_expr": null
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "images_update_admin",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'images'::text) AND is_admin())",
          "with_check_expr": "((bucket_id = 'images'::text) AND is_admin())"
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "images_update_own_files",
          "polcmd": "UPDATE",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": "((bucket_id = 'images'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))",
          "with_check_expr": "((bucket_id = 'images'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))"
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "images_upload_admin",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "((bucket_id = 'images'::text) AND is_admin())"
        },
        {
          "schema": "storage",
          "table_name": "objects",
          "policy_name": "images_upload_own_files",
          "polcmd": "INSERT",
          "mode": "PERMISSIVE",
          "roles": "{authenticated}",
          "using_expr": null,
          "with_check_expr": "((bucket_id = 'images'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))"
        }
      ],
      "anomaly_rls_on_no_policy": null,
      "anomaly_rls_off_has_policies": null,
      "restrictive_policies": null,
      "security_definer_funcs": [
        {
          "schema": "public",
          "function_name": "_compute_my_permissions",
          "args": "",
          "language": "sql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "_compute_my_primary_role",
          "args": "",
          "language": "sql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "assert_self_or_admin",
          "args": "p_target uuid",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "bump_usage_counter",
          "args": "p_user uuid, p_col text, p_delta integer",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "categories_counter_del",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "categories_counter_ins",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "change_account_status",
          "args": "target_user_id uuid, new_status text, changed_by_user_id uuid, reason text, metadata jsonb",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "check_image_quota",
          "args": "p_user_id uuid, p_asset_type text, p_file_size bigint",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "check_user_quota",
          "args": "user_uuid uuid, quota_type text, quota_period text",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "check_user_quota_free_only",
          "args": "p_user_id uuid, p_quota_type text, p_period text",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "cleanup_old_audit_logs",
          "args": "retention_days integer",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "email_exists",
          "args": "email_to_check text",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_account_history",
          "args": "user_uuid uuid, limit_count integer",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_account_status",
          "args": "user_uuid uuid",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_confettis",
          "args": "",
          "language": "sql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_demo_cards",
          "args": "card_type_filter text",
          "language": "sql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_demo_rewards",
          "args": "",
          "language": "sql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_demo_tasks",
          "args": "",
          "language": "sql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_migration_report",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_my_permissions",
          "args": "",
          "language": "sql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_my_primary_role",
          "args": "",
          "language": "sql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_usage",
          "args": "p_user_id uuid",
          "language": "sql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_usage_fast",
          "args": "p_user_id uuid",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_user_assets_stats",
          "args": "p_user_id uuid",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_user_emails",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_user_last_logins",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_user_month_bounds_utc",
          "args": "p_user_id uuid",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_user_permissions",
          "args": "user_uuid uuid",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_user_primary_role",
          "args": "p_user_id uuid",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_user_quota_info",
          "args": "user_uuid uuid, quota_type text, quota_period text",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "get_user_roles",
          "args": "p_user_id uuid",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "handle_new_user",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "handle_subscription_role_change",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "is_admin",
          "args": "",
          "language": "sql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "is_subscriber",
          "args": "p_user uuid",
          "language": "sql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "log_card_creation",
          "args": "_user uuid, _entity text, _id uuid",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "purge_old_consentements",
          "args": "retention_months integer",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "recompenses_counter_del",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "recompenses_counter_ins",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "taches_counter_del",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "taches_counter_ins",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "tg_categories_fill_value",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "tg_categories_set_user_id",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "tg_on_auth_user_created",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "tg_recompenses_set_user_id",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "tg_taches_log_neutral",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        },
        {
          "schema": "public",
          "function_name": "tg_taches_set_user_id",
          "args": "",
          "language": "plpgsql",
          "owner": "postgres",
          "security_definer": true,
          "has_search_path_set": true
        }
      ],
      "secdef_auth_uid_no_guard": null,
      "schema_grants": [
        {
          "schema": "public",
          "grantee": "PUBLIC",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "grantee": "anon",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "grantee": "authenticated",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "grantee": "pg_database_owner",
          "privilege": "CREATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "grantee": "pg_database_owner",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "grantee": "postgres",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "grantee": "service_role",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "storage",
          "grantee": "anon",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "storage",
          "grantee": "authenticated",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "storage",
          "grantee": "dashboard_user",
          "privilege": "CREATE",
          "is_grantable": false
        },
        {
          "schema": "storage",
          "grantee": "dashboard_user",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "storage",
          "grantee": "postgres",
          "privilege": "USAGE",
          "is_grantable": true
        },
        {
          "schema": "storage",
          "grantee": "service_role",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "storage",
          "grantee": "supabase_admin",
          "privilege": "CREATE",
          "is_grantable": false
        },
        {
          "schema": "storage",
          "grantee": "supabase_admin",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "storage",
          "grantee": "supabase_storage_admin",
          "privilege": "CREATE",
          "is_grantable": false
        },
        {
          "schema": "storage",
          "grantee": "supabase_storage_admin",
          "privilege": "USAGE",
          "is_grantable": false
        }
      ],
      "default_privileges": [
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "S",
          "grantee": "anon",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "S",
          "grantee": "anon",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "S",
          "grantee": "anon",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "S",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "S",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "S",
          "grantee": "authenticated",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "S",
          "grantee": "postgres",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "S",
          "grantee": "postgres",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "S",
          "grantee": "postgres",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "S",
          "grantee": "service_role",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "S",
          "grantee": "service_role",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "S",
          "grantee": "service_role",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "f",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "f",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "f",
          "grantee": "postgres",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "f",
          "grantee": "service_role",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "MAINTAIN",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "REFERENCES",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "TRIGGER",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "TRUNCATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "MAINTAIN",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "REFERENCES",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "TRIGGER",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "TRUNCATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "MAINTAIN",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "REFERENCES",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "TRIGGER",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "TRUNCATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "postgres",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "S",
          "grantee": "anon",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "S",
          "grantee": "anon",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "S",
          "grantee": "anon",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "S",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "S",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "S",
          "grantee": "authenticated",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "S",
          "grantee": "postgres",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "S",
          "grantee": "postgres",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "S",
          "grantee": "postgres",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "S",
          "grantee": "service_role",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "S",
          "grantee": "service_role",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "S",
          "grantee": "service_role",
          "privilege": "USAGE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "f",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "f",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "f",
          "grantee": "postgres",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "f",
          "grantee": "service_role",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "anon",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "anon",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "anon",
          "privilege": "MAINTAIN",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "anon",
          "privilege": "REFERENCES",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "anon",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "anon",
          "privilege": "TRIGGER",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "anon",
          "privilege": "TRUNCATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "anon",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "MAINTAIN",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "REFERENCES",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "TRIGGER",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "TRUNCATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "MAINTAIN",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "REFERENCES",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "TRIGGER",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "TRUNCATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "postgres",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "MAINTAIN",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "REFERENCES",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "TRIGGER",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "TRUNCATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "definer_role": "supabase_admin",
          "object_type": "r",
          "grantee": "service_role",
          "privilege": "UPDATE",
          "is_grantable": false
        }
      ],
      "table_grants": [
        {
          "schema": "public",
          "table_name": "abonnements",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "account_audit_logs",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "account_audit_logs",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "categories",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "categories",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "categories",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "categories",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "consentements",
          "grantee": "anon",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "consentements",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "consentements",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "consentements_latest",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "demo_cards",
          "grantee": "anon",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "demo_cards",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "demo_cards",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "demo_cards",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "demo_cards",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "features",
          "grantee": "anon",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "features",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "features",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "features",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "features",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "parametres",
          "grantee": "anon",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "parametres",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "parametres",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "parametres",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "permission_changes",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "permission_changes",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "permission_changes",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "permission_changes",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "profiles",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "profiles",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "profiles",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "profiles",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "recompenses",
          "grantee": "anon",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "recompenses",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "recompenses",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "recompenses",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "recompenses",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_permissions",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_permissions",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_permissions",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_permissions",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_permissions_admin_view",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_quotas",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_quotas",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_quotas",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_quotas",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_quotas_backup_legacy",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_quotas_backup_legacy",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_quotas_backup_legacy",
          "grantee": "authenticated",
          "privilege": "MAINTAIN",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_quotas_backup_legacy",
          "grantee": "authenticated",
          "privilege": "REFERENCES",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_quotas_backup_legacy",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_quotas_backup_legacy",
          "grantee": "authenticated",
          "privilege": "TRIGGER",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_quotas_backup_legacy",
          "grantee": "authenticated",
          "privilege": "TRUNCATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "role_quotas_backup_legacy",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "roles",
          "grantee": "anon",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "roles",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "roles",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "roles",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "roles",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "stations",
          "grantee": "anon",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "stations",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "stations",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "stations",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "stations",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "subscription_logs",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "taches",
          "grantee": "anon",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "taches",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "taches",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "taches",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "taches",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_assets",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_assets",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_assets",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_assets",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_prefs",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_prefs",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_prefs",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_prefs",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_roles",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_roles",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_roles",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_roles",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "user_usage_counters",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_role_quota_matrix",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_role_quota_matrix",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_role_quota_matrix",
          "grantee": "authenticated",
          "privilege": "MAINTAIN",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_role_quota_matrix",
          "grantee": "authenticated",
          "privilege": "REFERENCES",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_role_quota_matrix",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_role_quota_matrix",
          "grantee": "authenticated",
          "privilege": "TRIGGER",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_role_quota_matrix",
          "grantee": "authenticated",
          "privilege": "TRUNCATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_role_quota_matrix",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_user_storage_usage",
          "grantee": "authenticated",
          "privilege": "DELETE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_user_storage_usage",
          "grantee": "authenticated",
          "privilege": "INSERT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_user_storage_usage",
          "grantee": "authenticated",
          "privilege": "MAINTAIN",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_user_storage_usage",
          "grantee": "authenticated",
          "privilege": "REFERENCES",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_user_storage_usage",
          "grantee": "authenticated",
          "privilege": "SELECT",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_user_storage_usage",
          "grantee": "authenticated",
          "privilege": "TRIGGER",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_user_storage_usage",
          "grantee": "authenticated",
          "privilege": "TRUNCATE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "table_name": "v_user_storage_usage",
          "grantee": "authenticated",
          "privilege": "UPDATE",
          "is_grantable": false
        }
      ],
      "func_grants": [
        {
          "schema": "public",
          "function_name": "_compute_my_permissions",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "_compute_my_permissions",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "_compute_my_permissions",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "_compute_my_primary_role",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "_compute_my_primary_role",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "_compute_my_primary_role",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "assert_self_or_admin",
          "args": "p_target uuid",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "categories_counter_del",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "categories_counter_del",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "categories_counter_ins",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "categories_counter_ins",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "change_account_status",
          "args": "target_user_id uuid, new_status text, changed_by_user_id uuid, reason text, metadata jsonb",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "check_image_quota",
          "args": "p_user_id uuid, p_asset_type text, p_file_size bigint",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "check_user_quota",
          "args": "user_uuid uuid, quota_type text, quota_period text",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "check_user_quota_free_only",
          "args": "p_user_id uuid, p_quota_type text, p_period text",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "cleanup_old_audit_logs",
          "args": "retention_days integer",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "email_exists",
          "args": "email_to_check text",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "generate_unique_pseudo",
          "args": "base text",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "generate_unique_pseudo",
          "args": "base text",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "generate_unique_pseudo",
          "args": "base text",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_account_history",
          "args": "user_uuid uuid, limit_count integer",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_account_status",
          "args": "user_uuid uuid",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_confettis",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_confettis",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_demo_cards",
          "args": "card_type_filter text",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_demo_cards",
          "args": "card_type_filter text",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_demo_rewards",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_demo_rewards",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_demo_tasks",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_demo_tasks",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_migration_report",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_my_permissions",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_my_permissions",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_my_permissions",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_my_primary_role",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_my_primary_role",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_my_primary_role",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_usage",
          "args": "p_user_id uuid",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_usage",
          "args": "p_user_id uuid",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_usage",
          "args": "p_user_id uuid",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_usage_fast",
          "args": "p_user_id uuid",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_user_assets_stats",
          "args": "p_user_id uuid",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_user_emails",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_user_last_logins",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_user_month_bounds_utc",
          "args": "p_user_id uuid",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_user_permissions",
          "args": "user_uuid uuid",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_user_primary_role",
          "args": "p_user_id uuid",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_user_quota_info",
          "args": "user_uuid uuid, quota_type text, quota_period text",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "get_user_roles",
          "args": "p_user_id uuid",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "is_admin",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "is_admin",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "is_subscriber",
          "args": "p_user uuid",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "is_subscriber",
          "args": "p_user uuid",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "is_subscriber",
          "args": "p_user uuid",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "log_card_creation",
          "args": "_user uuid, _entity text, _id uuid",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "log_card_creation",
          "args": "_user uuid, _entity text, _id uuid",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "log_card_creation",
          "args": "_user uuid, _entity text, _id uuid",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "prevent_system_role_delete",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "prevent_system_role_delete",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "prevent_system_role_delete",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "purge_old_consentements",
          "args": "retention_months integer",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "recompenses_counter_del",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "recompenses_counter_del",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "recompenses_counter_del",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "recompenses_counter_ins",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "recompenses_counter_ins",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "recompenses_counter_ins",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "taches_counter_del",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "taches_counter_del",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "taches_counter_ins",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "taches_counter_ins",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_categories_fill_value",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_categories_fill_value",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_categories_fill_value",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_categories_set_user_id",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_categories_set_user_id",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_categories_set_user_id",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_on_auth_user_created",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_on_auth_user_created",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_on_auth_user_created",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_recompenses_set_user_id",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_recompenses_set_user_id",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_recompenses_set_user_id",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_taches_log_neutral",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_taches_log_neutral",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_taches_log_neutral",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_taches_normalize_categorie",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_taches_normalize_categorie",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_taches_normalize_categorie",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_taches_set_user_id",
          "args": "",
          "grantee": "PUBLIC",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_taches_set_user_id",
          "args": "",
          "grantee": "anon",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "tg_taches_set_user_id",
          "args": "",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        },
        {
          "schema": "public",
          "function_name": "user_can_upload_avatar",
          "args": "uid uuid",
          "grantee": "authenticated",
          "privilege": "EXECUTE",
          "is_grantable": false
        }
      ],
      "indexes_report": [
        {
          "schema": "public",
          "table": "abonnements",
          "index": "abonnements_active_idx",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "(status = ANY (ARRAY['trialing'::text, 'active'::text, 'past_due'::text, 'paused'::text]))",
          "definition": "CREATE INDEX abonnements_active_idx ON public.abonnements USING btree (user_id) WHERE (status = ANY (ARRAY['trialing'::text, 'active'::text, 'past_due'::text, 'paused'::text]))",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "abonnements",
          "index": "abonnements_active_user_created_desc_idx",
          "method": "btree",
          "columns": ["user_id", "created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "(status = ANY (ARRAY['trialing'::text, 'active'::text, 'past_due'::text, 'paused'::text]))",
          "definition": "CREATE INDEX abonnements_active_user_created_desc_idx ON public.abonnements USING btree (user_id, created_at DESC) WHERE (status = ANY (ARRAY['trialing'::text, 'active'::text, 'past_due'::text, 'paused'::text]))",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "abonnements",
          "index": "abonnements_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX abonnements_pkey ON public.abonnements USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "abonnements",
          "index": "abonnements_status_idx",
          "method": "btree",
          "columns": ["status"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX abonnements_status_idx ON public.abonnements USING btree (status)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "abonnements",
          "index": "abonnements_stripe_subscription_id_idx",
          "method": "btree",
          "columns": ["stripe_subscription_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX abonnements_stripe_subscription_id_idx ON public.abonnements USING btree (stripe_subscription_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "abonnements",
          "index": "abonnements_stripe_subscription_id_key",
          "method": "btree",
          "columns": ["stripe_subscription_id"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX abonnements_stripe_subscription_id_key ON public.abonnements USING btree (stripe_subscription_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "abonnements",
          "index": "abonnements_unique_active_per_user",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "(status = ANY (ARRAY['trialing'::text, 'active'::text, 'past_due'::text, 'paused'::text]))",
          "definition": "CREATE UNIQUE INDEX abonnements_unique_active_per_user ON public.abonnements USING btree (user_id) WHERE (status = ANY (ARRAY['trialing'::text, 'active'::text, 'past_due'::text, 'paused'::text]))",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "abonnements",
          "index": "abonnements_user_created_desc_idx",
          "method": "btree",
          "columns": ["user_id", "created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX abonnements_user_created_desc_idx ON public.abonnements USING btree (user_id, created_at DESC)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "abonnements",
          "index": "idx_abonnements_stripe_customer",
          "method": "btree",
          "columns": ["stripe_customer"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_abonnements_stripe_customer ON public.abonnements USING btree (stripe_customer)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "abonnements",
          "index": "idx_abonnements_user_status_created",
          "method": "btree",
          "columns": ["user_id", "status", "created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_abonnements_user_status_created ON public.abonnements USING btree (user_id, status, created_at DESC)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "abonnements",
          "index": "idx_abos_last_event_id_unique",
          "method": "btree",
          "columns": ["last_event_id"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "(last_event_id IS NOT NULL)",
          "definition": "CREATE UNIQUE INDEX idx_abos_last_event_id_unique ON public.abonnements USING btree (last_event_id) WHERE (last_event_id IS NOT NULL)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "account_audit_logs",
          "index": "account_audit_logs_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX account_audit_logs_pkey ON public.account_audit_logs USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "account_audit_logs",
          "index": "account_audit_logs_user_created_desc_idx",
          "method": "btree",
          "columns": ["user_id", "created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX account_audit_logs_user_created_desc_idx ON public.account_audit_logs USING btree (user_id, created_at DESC)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "account_audit_logs",
          "index": "idx_account_audit_logs_action",
          "method": "btree",
          "columns": ["action"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_account_audit_logs_action ON public.account_audit_logs USING btree (action)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "account_audit_logs",
          "index": "idx_account_audit_logs_changed_by",
          "method": "btree",
          "columns": ["changed_by"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_account_audit_logs_changed_by ON public.account_audit_logs USING btree (changed_by)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "account_audit_logs",
          "index": "idx_account_audit_logs_created_at",
          "method": "btree",
          "columns": ["created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_account_audit_logs_created_at ON public.account_audit_logs USING btree (created_at DESC)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "account_audit_logs",
          "index": "idx_account_audit_logs_user_id",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_account_audit_logs_user_id ON public.account_audit_logs USING btree (user_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "categories",
          "index": "categories_global_value_unique",
          "method": "btree",
          "columns": ["value"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "(user_id IS NULL)",
          "definition": "CREATE UNIQUE INDEX categories_global_value_unique ON public.categories USING btree (value) WHERE (user_id IS NULL)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "categories",
          "index": "categories_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX categories_pkey ON public.categories USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "categories",
          "index": "categories_user_id_idx",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX categories_user_id_idx ON public.categories USING btree (user_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "categories",
          "index": "categories_user_value_unique",
          "method": "btree",
          "columns": ["user_id", "value"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "(user_id IS NOT NULL)",
          "definition": "CREATE UNIQUE INDEX categories_user_value_unique ON public.categories USING btree (user_id, value) WHERE (user_id IS NOT NULL)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "categories",
          "index": "categories_value_idx",
          "method": "btree",
          "columns": ["value"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX categories_value_idx ON public.categories USING btree (value)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "categories",
          "index": "idx_categories_user_created",
          "method": "btree",
          "columns": ["user_id", "created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_categories_user_created ON public.categories USING btree (user_id, created_at)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "consentements",
          "index": "consentements_origin_created_idx",
          "method": "btree",
          "columns": ["origin", "created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX consentements_origin_created_idx ON public.consentements USING btree (origin, created_at DESC)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "consentements",
          "index": "consentements_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX consentements_pkey ON public.consentements USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "consentements",
          "index": "consentements_ts_idx",
          "method": "btree",
          "columns": ["ts"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX consentements_ts_idx ON public.consentements USING btree (ts)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "consentements",
          "index": "consentements_user_created_idx",
          "method": "btree",
          "columns": ["user_id", "created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX consentements_user_created_idx ON public.consentements USING btree (user_id, created_at DESC)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "consentements",
          "index": "idx_consentements_user_ts",
          "method": "btree",
          "columns": ["user_id", "ts"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_consentements_user_ts ON public.consentements USING btree (user_id, ts)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "demo_cards",
          "index": "demo_cards_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX demo_cards_pkey ON public.demo_cards USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "demo_cards",
          "index": "idx_demo_cards_active",
          "method": "btree",
          "columns": ["is_active"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_demo_cards_active ON public.demo_cards USING btree (is_active)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "demo_cards",
          "index": "idx_demo_cards_position",
          "method": "btree",
          "columns": ["position"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_demo_cards_position ON public.demo_cards USING btree (\"position\")",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "demo_cards",
          "index": "idx_demo_cards_type",
          "method": "btree",
          "columns": ["card_type"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_demo_cards_type ON public.demo_cards USING btree (card_type)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "features",
          "index": "features_name_key",
          "method": "btree",
          "columns": ["name"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX features_name_key ON public.features USING btree (name)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "features",
          "index": "features_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX features_pkey ON public.features USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "features",
          "index": "idx_features_active_category",
          "method": "btree",
          "columns": ["is_active", "category"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_features_active_category ON public.features USING btree (is_active, category)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "parametres",
          "index": "parametres_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX parametres_pkey ON public.parametres USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "permission_changes",
          "index": "permission_changes_change_type_idx",
          "method": "btree",
          "columns": ["change_type"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX permission_changes_change_type_idx ON public.permission_changes USING btree (change_type)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "permission_changes",
          "index": "permission_changes_changed_at_idx",
          "method": "btree",
          "columns": ["changed_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX permission_changes_changed_at_idx ON public.permission_changes USING btree (changed_at DESC)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "permission_changes",
          "index": "permission_changes_changed_by_idx",
          "method": "btree",
          "columns": ["changed_by"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX permission_changes_changed_by_idx ON public.permission_changes USING btree (changed_by)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "permission_changes",
          "index": "permission_changes_created_at_idx",
          "method": "btree",
          "columns": ["created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX permission_changes_created_at_idx ON public.permission_changes USING btree (created_at DESC)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "permission_changes",
          "index": "permission_changes_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX permission_changes_pkey ON public.permission_changes USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "permission_changes",
          "index": "permission_changes_record_id_idx",
          "method": "btree",
          "columns": ["record_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX permission_changes_record_id_idx ON public.permission_changes USING btree (record_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "permission_changes",
          "index": "permission_changes_table_name_idx",
          "method": "btree",
          "columns": ["table_name"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX permission_changes_table_name_idx ON public.permission_changes USING btree (table_name)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "permission_changes",
          "index": "permission_changes_table_type_idx",
          "method": "btree",
          "columns": ["table_name", "change_type"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX permission_changes_table_type_idx ON public.permission_changes USING btree (table_name, change_type)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "profiles",
          "index": "idx_profiles_account_status",
          "method": "btree",
          "columns": ["account_status"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_profiles_account_status ON public.profiles USING btree (account_status)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "profiles",
          "index": "idx_profiles_deletion_scheduled",
          "method": "btree",
          "columns": ["deletion_scheduled_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "(account_status = 'deletion_scheduled'::text)",
          "definition": "CREATE INDEX idx_profiles_deletion_scheduled ON public.profiles USING btree (deletion_scheduled_at) WHERE (account_status = 'deletion_scheduled'::text)",
          "tablespace": null,
          "size_pretty": "8192 bytes",
          "size_bytes": 8192
        },
        {
          "schema": "public",
          "table": "profiles",
          "index": "idx_profiles_is_admin",
          "method": "btree",
          "columns": ["is_admin"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_profiles_is_admin ON public.profiles USING btree (is_admin)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "profiles",
          "index": "idx_profiles_updated_at",
          "method": "btree",
          "columns": ["updated_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_profiles_updated_at ON public.profiles USING btree (updated_at DESC)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "profiles",
          "index": "profiles_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX profiles_pkey ON public.profiles USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "profiles",
          "index": "profiles_pseudo_unique",
          "method": "btree",
          "columns": ["pseudo"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX profiles_pseudo_unique ON public.profiles USING btree (pseudo)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "recompenses",
          "index": "idx_recompenses_user_created",
          "method": "btree",
          "columns": ["user_id", "created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_recompenses_user_created ON public.recompenses USING btree (user_id, created_at)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "recompenses",
          "index": "recompenses_one_selected_per_user",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "((selected IS TRUE) AND (user_id IS NOT NULL))",
          "definition": "CREATE UNIQUE INDEX recompenses_one_selected_per_user ON public.recompenses USING btree (user_id) WHERE ((selected IS TRUE) AND (user_id IS NOT NULL))",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "recompenses",
          "index": "recompenses_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX recompenses_pkey ON public.recompenses USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "recompenses",
          "index": "recompenses_points_requis_idx",
          "method": "btree",
          "columns": ["points_requis"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX recompenses_points_requis_idx ON public.recompenses USING btree (points_requis)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "recompenses",
          "index": "recompenses_selected_idx",
          "method": "btree",
          "columns": ["selected"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX recompenses_selected_idx ON public.recompenses USING btree (selected)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "recompenses",
          "index": "recompenses_user_id_idx",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX recompenses_user_id_idx ON public.recompenses USING btree (user_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "recompenses",
          "index": "recompenses_user_selected_idx",
          "method": "btree",
          "columns": ["user_id", "selected"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX recompenses_user_selected_idx ON public.recompenses USING btree (user_id, selected)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "recompenses",
          "index": "recompenses_visible_en_demo_idx",
          "method": "btree",
          "columns": ["visible_en_demo"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX recompenses_visible_en_demo_idx ON public.recompenses USING btree (visible_en_demo)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "role_permissions",
          "index": "idx_role_permissions_feature_id",
          "method": "btree",
          "columns": ["feature_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_role_permissions_feature_id ON public.role_permissions USING btree (feature_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "role_permissions",
          "index": "idx_role_permissions_role_access",
          "method": "btree",
          "columns": ["role_id", "can_access"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_role_permissions_role_access ON public.role_permissions USING btree (role_id, can_access)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "role_permissions",
          "index": "role_permissions_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX role_permissions_pkey ON public.role_permissions USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "role_permissions",
          "index": "role_permissions_role_id_feature_id_key",
          "method": "btree",
          "columns": ["role_id", "feature_id"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX role_permissions_role_id_feature_id_key ON public.role_permissions USING btree (role_id, feature_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "role_quotas",
          "index": "idx_role_quotas_role_type",
          "method": "btree",
          "columns": ["role_id", "quota_type"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_role_quotas_role_type ON public.role_quotas USING btree (role_id, quota_type)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "role_quotas",
          "index": "role_quotas_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX role_quotas_pkey ON public.role_quotas USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "role_quotas",
          "index": "role_quotas_role_id_quota_type_quota_period_key",
          "method": "btree",
          "columns": ["role_id", "quota_type", "quota_period"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX role_quotas_role_id_quota_type_quota_period_key ON public.role_quotas USING btree (role_id, quota_type, quota_period)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "roles",
          "index": "idx_roles_is_active",
          "method": "btree",
          "columns": ["is_active"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "(is_active = true)",
          "definition": "CREATE INDEX idx_roles_is_active ON public.roles USING btree (is_active) WHERE (is_active = true)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "roles",
          "index": "idx_roles_priority_name",
          "method": "btree",
          "columns": ["priority", "name"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_roles_priority_name ON public.roles USING btree (priority DESC, name)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "roles",
          "index": "roles_name_key",
          "method": "btree",
          "columns": ["name"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX roles_name_key ON public.roles USING btree (name)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "roles",
          "index": "roles_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX roles_pkey ON public.roles USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "stations",
          "index": "stations_label_idx",
          "method": "btree",
          "columns": ["label"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX stations_label_idx ON public.stations USING btree (label)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "stations",
          "index": "stations_ligne_type_idx",
          "method": "btree",
          "columns": ["ligne", "type"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX stations_ligne_type_idx ON public.stations USING btree (ligne, type)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "stations",
          "index": "stations_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX stations_pkey ON public.stations USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "stations",
          "index": "stations_type_ligne_label_unique",
          "method": "btree",
          "columns": ["type", "ligne", "label"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX stations_type_ligne_label_unique ON public.stations USING btree (type, ligne, label)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "stations",
          "index": "stations_type_ligne_ordre_idx",
          "method": "btree",
          "columns": ["type", "ligne", "ordre"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX stations_type_ligne_ordre_idx ON public.stations USING btree (type, ligne, ordre)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "stations",
          "index": "stations_type_ligne_ordre_unique",
          "method": "btree",
          "columns": ["type", "ligne", "ordre"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX stations_type_ligne_ordre_unique ON public.stations USING btree (type, ligne, ordre)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "subscription_logs",
          "index": "subscription_logs_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX subscription_logs_pkey ON public.subscription_logs USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "subscription_logs",
          "index": "subscription_logs_user_event_time_idx",
          "method": "btree",
          "columns": ["user_id", "event_type", "timestamp"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX subscription_logs_user_event_time_idx ON public.subscription_logs USING btree (user_id, event_type, \"timestamp\" DESC)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "subscription_logs",
          "index": "subscription_logs_user_time_idx",
          "method": "btree",
          "columns": ["user_id", "timestamp"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX subscription_logs_user_time_idx ON public.subscription_logs USING btree (user_id, \"timestamp\" DESC)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "taches",
          "index": "idx_taches_user_created",
          "method": "btree",
          "columns": ["user_id", "created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_taches_user_created ON public.taches USING btree (user_id, created_at)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "taches",
          "index": "taches_categorie_id_idx",
          "method": "btree",
          "columns": ["categorie_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX taches_categorie_id_idx ON public.taches USING btree (categorie_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "taches",
          "index": "taches_categorie_idx",
          "method": "btree",
          "columns": ["categorie"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX taches_categorie_idx ON public.taches USING btree (categorie)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "taches",
          "index": "taches_fait_idx",
          "method": "btree",
          "columns": ["fait"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX taches_fait_idx ON public.taches USING btree (fait)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "taches",
          "index": "taches_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX taches_pkey ON public.taches USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "taches",
          "index": "taches_user_aujourdhui_idx",
          "method": "btree",
          "columns": ["user_id", "aujourdhui"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX taches_user_aujourdhui_idx ON public.taches USING btree (user_id, aujourdhui)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "taches",
          "index": "taches_user_fait_idx",
          "method": "btree",
          "columns": ["user_id", "fait"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX taches_user_fait_idx ON public.taches USING btree (user_id, fait)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "taches",
          "index": "taches_user_fait_true_idx",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "(fait IS TRUE)",
          "definition": "CREATE INDEX taches_user_fait_true_idx ON public.taches USING btree (user_id) WHERE (fait IS TRUE)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "taches",
          "index": "taches_user_id_idx",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX taches_user_id_idx ON public.taches USING btree (user_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "taches",
          "index": "taches_user_position_idx",
          "method": "btree",
          "columns": ["user_id", "position"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX taches_user_position_idx ON public.taches USING btree (user_id, \"position\")",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "taches",
          "index": "taches_visible_en_demo_idx",
          "method": "btree",
          "columns": ["visible_en_demo"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX taches_visible_en_demo_idx ON public.taches USING btree (visible_en_demo)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_assets",
          "index": "idx_user_assets_created",
          "method": "btree",
          "columns": ["created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_user_assets_created ON public.user_assets USING btree (created_at)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_assets",
          "index": "idx_user_assets_type",
          "method": "btree",
          "columns": ["user_id", "asset_type"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_user_assets_type ON public.user_assets USING btree (user_id, asset_type)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_assets",
          "index": "idx_user_assets_user_created_desc",
          "method": "btree",
          "columns": ["user_id", "created_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_user_assets_user_created_desc ON public.user_assets USING btree (user_id, created_at DESC)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_assets",
          "index": "idx_user_assets_user_id",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_user_assets_user_id ON public.user_assets USING btree (user_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_assets",
          "index": "unique_user_file_path",
          "method": "btree",
          "columns": ["user_id", "file_path"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX unique_user_file_path ON public.user_assets USING btree (user_id, file_path)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_assets",
          "index": "user_assets_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX user_assets_pkey ON public.user_assets USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_prefs",
          "index": "idx_user_prefs_tz",
          "method": "btree",
          "columns": ["timezone"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_user_prefs_tz ON public.user_prefs USING btree (timezone)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_prefs",
          "index": "user_prefs_pkey",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX user_prefs_pkey ON public.user_prefs USING btree (user_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_roles",
          "index": "idx_user_roles_expires_at",
          "method": "btree",
          "columns": ["expires_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_user_roles_expires_at ON public.user_roles USING btree (expires_at)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_roles",
          "index": "idx_user_roles_expiring_active",
          "method": "btree",
          "columns": ["expires_at"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "(is_active = true)",
          "definition": "CREATE INDEX idx_user_roles_expiring_active ON public.user_roles USING btree (expires_at) WHERE (is_active = true)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_roles",
          "index": "idx_user_roles_is_active",
          "method": "btree",
          "columns": ["is_active"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_user_roles_is_active ON public.user_roles USING btree (is_active)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_roles",
          "index": "idx_user_roles_role_active",
          "method": "btree",
          "columns": ["role_id", "is_active"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_user_roles_role_active ON public.user_roles USING btree (role_id, is_active)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_roles",
          "index": "idx_user_roles_role_id",
          "method": "btree",
          "columns": ["role_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_user_roles_role_id ON public.user_roles USING btree (role_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_roles",
          "index": "idx_user_roles_user_active",
          "method": "btree",
          "columns": ["user_id", "is_active"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "(is_active = true)",
          "definition": "CREATE INDEX idx_user_roles_user_active ON public.user_roles USING btree (user_id, is_active) WHERE (is_active = true)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_roles",
          "index": "idx_user_roles_user_active_inc",
          "method": "btree",
          "columns": ["user_id", "is_active", "role_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_user_roles_user_active_inc ON public.user_roles USING btree (user_id, is_active) INCLUDE (role_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_roles",
          "index": "idx_user_roles_user_id",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": false,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE INDEX idx_user_roles_user_id ON public.user_roles USING btree (user_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_roles",
          "index": "uq_user_roles_one_active",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": true,
          "is_exclusion": false,
          "predicate": "(is_active = true)",
          "definition": "CREATE UNIQUE INDEX uq_user_roles_one_active ON public.user_roles USING btree (user_id) WHERE (is_active = true)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_roles",
          "index": "user_roles_pkey",
          "method": "btree",
          "columns": ["id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX user_roles_pkey ON public.user_roles USING btree (id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_roles",
          "index": "user_roles_user_id_role_id_key",
          "method": "btree",
          "columns": ["user_id", "role_id"],
          "is_unique": true,
          "is_primary": false,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX user_roles_user_id_role_id_key ON public.user_roles USING btree (user_id, role_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        },
        {
          "schema": "public",
          "table": "user_usage_counters",
          "index": "user_usage_counters_pkey",
          "method": "btree",
          "columns": ["user_id"],
          "is_unique": true,
          "is_primary": true,
          "is_valid": true,
          "is_partial": false,
          "is_exclusion": false,
          "predicate": null,
          "definition": "CREATE UNIQUE INDEX user_usage_counters_pkey ON public.user_usage_counters USING btree (user_id)",
          "tablespace": null,
          "size_pretty": "16 kB",
          "size_bytes": 16384
        }
      ],
      "functions_report": [
        {
          "schema": "public",
          "name": "_compute_my_permissions",
          "args": "",
          "returns": "TABLE(feature_name text, can_access boolean)",
          "language": "sql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public._compute_my_permissions()\n RETURNS TABLE(feature_name text, can_access boolean)\n LANGUAGE sql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\n  with my_role as (\n    select role_id, role_name from public._compute_my_primary_role()\n  )\n  select\n    f.name as feature_name,\n    case\n      when (select role_name from my_role) = 'admin' then true\n      else coalesce(rp.can_access, false)\n    end as can_access\n  from features f\n  left join role_permissions rp\n    on rp.feature_id = f.id\n   and rp.role_id = (select role_id from my_role)\n$function$\n"
        },
        {
          "schema": "public",
          "name": "_compute_my_primary_role",
          "args": "",
          "returns": "TABLE(role_id uuid, role_name text, priority integer)",
          "language": "sql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public._compute_my_primary_role()\n RETURNS TABLE(role_id uuid, role_name text, priority integer)\n LANGUAGE sql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\n  select r.id as role_id, r.name as role_name, r.priority\n  from user_roles ur\n  join roles r on r.id = ur.role_id\n  where ur.user_id = auth.uid()\n    and coalesce(ur.is_active, true) = true\n    and coalesce(r.is_active, true) = true\n  order by r.priority asc\n  limit 1\n$function$\n"
        },
        {
          "schema": "public",
          "name": "assert_self_or_admin",
          "args": "p_target uuid",
          "returns": "void",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.assert_self_or_admin(p_target uuid)\n RETURNS void\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nBEGIN\n  IF p_target IS NULL THEN\n    RAISE EXCEPTION 'Forbidden (target is null)' USING ERRCODE = '42501';\n  END IF;\n\n  IF auth.uid() IS DISTINCT FROM p_target AND NOT public.is_admin() THEN\n    RAISE EXCEPTION 'Forbidden (not self nor admin)' USING ERRCODE = '42501';\n  END IF;\nEND;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "bump_usage_counter",
          "args": "p_user uuid, p_col text, p_delta integer",
          "returns": "void",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_catalog"],
          "search_path": "public, pg_catalog",
          "definition": "CREATE OR REPLACE FUNCTION public.bump_usage_counter(p_user uuid, p_col text, p_delta integer)\n RETURNS void\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public', 'pg_catalog'\nAS $function$\nbegin\n  -- Pas dutilisateur (ligne demo, SQL sans JWT) => on ne compte pas\n  if p_user is null then\n    return;\n  end if;\n\n  update public.user_usage_counters\n     set updated_at = now(),\n         -- pas de valeurs ngatives\n         tasks      = case when p_col = 'tasks'      then greatest(0, tasks + p_delta)      else tasks      end,\n         rewards    = case when p_col = 'rewards'    then greatest(0, rewards + p_delta)    else rewards    end,\n         categories = case when p_col = 'categories' then greatest(0, categories + p_delta) else categories end\n   where user_id = p_user;\n\n  if not found then\n    insert into public.user_usage_counters(user_id, tasks, rewards, categories)\n    values (\n      p_user,\n      case when p_col='tasks'      then greatest(0, p_delta) else 0 end,\n      case when p_col='rewards'    then greatest(0, p_delta) else 0 end,\n      case when p_col='categories' then greatest(0, p_delta) else 0 end\n    );\n  end if;\nend;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "categories_counter_del",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_catalog"],
          "search_path": "public, pg_catalog",
          "definition": "CREATE OR REPLACE FUNCTION public.categories_counter_del()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public', 'pg_catalog'\nAS $function$\nbegin\n  perform public.bump_usage_counter(coalesce(old.user_id, auth.uid()), 'categories', -1);\n  return old;\nend;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "categories_counter_ins",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_catalog"],
          "search_path": "public, pg_catalog",
          "definition": "CREATE OR REPLACE FUNCTION public.categories_counter_ins()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public', 'pg_catalog'\nAS $function$\nbegin\n  perform public.bump_usage_counter(coalesce(new.user_id, auth.uid()), 'categories', 1);\n  return new;\nend;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "change_account_status",
          "args": "target_user_id uuid, new_status text, changed_by_user_id uuid, reason text, metadata jsonb",
          "returns": "boolean",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.change_account_status(target_user_id uuid, new_status text, changed_by_user_id uuid DEFAULT NULL::uuid, reason text DEFAULT NULL::text, metadata jsonb DEFAULT NULL::jsonb)\n RETURNS boolean\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\ndeclare\n  old_status text;\n  old_role text;\n  new_role text;\n  had_admin boolean := false;\nbegin\n  if not public.is_admin() then\n    raise exception 'Permission denied: admin only' using errcode='42501';\n  end if;\n\n  select p.account_status, r.name\n    into old_status, old_role\n  from public.profiles p\n  left join public.user_roles ur on ur.user_id = p.id and ur.is_active = true\n  left join public.roles r on r.id = ur.role_id\n  where p.id = target_user_id;\n\n  had_admin := public.is_admin();\n\n  update public.profiles\n     set account_status = new_status,\n         deletion_scheduled_at = case\n           when new_status = 'deletion_scheduled' then now() + interval '30 days'\n           else null\n         end\n   where id = target_user_id;\n\n  if new_status = 'active' then\n    select case\n      when public.is_subscriber(target_user_id) then 'abonne'\n      else 'free' end\n    into new_role;\n  elsif new_status in ('suspended','deletion_scheduled','pending_verification') then\n    new_role := 'visitor';\n  end if;\n\n  if new_role is not null and new_role <> old_role then\n    update public.user_roles set is_active=false where user_id=target_user_id;\n\n    insert into public.user_roles (user_id, role_id, assigned_by)\n    select target_user_id, r.id, changed_by_user_id\n    from public.roles r\n    where r.name = new_role\n    on conflict (user_id, role_id) do nothing;\n\n    update public.user_roles\n       set is_active=true, updated_at=now()\n     where user_id=target_user_id\n       and role_id in (select id from public.roles where name=new_role);\n  end if;\n\n  if had_admin then\n    update public.profiles set is_admin = true where id = target_user_id;\n  end if;\n\n  insert into public.account_audit_logs(user_id, changed_by, old_status, new_status, reason, metadata, action)\n  values (target_user_id, changed_by_user_id, old_status, new_status, reason, metadata, 'status_change');\n\n  return true;\nend;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "check_image_quota",
          "args": "p_user_id uuid, p_asset_type text, p_file_size bigint",
          "returns": "jsonb",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.check_image_quota(p_user_id uuid, p_asset_type text, p_file_size bigint DEFAULT 0)\n RETURNS jsonb\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nDECLARE\n  v_role record;\n  v_quotas jsonb := '{}'::jsonb;\n  v_stats jsonb;\n  v_can_upload boolean := true;\n  v_reason text;\n  v_max_image_size bigint;\n  v_max_total_size bigint;\n  v_sub record;\nBEGIN\n  -- Garde self/admin\n  PERFORM public.assert_self_or_admin(p_user_id);\n\n  -- Rle prioritaire\n  SELECT r.id, r.name, r.priority\n    INTO v_role\n  FROM public.user_roles ur\n  JOIN public.roles r ON r.id = ur.role_id\n  WHERE ur.user_id = p_user_id AND ur.is_active = true\n  ORDER BY r.priority DESC\n  LIMIT 1;\n\n  --  Fallback si aucun rle encore actif\n  IF v_role.id IS NULL THEN\n    SELECT * INTO v_sub\n    FROM public.abonnements\n    WHERE user_id = p_user_id AND status IN ('active','trialing','past_due','paused')\n    ORDER BY created_at DESC\n    LIMIT 1;\n\n    IF v_sub.id IS NOT NULL THEN\n      SELECT id, name, priority INTO v_role FROM public.roles WHERE name = 'abonne' LIMIT 1;\n    ELSE\n      SELECT id, name, priority INTO v_role FROM public.roles WHERE name = 'free' LIMIT 1;\n    END IF;\n  END IF;\n\n  -- Admin/Staff : pas de limite\n  IF v_role.name IN ('admin','staff') THEN\n    RETURN jsonb_build_object('can_upload', true, 'reason', 'admin_unlimited');\n  END IF;\n\n  -- Quotas image du rle\n  SELECT COALESCE(jsonb_object_agg(quota_type, quota_limit), '{}'::jsonb)\n    INTO v_quotas\n  FROM public.role_quotas\n  WHERE role_id = v_role.id\n    AND quota_type LIKE '%image%';\n\n  -- Stats actuelles\n  SELECT public.get_user_assets_stats(p_user_id) INTO v_stats;\n\n  -- Tailles facultatives\n  v_max_image_size := NULLIF((v_quotas->>'max_image_size')::bigint, 0);\n  v_max_total_size := NULLIF((v_quotas->>'max_total_images_size')::bigint, 0);\n\n  IF p_asset_type NOT IN ('task_image','reward_image') THEN\n    RETURN jsonb_build_object('can_upload', false, 'reason', 'invalid_asset_type');\n  END IF;\n\n  IF v_max_image_size IS NOT NULL AND p_file_size > v_max_image_size THEN\n    v_can_upload := false; v_reason := 'image_too_large';\n  END IF;\n\n  IF v_can_upload AND p_asset_type = 'task_image' THEN\n    IF (v_stats->>'task_images')::int >= COALESCE((v_quotas->>'max_task_images')::int, 2147483647) THEN\n      v_can_upload := false; v_reason := 'task_image_limit_reached';\n    END IF;\n  ELSIF v_can_upload AND p_asset_type = 'reward_image' THEN\n    IF (v_stats->>'reward_images')::int >= COALESCE((v_quotas->>'max_reward_images')::int, 2147483647) THEN\n      v_can_upload := false; v_reason := 'reward_image_limit_reached';\n    END IF;\n  END IF;\n\n  IF v_can_upload AND (v_stats->>'total_images')::int >= COALESCE((v_quotas->>'max_total_images')::int, 2147483647) THEN\n    v_can_upload := false; v_reason := 'total_image_limit_reached';\n  END IF;\n\n  IF v_can_upload AND v_max_total_size IS NOT NULL THEN\n    IF COALESCE((v_stats->>'total_size')::bigint, 0) + GREATEST(p_file_size,0) > v_max_total_size THEN\n      v_can_upload := false; v_reason := 'total_image_size_limit_reached';\n    END IF;\n  END IF;\n\n  RETURN jsonb_build_object(\n    'can_upload', v_can_upload,\n    'reason', COALESCE(v_reason, 'ok'),\n    'role', v_role.name,\n    'quotas', v_quotas,\n    'stats', v_stats\n  );\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "check_user_quota",
          "args": "user_uuid uuid, quota_type text, quota_period text",
          "returns": "boolean",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.check_user_quota(user_uuid uuid, quota_type text, quota_period text DEFAULT 'monthly'::text)\n RETURNS boolean\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nDECLARE\n  v_limit integer;\n  v_usage integer;\n  v_dummy1 integer; v_dummy2 integer; v_is_limited boolean;\nBEGIN\n  PERFORM public.assert_self_or_admin(user_uuid);\n\n  -- Rutilise la logique ci-dessus\n  SELECT quota_limit, current_usage, remaining, is_limited\n  INTO v_limit, v_usage, v_dummy1, v_is_limited\n  FROM public.get_user_quota_info(user_uuid, quota_type, quota_period);\n\n  IF v_limit IS NULL THEN\n    RETURN true; -- pas de limite => autoris\n  END IF;\n\n  RETURN v_usage < v_limit;\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "check_user_quota_free_only",
          "args": "p_user_id uuid, p_quota_type text, p_period text",
          "returns": "boolean",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.check_user_quota_free_only(p_user_id uuid, p_quota_type text, p_period text)\n RETURNS boolean\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nDECLARE\n  v_is_free boolean;\n  v_limite int;\n  v_count int;\n  v_start timestamptz;\n  v_end   timestamptz;\nBEGIN\n  PERFORM public.assert_self_or_admin(p_user_id);\n  IF p_user_id IS NULL THEN RETURN false; END IF;\n\n  SELECT EXISTS (\n    SELECT 1\n    FROM user_roles ur\n    JOIN roles r ON r.id = ur.role_id\n    WHERE ur.user_id = p_user_id AND ur.is_active = true AND r.name = 'free'\n  ) INTO v_is_free;\n\n  IF NOT v_is_free THEN\n    RETURN true; -- on ne bloque que FREE ici\n  END IF;\n\n  SELECT rq.quota_limit\n  INTO v_limite\n  FROM role_quotas rq\n  JOIN roles r ON r.id = rq.role_id\n  WHERE r.name = 'free'\n    AND rq.quota_type = p_quota_type\n    AND rq.quota_period = CASE WHEN p_period='monthly' THEN 'monthly' ELSE 'total' END\n  LIMIT 1;\n\n  IF v_limite IS NULL THEN\n    RETURN true;\n  END IF;\n\n  IF p_period = 'monthly' THEN\n    SELECT start_utc, end_utc INTO v_start, v_end FROM get_user_month_bounds_utc(p_user_id);\n\n    IF p_quota_type = 'task' THEN\n      SELECT COUNT(*) INTO v_count FROM taches\n      WHERE user_id = p_user_id AND created_at >= v_start AND created_at < v_end;\n\n    ELSIF p_quota_type = 'reward' THEN\n      SELECT COUNT(*) INTO v_count FROM recompenses\n      WHERE user_id = p_user_id AND created_at >= v_start AND created_at < v_end;\n\n    ELSIF p_quota_type = 'category' THEN\n      SELECT COUNT(*) INTO v_count FROM categories\n      WHERE user_id = p_user_id AND created_at >= v_start AND created_at < v_end;\n\n    ELSE\n      RETURN true;\n    END IF;\n\n  ELSE\n    IF p_quota_type = 'task' THEN\n      SELECT COUNT(*) INTO v_count FROM taches WHERE user_id = p_user_id;\n    ELSIF p_quota_type = 'reward' THEN\n      SELECT COUNT(*) INTO v_count FROM recompenses WHERE user_id = p_user_id;\n    ELSIF p_quota_type = 'category' THEN\n      SELECT COUNT(*) INTO v_count FROM categories WHERE user_id = p_user_id;\n    ELSE\n      RETURN true;\n    END IF;\n  END IF;\n\n  RETURN v_count < v_limite;\nEND;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "cleanup_old_audit_logs",
          "args": "retention_days integer",
          "returns": "integer",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.cleanup_old_audit_logs(retention_days integer DEFAULT 365)\n RETURNS integer\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nDECLARE\n  deleted_count integer;\nBEGIN\n  IF NOT public.is_admin() THEN\n    RAISE EXCEPTION 'Permission denied: admin only' USING ERRCODE='42501';\n  END IF;\n\n  DELETE FROM public.account_audit_logs\n  WHERE created_at < (now() - make_interval(days => retention_days));\n\n  GET DIAGNOSTICS deleted_count = ROW_COUNT;\n  RETURN deleted_count;\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "email_exists",
          "args": "email_to_check text",
          "returns": "boolean",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.email_exists(email_to_check text)\n RETURNS boolean\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public', 'pg_temp'\nAS $function$\nBEGIN\n    -- Vrifier si l'email existe dans la table auth.users\n    RETURN EXISTS (\n        SELECT 1 \n        FROM auth.users \n        WHERE email = email_to_check\n    );\nEND;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "generate_unique_pseudo",
          "args": "base text",
          "returns": "text",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.generate_unique_pseudo(base text)\n RETURNS text\n LANGUAGE plpgsql\n SET search_path TO 'public', 'pg_temp'\nAS $function$\nDECLARE\n  candidate text := null;\n  i int := 0;\nBEGIN\n  IF base IS NULL OR btrim(base) = '' THEN\n    base := 'Utilisateur';\n  END IF;\n\n  -- nettoyage simple\n  base := lower(regexp_replace(btrim(base), '\\s+', '-', 'g'));\n\n  LOOP\n    candidate := CASE WHEN i = 0 THEN base ELSE base || '-' || i::text END;\n    EXIT WHEN NOT EXISTS (SELECT 1 FROM public.profiles WHERE pseudo = candidate);\n    i := i + 1;\n  END LOOP;\n\n  RETURN candidate;\nEND;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_account_history",
          "args": "user_uuid uuid, limit_count integer",
          "returns": "TABLE(id uuid, action text, old_status text, new_status text, old_role text, new_role text, reason text, changed_by_pseudo text, created_at timestamp with time zone)",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_account_history(user_uuid uuid, limit_count integer DEFAULT 50)\n RETURNS TABLE(id uuid, action text, old_status text, new_status text, old_role text, new_role text, reason text, changed_by_pseudo text, created_at timestamp with time zone)\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nBEGIN\n  PERFORM public.assert_self_or_admin(user_uuid);\n\n  RETURN QUERY\n  SELECT\n    aal.id,\n    aal.action,\n    aal.old_status,\n    aal.new_status,\n    aal.old_role,\n    aal.new_role,\n    aal.reason,\n    p.pseudo AS changed_by_pseudo,\n    aal.created_at\n  FROM public.account_audit_logs aal\n  LEFT JOIN public.profiles p ON p.id = aal.changed_by\n  WHERE aal.user_id = user_uuid\n  ORDER BY aal.created_at DESC\n  LIMIT limit_count;\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_account_status",
          "args": "user_uuid uuid",
          "returns": "TABLE(user_id uuid, account_status text, role_name text, is_suspended boolean, is_pending_verification boolean, is_scheduled_for_deletion boolean, deletion_date timestamp with time zone)",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_account_status(user_uuid uuid)\n RETURNS TABLE(user_id uuid, account_status text, role_name text, is_suspended boolean, is_pending_verification boolean, is_scheduled_for_deletion boolean, deletion_date timestamp with time zone)\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nBEGIN\n  PERFORM public.assert_self_or_admin(user_uuid);\n\n  RETURN QUERY\n  SELECT\n    p.id as user_id,\n    p.account_status,\n    r.name as role_name,\n    (p.account_status = 'suspended') as is_suspended,\n    (p.account_status = 'pending_verification') as is_pending_verification,\n    (p.account_status = 'deletion_scheduled') as is_scheduled_for_deletion,\n    p.deletion_scheduled_at as deletion_date\n  FROM public.profiles p\n  LEFT JOIN public.user_roles ur ON ur.user_id = p.id AND ur.is_active = true\n  LEFT JOIN public.roles r ON r.id = ur.role_id\n  WHERE p.id = user_uuid;\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_confettis",
          "args": "",
          "returns": "boolean",
          "language": "sql",
          "kind": "function",
          "volatility": "stable",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=pg_catalog, public"],
          "search_path": "pg_catalog, public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_confettis()\n RETURNS boolean\n LANGUAGE sql\n STABLE SECURITY DEFINER\n SET search_path TO 'pg_catalog', 'public'\nAS $function$\n  select confettis from public.parametres where id = 1\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_demo_cards",
          "args": "card_type_filter text",
          "returns": "TABLE(id uuid, card_type text, label text, imagepath text, \"position\" integer)",
          "language": "sql",
          "kind": "function",
          "volatility": "stable",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.get_demo_cards(card_type_filter text DEFAULT NULL::text)\n RETURNS TABLE(id uuid, card_type text, label text, imagepath text, \"position\" integer)\n LANGUAGE sql\n STABLE SECURITY DEFINER\n SET search_path TO 'public', 'pg_temp'\nAS $function$\n    SELECT \n        dc.id,\n        dc.card_type,\n        dc.label,\n        dc.imagepath,\n        dc.\"position\"\n    FROM public.demo_cards dc\n    WHERE dc.is_active = true\n    AND (card_type_filter IS NULL OR dc.card_type = card_type_filter)\n    ORDER BY dc.\"position\", dc.created_at;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_demo_rewards",
          "args": "",
          "returns": "TABLE(id uuid, label text, imagepath text, \"position\" integer)",
          "language": "sql",
          "kind": "function",
          "volatility": "stable",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.get_demo_rewards()\n RETURNS TABLE(id uuid, label text, imagepath text, \"position\" integer)\n LANGUAGE sql\n STABLE SECURITY DEFINER\n SET search_path TO 'public', 'pg_temp'\nAS $function$\n    SELECT \n        dc.id,\n        dc.label,\n        dc.imagepath,\n        dc.\"position\"\n    FROM public.demo_cards dc\n    WHERE dc.is_active = true\n    AND dc.card_type = 'reward'\n    ORDER BY dc.\"position\", dc.created_at;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_demo_tasks",
          "args": "",
          "returns": "TABLE(id uuid, label text, imagepath text, \"position\" integer)",
          "language": "sql",
          "kind": "function",
          "volatility": "stable",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.get_demo_tasks()\n RETURNS TABLE(id uuid, label text, imagepath text, \"position\" integer)\n LANGUAGE sql\n STABLE SECURITY DEFINER\n SET search_path TO 'public', 'pg_temp'\nAS $function$\n    SELECT \n        dc.id,\n        dc.label,\n        dc.imagepath,\n        dc.\"position\"\n    FROM public.demo_cards dc\n    WHERE dc.is_active = true\n    AND dc.card_type = 'task'\n    ORDER BY dc.\"position\", dc.created_at;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_migration_report",
          "args": "",
          "returns": "TABLE(total_users integer, active_users integer, suspended_users integer, pending_users integer, deletion_scheduled_users integer, admin_users integer, abonne_users integer, free_users integer, visitor_users integer, staff_users integer)",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_migration_report()\n RETURNS TABLE(total_users integer, active_users integer, suspended_users integer, pending_users integer, deletion_scheduled_users integer, admin_users integer, abonne_users integer, free_users integer, visitor_users integer, staff_users integer)\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nBEGIN\n  IF NOT public.is_admin() THEN\n    RAISE EXCEPTION 'Permission denied: admin only' USING ERRCODE='42501';\n  END IF;\n\n  RETURN QUERY\n  SELECT\n    (SELECT COUNT(*) FROM public.profiles) as total_users,\n    (SELECT COUNT(*) FROM public.profiles WHERE account_status = 'active') as active_users,\n    (SELECT COUNT(*) FROM public.profiles WHERE account_status = 'suspended') as suspended_users,\n    (SELECT COUNT(*) FROM public.profiles WHERE account_status = 'pending_verification') as pending_users,\n    (SELECT COUNT(*) FROM public.profiles WHERE account_status = 'deletion_scheduled') as deletion_scheduled_users,\n    (SELECT COUNT(*) FROM public.user_roles ur JOIN public.roles r ON r.id = ur.role_id WHERE r.name = 'admin' AND ur.is_active = true) as admin_users,\n    (SELECT COUNT(*) FROM public.user_roles ur JOIN public.roles r ON r.id = ur.role_id WHERE r.name = 'abonne' AND ur.is_active = true) as abonne_users,\n    (SELECT COUNT(*) FROM public.user_roles ur JOIN public.roles r ON r.id = ur.role_id WHERE r.name = 'free' AND ur.is_active = true) as free_users,\n    (SELECT COUNT(*) FROM public.user_roles ur JOIN public.roles r ON r.id = ur.role_id WHERE r.name = 'visitor' AND ur.is_active = true) as visitor_users,\n    (SELECT COUNT(*) FROM public.user_roles ur JOIN public.roles r ON r.id = ur.role_id WHERE r.name = 'staff' AND ur.is_active = true) as staff_users;\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_my_permissions",
          "args": "",
          "returns": "TABLE(feature_name text, can_access boolean)",
          "language": "sql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_my_permissions()\n RETURNS TABLE(feature_name text, can_access boolean)\n LANGUAGE sql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$ select * from public._compute_my_permissions(); $function$\n"
        },
        {
          "schema": "public",
          "name": "get_my_primary_role",
          "args": "",
          "returns": "TABLE(role_id uuid, role_name text, priority integer)",
          "language": "sql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_my_primary_role()\n RETURNS TABLE(role_id uuid, role_name text, priority integer)\n LANGUAGE sql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$ select * from public._compute_my_primary_role(); $function$\n"
        },
        {
          "schema": "public",
          "name": "get_usage",
          "args": "p_user_id uuid",
          "returns": "jsonb",
          "language": "sql",
          "kind": "function",
          "volatility": "stable",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_usage(p_user_id uuid)\n RETURNS jsonb\n LANGUAGE sql\n STABLE SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\n      select jsonb_build_object('user_id', p_user_id);\n    $function$\n"
        },
        {
          "schema": "public",
          "name": "get_usage_fast",
          "args": "p_user_id uuid",
          "returns": "jsonb",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_usage_fast(p_user_id uuid)\n RETURNS jsonb\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nDECLARE\n  v_role record;\n  v_quotas jsonb := '[]'::jsonb;\n  v_cnt record;\n  v_subscription record;\nBEGIN\n  PERFORM public.assert_self_or_admin(p_user_id);\n\n  SELECT r.id, r.name, r.priority\n    INTO v_role\n  FROM public.user_roles ur\n  JOIN public.roles r ON r.id = ur.role_id\n  WHERE ur.user_id = p_user_id AND ur.is_active = true\n  ORDER BY r.priority DESC\n  LIMIT 1;\n\n  IF v_role.id IS NULL THEN\n    SELECT *\n      INTO v_subscription\n    FROM public.abonnements\n    WHERE user_id = p_user_id\n      AND status IN ('active','trialing')\n    ORDER BY created_at DESC\n    LIMIT 1;\n\n    IF v_subscription.id IS NOT NULL THEN\n      SELECT id, name, priority INTO v_role FROM public.roles WHERE name = 'abonne' LIMIT 1;\n    ELSE\n      SELECT id, name, priority INTO v_role FROM public.roles WHERE name = 'visitor' LIMIT 1;\n    END IF;\n  END IF;\n\n  IF v_role.id IS NOT NULL THEN\n    SELECT COALESCE(jsonb_agg(jsonb_build_object(\n             'quota_type', rq.quota_type,\n             'quota_limit', rq.quota_limit,\n             'quota_period', rq.quota_period\n           )), '[]'::jsonb)\n      INTO v_quotas\n    FROM public.role_quotas rq\n    WHERE rq.role_id = v_role.id;\n  END IF;\n\n  SELECT tasks, rewards, categories\n    INTO v_cnt\n  FROM public.user_usage_counters\n  WHERE user_id = p_user_id;\n\n  RETURN jsonb_build_object(\n    'role', jsonb_build_object(\n      'id', v_role.id,\n      'name', COALESCE(v_role.name, 'visitor'),\n      'priority', COALESCE(v_role.priority, 0)\n    ),\n    'quotas', v_quotas,\n    'usage', jsonb_build_object(\n      'tasks', COALESCE(v_cnt.tasks, 0),\n      'rewards', COALESCE(v_cnt.rewards, 0),\n      'categories', COALESCE(v_cnt.categories, 0)\n    )\n  );\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_user_assets_stats",
          "args": "p_user_id uuid",
          "returns": "jsonb",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_user_assets_stats(p_user_id uuid)\n RETURNS jsonb\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nDECLARE\n  v_stats jsonb;\nBEGIN\n  PERFORM public.assert_self_or_admin(p_user_id);\n\n  SELECT jsonb_build_object(\n    'total_images', COUNT(*),\n    'total_size', COALESCE(SUM(file_size), 0),\n    'task_images', COUNT(*) FILTER (WHERE asset_type = 'task_image'),\n    'reward_images', COUNT(*) FILTER (WHERE asset_type = 'reward_image'),\n    'task_images_size', COALESCE(SUM(file_size) FILTER (WHERE asset_type = 'task_image'), 0),\n    'reward_images_size', COALESCE(SUM(file_size) FILTER (WHERE asset_type = 'reward_image'), 0)\n  ) INTO v_stats\n  FROM public.user_assets\n  WHERE user_id = p_user_id;\n\n  RETURN COALESCE(v_stats,\n    '{\"total_images\":0,\"total_size\":0,\"task_images\":0,\"reward_images\":0,\"task_images_size\":0,\"reward_images_size\":0}'::jsonb\n  );\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_user_emails",
          "args": "",
          "returns": "TABLE(user_id uuid, email text)",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_user_emails()\n RETURNS TABLE(user_id uuid, email text)\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nBEGIN\n  IF NOT public.is_admin() THEN\n    RAISE EXCEPTION 'Permission denied: admin only' USING ERRCODE='42501';\n  END IF;\n\n  RETURN QUERY\n  SELECT au.id AS user_id, au.email\n  FROM auth.users au\n  INNER JOIN public.profiles p ON p.id = au.id\n  WHERE au.email IS NOT NULL\n  ORDER BY p.created_at DESC;\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_user_last_logins",
          "args": "",
          "returns": "TABLE(user_id uuid, last_login timestamp with time zone, is_online boolean)",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_user_last_logins()\n RETURNS TABLE(user_id uuid, last_login timestamp with time zone, is_online boolean)\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nBEGIN\n  IF NOT public.is_admin() THEN\n    RAISE EXCEPTION 'Permission denied: User is not an administrator.';\n  END IF;\n\n  RETURN QUERY\n  SELECT\n    u.id AS user_id,\n    u.last_sign_in_at AS last_login,\n    CASE WHEN u.last_sign_in_at > (NOW() - INTERVAL '15 minutes') THEN true ELSE false END AS is_online\n  FROM auth.users u\n  WHERE u.email_confirmed_at IS NOT NULL;\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_user_month_bounds_utc",
          "args": "p_user_id uuid",
          "returns": "TABLE(start_utc timestamp with time zone, end_utc timestamp with time zone)",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_user_month_bounds_utc(p_user_id uuid)\n RETURNS TABLE(start_utc timestamp with time zone, end_utc timestamp with time zone)\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nDECLARE\n  v_tz text;\n  v_now_local timestamp;\n  v_month_start_local timestamp;\n  v_month_end_local   timestamp;\nBEGIN\n  -- lecture innocente mais on garde la mme smantique (self/admin)\n  IF p_user_id IS NOT NULL THEN\n    PERFORM public.assert_self_or_admin(p_user_id);\n  END IF;\n\n  IF p_user_id IS NULL THEN\n    v_tz := 'Europe/Paris';\n  ELSE\n    SELECT COALESCE(up.timezone, 'Europe/Paris') INTO v_tz\n    FROM user_prefs up\n    WHERE up.user_id = p_user_id;\n    IF v_tz IS NULL THEN v_tz := 'Europe/Paris'; END IF;\n  END IF;\n\n  v_now_local := now() AT TIME ZONE v_tz;\n  v_month_start_local := date_trunc('month', v_now_local);\n  v_month_end_local   := v_month_start_local + interval '1 month';\n\n  start_utc := v_month_start_local AT TIME ZONE v_tz;\n  end_utc   := v_month_end_local   AT TIME ZONE v_tz;\n  RETURN NEXT;\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_user_permissions",
          "args": "user_uuid uuid",
          "returns": "TABLE(feature_name text, can_access boolean)",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_user_permissions(user_uuid uuid)\n RETURNS TABLE(feature_name text, can_access boolean)\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nBEGIN\n  PERFORM public.assert_self_or_admin(user_uuid);\n\n  RETURN QUERY\n  SELECT\n    f.name AS feature_name,\n    BOOL_OR(COALESCE(rp.can_access, false)) AS can_access\n  FROM features f\n  LEFT JOIN role_permissions rp ON f.id = rp.feature_id\n  LEFT JOIN user_roles ur ON rp.role_id = ur.role_id\n  WHERE ur.user_id = user_uuid\n    AND ur.is_active = true\n    AND (ur.expires_at IS NULL OR ur.expires_at > NOW())\n    AND f.is_active = true\n  GROUP BY f.name\n  ORDER BY f.name;\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_user_primary_role",
          "args": "p_user_id uuid",
          "returns": "TABLE(role_id uuid, role_name text, priority integer)",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_user_primary_role(p_user_id uuid)\n RETURNS TABLE(role_id uuid, role_name text, priority integer)\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nBEGIN\n  PERFORM public.assert_self_or_admin(p_user_id);\n\n  RETURN QUERY\n  SELECT r.id, r.name, r.priority\n  FROM public.user_roles ur\n  JOIN public.roles r ON r.id = ur.role_id\n  WHERE ur.user_id = p_user_id AND ur.is_active = true\n  ORDER BY r.priority DESC\n  LIMIT 1;\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_user_quota_info",
          "args": "user_uuid uuid, quota_type text, quota_period text",
          "returns": "TABLE(quota_limit integer, current_usage integer, remaining integer, is_limited boolean)",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_user_quota_info(user_uuid uuid, quota_type text, quota_period text DEFAULT 'monthly'::text)\n RETURNS TABLE(quota_limit integer, current_usage integer, remaining integer, is_limited boolean)\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nDECLARE\n  user_role text;\n  v_limit integer;\n  v_usage integer;\n  v_start timestamptz;\n  v_end   timestamptz;\nBEGIN\n  PERFORM public.assert_self_or_admin(user_uuid);\n\n  SELECT r.name INTO user_role\n  FROM public.user_roles ur\n  JOIN public.roles r ON r.id = ur.role_id\n  WHERE ur.user_id = user_uuid AND ur.is_active = true\n  LIMIT 1;\n\n  IF user_role IS NULL OR user_role = 'admin' THEN\n    RETURN QUERY SELECT NULL::integer, 0::integer, NULL::integer, false;\n    RETURN;\n  END IF;\n\n  SELECT rq.quota_limit INTO v_limit\n  FROM public.role_quotas rq\n  JOIN public.roles r ON r.id = rq.role_id\n  WHERE r.name = user_role\n    AND rq.quota_type = quota_type\n    AND rq.quota_period = quota_period;\n\n  IF v_limit IS NULL THEN\n    RETURN QUERY SELECT NULL::integer, 0::integer, NULL::integer, false;\n    RETURN;\n  END IF;\n\n  v_usage := 0;\n\n  IF quota_period = 'monthly' THEN\n    SELECT start_utc, end_utc INTO v_start, v_end FROM public.get_user_month_bounds_utc(user_uuid);\n\n    IF quota_type = 'monthly_tasks' THEN\n      SELECT COUNT(*) INTO v_usage\n      FROM public.taches\n      WHERE user_id = user_uuid AND created_at >= v_start AND created_at < v_end;\n\n    ELSIF quota_type = 'monthly_rewards' THEN\n      SELECT COUNT(*) INTO v_usage\n      FROM public.recompenses\n      WHERE user_id = user_uuid AND created_at >= v_start AND created_at < v_end;\n    END IF;\n\n  ELSE\n    IF quota_type = 'max_tasks' THEN\n      SELECT COUNT(*) INTO v_usage FROM public.taches WHERE user_id = user_uuid;\n    ELSIF quota_type = 'max_rewards' THEN\n      SELECT COUNT(*) INTO v_usage FROM public.recompenses WHERE user_id = user_uuid;\n    END IF;\n  END IF;\n\n  RETURN QUERY SELECT\n    v_limit,\n    v_usage,\n    GREATEST(0, v_limit - v_usage),\n    true;\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "get_user_roles",
          "args": "p_user_id uuid",
          "returns": "TABLE(role_id uuid, role_name text, priority integer, is_active boolean)",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": true,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.get_user_roles(p_user_id uuid)\n RETURNS TABLE(role_id uuid, role_name text, priority integer, is_active boolean)\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nBEGIN\n  PERFORM public.assert_self_or_admin(p_user_id);\n\n  RETURN QUERY\n  SELECT r.id, r.name, r.priority, ur.is_active\n  FROM public.user_roles ur\n  JOIN public.roles r ON r.id = ur.role_id\n  WHERE ur.user_id = p_user_id AND ur.is_active = true\n  ORDER BY r.priority DESC;\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "handle_new_user",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.handle_new_user()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nDECLARE\n  free_role_id uuid;\n  pseudo_base text;\nBEGIN\n  pseudo_base := split_part(NEW.email, '@', 1);\n\n  INSERT INTO public.profiles (id, pseudo)\n  VALUES (NEW.id, public.generate_unique_pseudo(pseudo_base))\n  ON CONFLICT (id) DO NOTHING;\n\n  SELECT id INTO free_role_id FROM public.roles WHERE name = 'free' AND is_active = true;\n\n  IF free_role_id IS NOT NULL THEN\n    INSERT INTO public.user_roles (user_id, role_id, is_active, assigned_by, assigned_at)\n    VALUES (NEW.id, free_role_id, true, NEW.id, now())\n    ON CONFLICT (user_id, role_id)\n    DO UPDATE SET is_active = true, assigned_by = NEW.id, assigned_at = now(), updated_at = now();\n  END IF;\n\n  RETURN NEW;\nEND;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "handle_subscription_role_change",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.handle_subscription_role_change()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\ndeclare\n  v_role_free   uuid;\n  v_role_abonne uuid;\n  v_should_be_abonne boolean;\nbegin\n  select id into v_role_abonne from public.roles where name='abonne' and is_active = true;\n  select id into v_role_free   from public.roles where name='free'   and is_active = true;\n\n  -- Abonn si statut Stripe valide ET priode non expire (si prsente)\n  v_should_be_abonne := (new.status in ('trialing','active','past_due','paused'))\n                        and (new.current_period_end is null or new.current_period_end >= now());\n\n  -- Dsactiver tous les rles actifs (respecte uq_user_roles_one_active)\n  update public.user_roles\n     set is_active = false, updated_at = now()\n   where user_id = new.user_id and is_active = true;\n\n  if v_should_be_abonne and v_role_abonne is not null then\n    -- Activer 'abonne'\n    insert into public.user_roles (user_id, role_id, is_active, assigned_at)\n    values (new.user_id, v_role_abonne, true, now())\n    on conflict (user_id, role_id) do update\n      set is_active = true, updated_at = now();\n  else\n      -- Variante B : ractiver 'free' (toujours au minimum free)\n    if v_role_free is not null then\n      insert into public.user_roles (user_id, role_id, is_active, assigned_at)\n      values (new.user_id, v_role_free, true, now())\n      on conflict (user_id, role_id) do update\n        set is_active = true, updated_at = now();\n    end if;\n  end if;\n\n  return new;\nend\n$function$\n"
        },
        {
          "schema": "public",
          "name": "is_admin",
          "args": "",
          "returns": "boolean",
          "language": "sql",
          "kind": "function",
          "volatility": "stable",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.is_admin()\n RETURNS boolean\n LANGUAGE sql\n STABLE SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\n  select exists (\n    select 1 from public.user_roles ur\n    join public.roles r on r.id = ur.role_id\n    where ur.user_id = auth.uid() and ur.is_active and r.name='admin'\n  ) or exists (select 1 from public.profiles p where p.id=auth.uid() and p.is_admin);\n$function$\n"
        },
        {
          "schema": "public",
          "name": "is_subscriber",
          "args": "p_user uuid",
          "returns": "boolean",
          "language": "sql",
          "kind": "function",
          "volatility": "stable",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.is_subscriber(p_user uuid DEFAULT auth.uid())\n RETURNS boolean\n LANGUAGE sql\n STABLE SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\n  select exists (\n    select 1 from public.abonnements a\n    where a.user_id = p_user\n      and a.status in ('trialing','active','past_due','paused')\n  );\n$function$\n"
        },
        {
          "schema": "public",
          "name": "is_system_role",
          "args": "role_name text",
          "returns": "boolean",
          "language": "sql",
          "kind": "function",
          "volatility": "stable",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.is_system_role(role_name text)\n RETURNS boolean\n LANGUAGE sql\n STABLE\n SET search_path TO 'public', 'pg_temp'\nAS $function$\n  SELECT role_name = ANY (ARRAY['admin', 'visitor', 'free', 'abonne', 'staff'])\n$function$\n"
        },
        {
          "schema": "public",
          "name": "log_card_creation",
          "args": "_user uuid, _entity text, _id uuid",
          "returns": "void",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.log_card_creation(_user uuid, _entity text, _id uuid)\n RETURNS void\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nbegin\n  if to_regclass('public.card_creation_logs') is not null then\n    insert into public.card_creation_logs(user_id, entity, entity_id, created_at)\n    values (_user, _entity, _id, now());\n  elsif to_regclass('public.image_creation_logs') is not null then\n    -- fallback si tu avais dj une table \"image_creation_logs\"\n    insert into public.image_creation_logs(user_id, kind, card_id, created_at)\n    values (_user, _entity, _id, now());\n  else\n    -- rien d'install => no-op (ou RAISE NOTICE)\n    raise notice 'Aucune table de logs trouve.';\n  end if;\nend\n$function$\n"
        },
        {
          "schema": "public",
          "name": "prevent_system_role_delete",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.prevent_system_role_delete()\n RETURNS trigger\n LANGUAGE plpgsql\n SET search_path TO 'public', 'pg_temp'\nAS $function$\nBEGIN\n  IF public.is_system_role(OLD.name) THEN\n    RAISE EXCEPTION 'Deleting a system role (%) is forbidden', OLD.name;\n  END IF;\n  RETURN OLD;\nEND;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "prevent_system_role_deletion",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.prevent_system_role_deletion()\n RETURNS trigger\n LANGUAGE plpgsql\n SET search_path TO 'public', 'pg_temp'\nAS $function$\nBEGIN\n  IF OLD.is_active = false AND public.is_system_role(OLD.name) THEN\n    -- Permettre la dsactivation des rles systme\n    RETURN NEW;\n  END IF;\n  \n  -- Pour les autres cas, laisser passer\n  RETURN NEW;\nEND;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "purge_old_consentements",
          "args": "retention_months integer",
          "returns": "void",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.purge_old_consentements(retention_months integer DEFAULT 25)\n RETURNS void\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nBEGIN\n  IF NOT public.is_admin() THEN\n    RAISE EXCEPTION 'Permission denied: admin only' USING ERRCODE='42501';\n  END IF;\n\n  DELETE FROM public.consentements\n  WHERE ts < (now() - make_interval(months => retention_months));\nEND\n$function$\n"
        },
        {
          "schema": "public",
          "name": "recompenses_counter_del",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_catalog"],
          "search_path": "public, pg_catalog",
          "definition": "CREATE OR REPLACE FUNCTION public.recompenses_counter_del()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public', 'pg_catalog'\nAS $function$\nbegin\n  perform public.bump_usage_counter(coalesce(old.user_id, auth.uid()), 'rewards', -1);\n  return old;\nend;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "recompenses_counter_ins",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_catalog"],
          "search_path": "public, pg_catalog",
          "definition": "CREATE OR REPLACE FUNCTION public.recompenses_counter_ins()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public', 'pg_catalog'\nAS $function$\nbegin\n  perform public.bump_usage_counter(coalesce(new.user_id, auth.uid()), 'rewards', 1);\n  return new;\nend;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "rewards_counter_del",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.rewards_counter_del()\n RETURNS trigger\n LANGUAGE plpgsql\n SET search_path TO 'public', 'pg_temp'\nAS $function$\nbegin\n  perform public.bump_usage_counter(old.user_id, 'rewards', -1);\n  return old;\nend $function$\n"
        },
        {
          "schema": "public",
          "name": "rewards_counter_ins",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.rewards_counter_ins()\n RETURNS trigger\n LANGUAGE plpgsql\n SET search_path TO 'public', 'pg_temp'\nAS $function$\nbegin\n  perform public.bump_usage_counter(new.user_id, 'rewards', 1);\n  return new;\nend $function$\n"
        },
        {
          "schema": "public",
          "name": "set_updated_at",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=pg_catalog, public"],
          "search_path": "pg_catalog, public",
          "definition": "CREATE OR REPLACE FUNCTION public.set_updated_at()\n RETURNS trigger\n LANGUAGE plpgsql\n SET search_path TO 'pg_catalog', 'public'\nAS $function$\nbegin\n  new.updated_at := now();\n  return new;\nend$function$\n"
        },
        {
          "schema": "public",
          "name": "taches_counter_del",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_catalog"],
          "search_path": "public, pg_catalog",
          "definition": "CREATE OR REPLACE FUNCTION public.taches_counter_del()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public', 'pg_catalog'\nAS $function$\nbegin\n  perform public.bump_usage_counter(old.user_id, 'tasks', -1);\n  return old;\nend $function$\n"
        },
        {
          "schema": "public",
          "name": "taches_counter_ins",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_catalog"],
          "search_path": "public, pg_catalog",
          "definition": "CREATE OR REPLACE FUNCTION public.taches_counter_ins()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public', 'pg_catalog'\nAS $function$\nbegin\n  perform public.bump_usage_counter(coalesce(new.user_id, auth.uid()), 'tasks', 1);\n  return new;\nend;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "tg_audit_permission_change",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.tg_audit_permission_change()\n RETURNS trigger\n LANGUAGE plpgsql\n SET search_path TO 'public'\nAS $function$\ndeclare\n  v_old jsonb;\n  v_new jsonb;\n  v_rec_id uuid;\nbegin\n  if tg_op = 'INSERT' then\n    v_new := to_jsonb(new);\n    v_old := null;\n    v_rec_id := coalesce(new.id, gen_random_uuid());\n    insert into public.permission_changes\n      (change_type, table_name, record_id, old_values, new_values, changed_by, created_at, changed_at)\n    values\n      ('INSERT', tg_table_name, v_rec_id, v_old, v_new, auth.uid(), now(), now());\n    return new;\n\n  elsif tg_op = 'UPDATE' then\n    v_new := to_jsonb(new);\n    v_old := to_jsonb(old);\n    v_rec_id := coalesce(new.id, old.id, gen_random_uuid());\n    insert into public.permission_changes\n      (change_type, table_name, record_id, old_values, new_values, changed_by, created_at, changed_at)\n    values\n      ('UPDATE', tg_table_name, v_rec_id, v_old, v_new, auth.uid(), now(), now());\n    return new;\n\n  elsif tg_op = 'DELETE' then\n    v_new := null;\n    v_old := to_jsonb(old);\n    v_rec_id := coalesce(old.id, gen_random_uuid());\n    insert into public.permission_changes\n      (change_type, table_name, record_id, old_values, new_values, changed_by, created_at, changed_at)\n    values\n      ('DELETE', tg_table_name, v_rec_id, v_old, v_new, auth.uid(), now(), now());\n    return old;\n  end if;\n\n  return null;\nend\n$function$\n"
        },
        {
          "schema": "public",
          "name": "tg_categories_fill_value",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_catalog"],
          "search_path": "public, pg_catalog",
          "definition": "CREATE OR REPLACE FUNCTION public.tg_categories_fill_value()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public', 'pg_catalog'\nAS $function$\ndeclare\n  v text;\nbegin\n  if new.value is null or btrim(new.value) = '' then\n    -- 1) passe en minuscule\n    v := lower(coalesce(new.label, ''));\n    -- 2) remplace tout ce qui n'est pas [a-z0-9] par \"_\"\n    v := regexp_replace(v, '[^a-z0-9]+', '_', 'g');\n    -- 3) retire \"_\" au dbut/fin\n    v := regexp_replace(v, '^_+|_+$', '', 'g');\n    if v = '' then\n      v := 'cat_' || substring(md5(random()::text) for 8);\n    end if;\n    new.value := v;\n  end if;\n  return new;\nend;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "tg_categories_set_user_id",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_catalog"],
          "search_path": "public, pg_catalog",
          "definition": "CREATE OR REPLACE FUNCTION public.tg_categories_set_user_id()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public', 'pg_catalog'\nAS $function$\nbegin\n  if new.user_id is null then\n    new.user_id := auth.uid();\n  end if;\n  return new;\nend;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "tg_on_auth_user_created",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.tg_on_auth_user_created()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\ndeclare\n  v_role_free uuid;\nbegin\n  insert into public.profiles (id) values (new.id)\n  on conflict (id) do nothing;\n\n  select id into v_role_free from public.roles where name='free' and is_active = true;\n\n  if v_role_free is not null then\n    insert into public.user_roles (user_id, role_id, is_active, assigned_at)\n    values (new.id, v_role_free, true, now())\n    on conflict (user_id, role_id) do update\n      set is_active = true, updated_at = now();\n  end if;\n\n  return new;\nend\n$function$\n"
        },
        {
          "schema": "public",
          "name": "tg_parametres_lock_id",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.tg_parametres_lock_id()\n RETURNS trigger\n LANGUAGE plpgsql\n SET search_path TO 'public', 'pg_temp'\nAS $function$\nbegin\n  if new.id is distinct from old.id then\n    raise exception 'Column \"id\" is immutable on table \"parametres\"';\n  end if;\n  return new;\nend$function$\n"
        },
        {
          "schema": "public",
          "name": "tg_permission_changes_validate_json",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=pg_catalog, public"],
          "search_path": "pg_catalog, public",
          "definition": "CREATE OR REPLACE FUNCTION public.tg_permission_changes_validate_json()\n RETURNS trigger\n LANGUAGE plpgsql\n SET search_path TO 'pg_catalog', 'public'\nAS $function$\nbegin\n  if new.old_values is not null and jsonb_typeof(new.old_values) <> 'object' then\n    raise exception 'old_values must be a JSON object';\n  end if;\n  if new.new_values is not null and jsonb_typeof(new.new_values) <> 'object' then\n    raise exception 'new_values must be a JSON object';\n  end if;\n  if new.change_type not in ('INSERT','UPDATE','DELETE') then\n    raise exception 'Invalid change_type: %', new.change_type;\n  end if;\n  return new;\nend\n$function$\n"
        },
        {
          "schema": "public",
          "name": "tg_recompenses_normalize",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=pg_catalog, public"],
          "search_path": "pg_catalog, public",
          "definition": "CREATE OR REPLACE FUNCTION public.tg_recompenses_normalize()\n RETURNS trigger\n LANGUAGE plpgsql\n SET search_path TO 'pg_catalog', 'public'\nAS $function$\nbegin\n  if new.label is not null then\n    new.label := nullif(btrim(new.label), '');\n  end if;\n  if new.description is not null then\n    new.description := nullif(btrim(new.description), '');\n  end if;\n  return new;\nend$function$\n"
        },
        {
          "schema": "public",
          "name": "tg_recompenses_set_user_id",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_catalog"],
          "search_path": "public, pg_catalog",
          "definition": "CREATE OR REPLACE FUNCTION public.tg_recompenses_set_user_id()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public', 'pg_catalog'\nAS $function$\nbegin\n  if new.user_id is null then\n    new.user_id := auth.uid();\n  end if;\n  return new;\nend;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "tg_taches_log_neutral",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.tg_taches_log_neutral()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public'\nAS $function$\nbegin\n  -- on log uniquement  la cration de carte (INSERT)\n  perform public.log_card_creation(new.user_id, 'tache', new.id);\n  return new;\nend\n$function$\n"
        },
        {
          "schema": "public",
          "name": "tg_taches_normalize_categorie",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.tg_taches_normalize_categorie()\n RETURNS trigger\n LANGUAGE plpgsql\n SET search_path TO 'public', 'pg_temp'\nAS $function$\nBEGIN\n  IF NEW.categorie IS NOT NULL THEN\n    NEW.categorie := regexp_replace(lower(trim(NEW.categorie)), '\\s+', '-', 'g');\n  END IF;\n  RETURN NEW;\nEND;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "tg_taches_set_user_id",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": true,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_catalog"],
          "search_path": "public, pg_catalog",
          "definition": "CREATE OR REPLACE FUNCTION public.tg_taches_set_user_id()\n RETURNS trigger\n LANGUAGE plpgsql\n SECURITY DEFINER\n SET search_path TO 'public', 'pg_catalog'\nAS $function$\nbegin\n  if new.user_id is null then\n    new.user_id := auth.uid();\n  end if;\n  return new;\nend;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "tg_taches_sync_categorie",
          "args": "",
          "returns": "trigger",
          "language": "plpgsql",
          "kind": "function",
          "volatility": "volatile",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public, pg_temp"],
          "search_path": "public, pg_temp",
          "definition": "CREATE OR REPLACE FUNCTION public.tg_taches_sync_categorie()\n RETURNS trigger\n LANGUAGE plpgsql\n SET search_path TO 'public', 'pg_temp'\nAS $function$\nDECLARE\n  v_norm text;\n  v_desired_id uuid;\nBEGIN\n  -- 0) Normalisation dfensive au cas o l'autre trigger n'ait pas tourn\n  IF NEW.categorie IS NOT NULL THEN\n    v_norm := regexp_replace(lower(trim(NEW.categorie)), '\\s+', '-', 'g');\n    NEW.categorie := v_norm;\n  END IF;\n\n  -- 1) Cas INSERT : si categorie_id fourni par l'appelant, on ne touche pas (compat)\n  IF TG_OP = 'INSERT' THEN\n    IF NEW.categorie_id IS NOT NULL THEN\n      RETURN NEW;\n    END IF;\n  END IF;\n\n  -- 2) Dterminer la categorie dsire (proprio d'abord, sinon globale)\n  IF NEW.categorie IS NOT NULL THEN\n    -- Propritaire\n    SELECT id INTO v_desired_id\n    FROM public.categories\n    WHERE value = NEW.categorie\n      AND user_id = NEW.user_id\n    LIMIT 1;\n\n    -- Globale en fallback\n    IF v_desired_id IS NULL THEN\n      SELECT id INTO v_desired_id\n      FROM public.categories\n      WHERE value = NEW.categorie\n        AND user_id IS NULL\n      LIMIT 1;\n    END IF;\n  END IF;\n\n  -- 3) En UPDATE, mme si categorie_id est dj renseign,\n  --    on prfre la propritaire si elle existe maintenant.\n  --    En INSERT, on remplit si absent.\n  IF v_desired_id IS NOT NULL THEN\n    IF NEW.categorie_id IS DISTINCT FROM v_desired_id THEN\n      NEW.categorie_id := v_desired_id;\n    END IF;\n  END IF;\n\n  RETURN NEW;\nEND;\n$function$\n"
        },
        {
          "schema": "public",
          "name": "user_can_upload_avatar",
          "args": "uid uuid",
          "returns": "boolean",
          "language": "sql",
          "kind": "function",
          "volatility": "stable",
          "security_definer": false,
          "parallel": "u",
          "returns_set": false,
          "owner": "postgres",
          "settings": ["search_path=public"],
          "search_path": "public",
          "definition": "CREATE OR REPLACE FUNCTION public.user_can_upload_avatar(uid uuid)\n RETURNS boolean\n LANGUAGE sql\n STABLE\n SET search_path TO 'public'\nAS $function$\n  select count(*) <= 1\n  from storage.objects\n  where bucket_id = 'avatars'\n    and name like uid::text || '/%'\n$function$\n"
        }
      ],
      "table_reports": [
        {
          "table": {
            "schema": "public",
            "name": "abonnements"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "user_id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "stripe_subscription_id",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "status",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "current_period_start",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "current_period_end",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "raw_data",
              "data_type": "jsonb",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "last_event_id",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "stripe_customer",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "plan",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "price_id",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "start_date",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "end_date",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "cancel_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "cancel_at_period_end",
              "data_type": "boolean",
              "is_nullable": "NO",
              "default": "false"
            },
            {
              "column_name": "latest_invoice",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "abonnements_select_unified",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (( SELECT auth.uid() AS uid) = user_id))",
              "with_check": null
            }
          ],
          "indexes": [
            {
              "name": "abonnements_active_idx",
              "def": "CREATE INDEX abonnements_active_idx ON public.abonnements USING btree (user_id) WHERE (status = ANY (ARRAY['trialing'::text, 'active'::text, 'past_due'::text, 'paused'::text]))"
            },
            {
              "name": "abonnements_active_user_created_desc_idx",
              "def": "CREATE INDEX abonnements_active_user_created_desc_idx ON public.abonnements USING btree (user_id, created_at DESC) WHERE (status = ANY (ARRAY['trialing'::text, 'active'::text, 'past_due'::text, 'paused'::text]))"
            },
            {
              "name": "abonnements_pkey",
              "def": "CREATE UNIQUE INDEX abonnements_pkey ON public.abonnements USING btree (id)"
            },
            {
              "name": "abonnements_status_idx",
              "def": "CREATE INDEX abonnements_status_idx ON public.abonnements USING btree (status)"
            },
            {
              "name": "abonnements_stripe_subscription_id_idx",
              "def": "CREATE INDEX abonnements_stripe_subscription_id_idx ON public.abonnements USING btree (stripe_subscription_id)"
            },
            {
              "name": "abonnements_stripe_subscription_id_key",
              "def": "CREATE UNIQUE INDEX abonnements_stripe_subscription_id_key ON public.abonnements USING btree (stripe_subscription_id)"
            },
            {
              "name": "abonnements_unique_active_per_user",
              "def": "CREATE UNIQUE INDEX abonnements_unique_active_per_user ON public.abonnements USING btree (user_id) WHERE (status = ANY (ARRAY['trialing'::text, 'active'::text, 'past_due'::text, 'paused'::text]))"
            },
            {
              "name": "abonnements_user_created_desc_idx",
              "def": "CREATE INDEX abonnements_user_created_desc_idx ON public.abonnements USING btree (user_id, created_at DESC)"
            },
            {
              "name": "idx_abonnements_stripe_customer",
              "def": "CREATE INDEX idx_abonnements_stripe_customer ON public.abonnements USING btree (stripe_customer)"
            },
            {
              "name": "idx_abonnements_user_status_created",
              "def": "CREATE INDEX idx_abonnements_user_status_created ON public.abonnements USING btree (user_id, status, created_at DESC)"
            },
            {
              "name": "idx_abos_last_event_id_unique",
              "def": "CREATE UNIQUE INDEX idx_abos_last_event_id_unique ON public.abonnements USING btree (last_event_id) WHERE (last_event_id IS NOT NULL)"
            }
          ],
          "constraints": [
            {
              "name": "abonnements_period_chk",
              "type": "c",
              "definition": "CHECK (((current_period_start IS NULL) OR (current_period_end IS NULL) OR (current_period_end >= current_period_start)))"
            },
            {
              "name": "abonnements_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "abonnements_status_check",
              "type": "c",
              "definition": "CHECK ((status = ANY (ARRAY['trialing'::text, 'active'::text, 'past_due'::text, 'canceled'::text, 'incomplete'::text, 'incomplete_expired'::text, 'unpaid'::text, 'paused'::text])))"
            },
            {
              "name": "abonnements_stripe_subscription_id_key",
              "type": "u",
              "definition": "UNIQUE (stripe_subscription_id)"
            },
            {
              "name": "abonnements_user_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE"
            }
          ],
          "triggers": [
            {
              "name": "on_subscription_change",
              "enabled": "O",
              "definition": "CREATE TRIGGER on_subscription_change AFTER INSERT OR UPDATE ON abonnements FOR EACH ROW EXECUTE FUNCTION handle_subscription_role_change()",
              "function_name": "handle_subscription_role_change"
            },
            {
              "name": "set_abonnements_updated_at",
              "enabled": "O",
              "definition": "CREATE TRIGGER set_abonnements_updated_at BEFORE INSERT OR UPDATE ON abonnements FOR EACH ROW EXECUTE FUNCTION set_updated_at()",
              "function_name": "set_updated_at"
            }
          ],
          "estimates": {
            "row_estimate": 2,
            "size_pretty": "248 kB",
            "size_bytes": 253952
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "account_audit_logs"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "user_id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "action",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "old_status",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "new_status",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "old_role",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "new_role",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "changed_by",
              "data_type": "uuid",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "reason",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "metadata",
              "data_type": "jsonb",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "account_audit_logs_insert_admin",
              "command": "INSERT",
              "roles": ["public"],
              "mode": "PERMISSIVE",
              "using": null,
              "with_check": "is_admin()"
            },
            {
              "policyname": "account_audit_logs_select_unified",
              "command": "SELECT",
              "roles": ["public"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
              "with_check": null
            }
          ],
          "indexes": [
            {
              "name": "account_audit_logs_pkey",
              "def": "CREATE UNIQUE INDEX account_audit_logs_pkey ON public.account_audit_logs USING btree (id)"
            },
            {
              "name": "account_audit_logs_user_created_desc_idx",
              "def": "CREATE INDEX account_audit_logs_user_created_desc_idx ON public.account_audit_logs USING btree (user_id, created_at DESC)"
            },
            {
              "name": "idx_account_audit_logs_action",
              "def": "CREATE INDEX idx_account_audit_logs_action ON public.account_audit_logs USING btree (action)"
            },
            {
              "name": "idx_account_audit_logs_changed_by",
              "def": "CREATE INDEX idx_account_audit_logs_changed_by ON public.account_audit_logs USING btree (changed_by)"
            },
            {
              "name": "idx_account_audit_logs_created_at",
              "def": "CREATE INDEX idx_account_audit_logs_created_at ON public.account_audit_logs USING btree (created_at DESC)"
            },
            {
              "name": "idx_account_audit_logs_user_id",
              "def": "CREATE INDEX idx_account_audit_logs_user_id ON public.account_audit_logs USING btree (user_id)"
            }
          ],
          "constraints": [
            {
              "name": "account_audit_logs_changed_by_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (changed_by) REFERENCES auth.users(id)"
            },
            {
              "name": "account_audit_logs_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "account_audit_logs_user_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE"
            }
          ],
          "triggers": [],
          "estimates": {
            "row_estimate": 2,
            "size_pretty": "112 kB",
            "size_bytes": 114688
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "categories"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "value",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "label",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "user_id",
              "data_type": "uuid",
              "is_nullable": "YES",
              "default": "auth.uid()"
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": true
          },
          "policies": [
            {
              "policyname": "categories_delete_own",
              "command": "DELETE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "((user_id = ( SELECT auth.uid() AS uid)) OR is_admin())",
              "with_check": null
            },
            {
              "policyname": "categories_insert_unified",
              "command": "INSERT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": null,
              "with_check": "(is_admin() OR ((user_id = ( SELECT auth.uid() AS uid)) AND check_user_quota(( SELECT auth.uid() AS uid), 'category'::text, 'total'::text) AND check_user_quota(( SELECT auth.uid() AS uid), 'category'::text, 'monthly'::text)))"
            },
            {
              "policyname": "categories_select_auth",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "((user_id = ( SELECT auth.uid() AS uid)) OR (user_id IS NULL) OR is_admin())",
              "with_check": null
            },
            {
              "policyname": "categories_update_own",
              "command": "UPDATE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "((user_id = ( SELECT auth.uid() AS uid)) OR is_admin())",
              "with_check": "((user_id = ( SELECT auth.uid() AS uid)) OR is_admin())"
            }
          ],
          "indexes": [
            {
              "name": "categories_global_value_unique",
              "def": "CREATE UNIQUE INDEX categories_global_value_unique ON public.categories USING btree (value) WHERE (user_id IS NULL)"
            },
            {
              "name": "categories_pkey",
              "def": "CREATE UNIQUE INDEX categories_pkey ON public.categories USING btree (id)"
            },
            {
              "name": "categories_user_id_idx",
              "def": "CREATE INDEX categories_user_id_idx ON public.categories USING btree (user_id)"
            },
            {
              "name": "categories_user_value_unique",
              "def": "CREATE UNIQUE INDEX categories_user_value_unique ON public.categories USING btree (user_id, value) WHERE (user_id IS NOT NULL)"
            },
            {
              "name": "categories_value_idx",
              "def": "CREATE INDEX categories_value_idx ON public.categories USING btree (value)"
            },
            {
              "name": "idx_categories_user_created",
              "def": "CREATE INDEX idx_categories_user_created ON public.categories USING btree (user_id, created_at)"
            }
          ],
          "constraints": [
            {
              "name": "categories_label_length_check",
              "type": "c",
              "definition": "CHECK ((length(label) <= 64))"
            },
            {
              "name": "categories_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "categories_user_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE"
            },
            {
              "name": "categories_value_length_check",
              "type": "c",
              "definition": "CHECK ((length(value) <= 64))"
            },
            {
              "name": "categories_value_slug_check",
              "type": "c",
              "definition": "CHECK ((value ~ '^[a-z0-9_-]+$'::text))"
            }
          ],
          "triggers": [
            {
              "name": "a00_categories_set_user_id_before",
              "enabled": "O",
              "definition": "CREATE TRIGGER a00_categories_set_user_id_before BEFORE INSERT ON categories FOR EACH ROW EXECUTE FUNCTION tg_categories_set_user_id()",
              "function_name": "tg_categories_set_user_id"
            },
            {
              "name": "a01_categories_fill_value_before",
              "enabled": "O",
              "definition": "CREATE TRIGGER a01_categories_fill_value_before BEFORE INSERT OR UPDATE ON categories FOR EACH ROW EXECUTE FUNCTION tg_categories_fill_value()",
              "function_name": "tg_categories_fill_value"
            },
            {
              "name": "a99_categories_set_updated_at",
              "enabled": "O",
              "definition": "CREATE TRIGGER a99_categories_set_updated_at BEFORE UPDATE ON categories FOR EACH ROW EXECUTE FUNCTION set_updated_at()",
              "function_name": "set_updated_at"
            },
            {
              "name": "trg_categories_ctr_del",
              "enabled": "O",
              "definition": "CREATE TRIGGER trg_categories_ctr_del AFTER DELETE ON categories FOR EACH ROW EXECUTE FUNCTION categories_counter_del()",
              "function_name": "categories_counter_del"
            },
            {
              "name": "trg_categories_ctr_ins",
              "enabled": "O",
              "definition": "CREATE TRIGGER trg_categories_ctr_ins AFTER INSERT ON categories FOR EACH ROW EXECUTE FUNCTION categories_counter_ins()",
              "function_name": "categories_counter_ins"
            }
          ],
          "estimates": {
            "row_estimate": 13,
            "size_pretty": "144 kB",
            "size_bytes": 147456
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "consentements"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "user_id",
              "data_type": "uuid",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "type_consentement",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "donnees",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "ts",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "mode",
              "data_type": "text",
              "is_nullable": "NO",
              "default": "'refuse_all'::text"
            },
            {
              "column_name": "choices",
              "data_type": "jsonb",
              "is_nullable": "NO",
              "default": "'{}'::jsonb"
            },
            {
              "column_name": "action",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "ua",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "locale",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "app_version",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "ip_hash",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "origin",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "ts_client",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "version",
              "data_type": "text",
              "is_nullable": "NO",
              "default": "'1.0.0'::text"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "consentements_delete",
              "command": "DELETE",
              "roles": ["anon", "authenticated"],
              "mode": "PERMISSIVE",
              "using": "false",
              "with_check": null
            },
            {
              "policyname": "consentements_insert_unified",
              "command": "INSERT",
              "roles": ["public"],
              "mode": "PERMISSIVE",
              "using": null,
              "with_check": "((user_id IS NULL) OR (user_id = ( SELECT auth.uid() AS uid)))"
            },
            {
              "policyname": "consentements_select",
              "command": "SELECT",
              "roles": ["public"],
              "mode": "PERMISSIVE",
              "using": "((user_id = ( SELECT auth.uid() AS uid)) OR is_admin())",
              "with_check": null
            },
            {
              "policyname": "consentements_update",
              "command": "UPDATE",
              "roles": ["anon", "authenticated"],
              "mode": "PERMISSIVE",
              "using": "false",
              "with_check": "false"
            }
          ],
          "indexes": [
            {
              "name": "consentements_origin_created_idx",
              "def": "CREATE INDEX consentements_origin_created_idx ON public.consentements USING btree (origin, created_at DESC)"
            },
            {
              "name": "consentements_pkey",
              "def": "CREATE UNIQUE INDEX consentements_pkey ON public.consentements USING btree (id)"
            },
            {
              "name": "consentements_ts_idx",
              "def": "CREATE INDEX consentements_ts_idx ON public.consentements USING btree (ts)"
            },
            {
              "name": "consentements_user_created_idx",
              "def": "CREATE INDEX consentements_user_created_idx ON public.consentements USING btree (user_id, created_at DESC)"
            },
            {
              "name": "idx_consentements_user_ts",
              "def": "CREATE INDEX idx_consentements_user_ts ON public.consentements USING btree (user_id, ts)"
            }
          ],
          "constraints": [
            {
              "name": "consentements_action_check",
              "type": "c",
              "definition": "CHECK (((action IS NULL) OR (action = ANY (ARRAY['first_load'::text, 'update'::text, 'withdraw'::text, 'restore'::text]))))"
            },
            {
              "name": "consentements_choices_is_object",
              "type": "c",
              "definition": "CHECK ((jsonb_typeof(choices) = 'object'::text))"
            },
            {
              "name": "consentements_ip_hash_len",
              "type": "c",
              "definition": "CHECK (((ip_hash IS NULL) OR ((length(ip_hash) >= 32) AND (length(ip_hash) <= 128))))"
            },
            {
              "name": "consentements_mode_check",
              "type": "c",
              "definition": "CHECK ((mode = ANY (ARRAY['accept_all'::text, 'refuse_all'::text, 'custom'::text])))"
            },
            {
              "name": "consentements_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "consentements_user_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE SET NULL"
            }
          ],
          "triggers": [],
          "estimates": {
            "row_estimate": 40,
            "size_pretty": "136 kB",
            "size_bytes": 139264
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "demo_cards"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "card_type",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "label",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "imagepath",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "position",
              "data_type": "integer",
              "is_nullable": "YES",
              "default": "0"
            },
            {
              "column_name": "is_active",
              "data_type": "boolean",
              "is_nullable": "YES",
              "default": "true"
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "demo_cards_select_unified",
              "command": "SELECT",
              "roles": ["public"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (is_active = true))",
              "with_check": null
            }
          ],
          "indexes": [
            {
              "name": "demo_cards_pkey",
              "def": "CREATE UNIQUE INDEX demo_cards_pkey ON public.demo_cards USING btree (id)"
            },
            {
              "name": "idx_demo_cards_active",
              "def": "CREATE INDEX idx_demo_cards_active ON public.demo_cards USING btree (is_active)"
            },
            {
              "name": "idx_demo_cards_position",
              "def": "CREATE INDEX idx_demo_cards_position ON public.demo_cards USING btree (\"position\")"
            },
            {
              "name": "idx_demo_cards_type",
              "def": "CREATE INDEX idx_demo_cards_type ON public.demo_cards USING btree (card_type)"
            }
          ],
          "constraints": [
            {
              "name": "demo_cards_card_type_check",
              "type": "c",
              "definition": "CHECK ((card_type = ANY (ARRAY['task'::text, 'reward'::text])))"
            },
            {
              "name": "demo_cards_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            }
          ],
          "triggers": [],
          "estimates": {
            "row_estimate": 10,
            "size_pretty": "80 kB",
            "size_bytes": 81920
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "features"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "name",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "description",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "is_active",
              "data_type": "boolean",
              "is_nullable": "NO",
              "default": "true"
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "display_name",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "category",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "features_select_unified",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (is_active = true))",
              "with_check": null
            }
          ],
          "indexes": [
            {
              "name": "features_name_key",
              "def": "CREATE UNIQUE INDEX features_name_key ON public.features USING btree (name)"
            },
            {
              "name": "features_pkey",
              "def": "CREATE UNIQUE INDEX features_pkey ON public.features USING btree (id)"
            },
            {
              "name": "idx_features_active_category",
              "def": "CREATE INDEX idx_features_active_category ON public.features USING btree (is_active, category)"
            }
          ],
          "constraints": [
            {
              "name": "features_category_chk",
              "type": "c",
              "definition": "CHECK ((category = ANY (ARRAY['affichage'::text, 'gestion'::text, 'systeme'::text, 'securite'::text])))"
            },
            {
              "name": "features_name_key",
              "type": "u",
              "definition": "UNIQUE (name)"
            },
            {
              "name": "features_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            }
          ],
          "triggers": [
            {
              "name": "audit_features_changes",
              "enabled": "O",
              "definition": "CREATE TRIGGER audit_features_changes AFTER INSERT OR DELETE OR UPDATE ON features FOR EACH ROW EXECUTE FUNCTION tg_audit_permission_change()",
              "function_name": "tg_audit_permission_change"
            },
            {
              "name": "set_features_updated_at",
              "enabled": "O",
              "definition": "CREATE TRIGGER set_features_updated_at BEFORE UPDATE ON features FOR EACH ROW EXECUTE FUNCTION set_updated_at()",
              "function_name": "set_updated_at"
            }
          ],
          "estimates": {
            "row_estimate": 1,
            "size_pretty": "64 kB",
            "size_bytes": 65536
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "parametres"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "integer",
              "is_nullable": "NO",
              "default": "1"
            },
            {
              "column_name": "confettis",
              "data_type": "boolean",
              "is_nullable": "NO",
              "default": "true"
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": true
          },
          "policies": [
            {
              "policyname": "parametres_delete_admin_only",
              "command": "DELETE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "is_admin()",
              "with_check": null
            },
            {
              "policyname": "parametres_insert_all_users",
              "command": "INSERT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": null,
              "with_check": "is_admin()"
            },
            {
              "policyname": "parametres_select_all_users",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "true",
              "with_check": null
            },
            {
              "policyname": "parametres_update_all_users",
              "command": "UPDATE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "is_admin()",
              "with_check": "is_admin()"
            }
          ],
          "indexes": [
            {
              "name": "parametres_pkey",
              "def": "CREATE UNIQUE INDEX parametres_pkey ON public.parametres USING btree (id)"
            }
          ],
          "constraints": [
            {
              "name": "parametres_id_is_one",
              "type": "c",
              "definition": "CHECK ((id = 1))"
            },
            {
              "name": "parametres_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            }
          ],
          "triggers": [
            {
              "name": "parametres_lock_id",
              "enabled": "O",
              "definition": "CREATE TRIGGER parametres_lock_id BEFORE UPDATE ON parametres FOR EACH ROW EXECUTE FUNCTION tg_parametres_lock_id()",
              "function_name": "tg_parametres_lock_id"
            },
            {
              "name": "set_parametres_updated_at",
              "enabled": "O",
              "definition": "CREATE TRIGGER set_parametres_updated_at BEFORE UPDATE ON parametres FOR EACH ROW EXECUTE FUNCTION set_updated_at()",
              "function_name": "set_updated_at"
            }
          ],
          "estimates": {
            "row_estimate": 1,
            "size_pretty": "24 kB",
            "size_bytes": 24576
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "permission_changes"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "changed_by",
              "data_type": "uuid",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "change_type",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "table_name",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "record_id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "old_values",
              "data_type": "jsonb",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "new_values",
              "data_type": "jsonb",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "change_reason",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "changed_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": true
          },
          "policies": [
            {
              "policyname": "permission_changes_delete_admin",
              "command": "DELETE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "is_admin()",
              "with_check": null
            },
            {
              "policyname": "permission_changes_insert_admin",
              "command": "INSERT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": null,
              "with_check": "is_admin()"
            },
            {
              "policyname": "permission_changes_select_admin",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "is_admin()",
              "with_check": null
            },
            {
              "policyname": "permission_changes_update_admin",
              "command": "UPDATE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "is_admin()",
              "with_check": "is_admin()"
            }
          ],
          "indexes": [
            {
              "name": "permission_changes_change_type_idx",
              "def": "CREATE INDEX permission_changes_change_type_idx ON public.permission_changes USING btree (change_type)"
            },
            {
              "name": "permission_changes_changed_at_idx",
              "def": "CREATE INDEX permission_changes_changed_at_idx ON public.permission_changes USING btree (changed_at DESC)"
            },
            {
              "name": "permission_changes_changed_by_idx",
              "def": "CREATE INDEX permission_changes_changed_by_idx ON public.permission_changes USING btree (changed_by)"
            },
            {
              "name": "permission_changes_created_at_idx",
              "def": "CREATE INDEX permission_changes_created_at_idx ON public.permission_changes USING btree (created_at DESC)"
            },
            {
              "name": "permission_changes_pkey",
              "def": "CREATE UNIQUE INDEX permission_changes_pkey ON public.permission_changes USING btree (id)"
            },
            {
              "name": "permission_changes_record_id_idx",
              "def": "CREATE INDEX permission_changes_record_id_idx ON public.permission_changes USING btree (record_id)"
            },
            {
              "name": "permission_changes_table_name_idx",
              "def": "CREATE INDEX permission_changes_table_name_idx ON public.permission_changes USING btree (table_name)"
            },
            {
              "name": "permission_changes_table_type_idx",
              "def": "CREATE INDEX permission_changes_table_type_idx ON public.permission_changes USING btree (table_name, change_type)"
            }
          ],
          "constraints": [
            {
              "name": "permission_changes_change_reason_length_check",
              "type": "c",
              "definition": "CHECK (((change_reason IS NULL) OR (length(change_reason) <= 500)))"
            },
            {
              "name": "permission_changes_change_type_check",
              "type": "c",
              "definition": "CHECK ((change_type = ANY (ARRAY['INSERT'::text, 'UPDATE'::text, 'DELETE'::text])))"
            },
            {
              "name": "permission_changes_changed_by_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (changed_by) REFERENCES auth.users(id) ON DELETE SET NULL"
            },
            {
              "name": "permission_changes_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "permission_changes_record_id_not_null",
              "type": "c",
              "definition": "CHECK ((record_id IS NOT NULL))"
            },
            {
              "name": "permission_changes_table_name_not_blank",
              "type": "c",
              "definition": "CHECK (((table_name IS NOT NULL) AND (btrim(table_name) <> ''::text)))"
            }
          ],
          "triggers": [
            {
              "name": "permission_changes_validate_json",
              "enabled": "O",
              "definition": "CREATE TRIGGER permission_changes_validate_json BEFORE INSERT OR UPDATE ON permission_changes FOR EACH ROW EXECUTE FUNCTION tg_permission_changes_validate_json()",
              "function_name": "tg_permission_changes_validate_json"
            }
          ],
          "estimates": {
            "row_estimate": 88,
            "size_pretty": "224 kB",
            "size_bytes": 229376
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "profiles"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "pseudo",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "avatar_url",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "is_admin",
              "data_type": "boolean",
              "is_nullable": "NO",
              "default": "false"
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "date_naissance",
              "data_type": "date",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "ville",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "account_status",
              "data_type": "text",
              "is_nullable": "NO",
              "default": "'active'::text"
            },
            {
              "column_name": "deletion_scheduled_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": null
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "profiles_insert_unified",
              "command": "INSERT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": null,
              "with_check": "(is_admin() OR (( SELECT auth.uid() AS uid) = id))"
            },
            {
              "policyname": "profiles_select_unified",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (id = ( SELECT auth.uid() AS uid)))",
              "with_check": null
            },
            {
              "policyname": "profiles_update_unified",
              "command": "UPDATE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (id = ( SELECT auth.uid() AS uid)))",
              "with_check": "(is_admin() OR (id = ( SELECT auth.uid() AS uid)))"
            }
          ],
          "indexes": [
            {
              "name": "idx_profiles_account_status",
              "def": "CREATE INDEX idx_profiles_account_status ON public.profiles USING btree (account_status)"
            },
            {
              "name": "idx_profiles_deletion_scheduled",
              "def": "CREATE INDEX idx_profiles_deletion_scheduled ON public.profiles USING btree (deletion_scheduled_at) WHERE (account_status = 'deletion_scheduled'::text)"
            },
            {
              "name": "idx_profiles_is_admin",
              "def": "CREATE INDEX idx_profiles_is_admin ON public.profiles USING btree (is_admin)"
            },
            {
              "name": "idx_profiles_updated_at",
              "def": "CREATE INDEX idx_profiles_updated_at ON public.profiles USING btree (updated_at DESC)"
            },
            {
              "name": "profiles_pkey",
              "def": "CREATE UNIQUE INDEX profiles_pkey ON public.profiles USING btree (id)"
            },
            {
              "name": "profiles_pseudo_unique",
              "def": "CREATE UNIQUE INDEX profiles_pseudo_unique ON public.profiles USING btree (pseudo)"
            }
          ],
          "constraints": [
            {
              "name": "profiles_account_status_check",
              "type": "c",
              "definition": "CHECK ((account_status = ANY (ARRAY['active'::text, 'suspended'::text, 'deletion_scheduled'::text, 'pending_verification'::text])))"
            },
            {
              "name": "profiles_birthdate_chk",
              "type": "c",
              "definition": "CHECK (((date_naissance IS NULL) OR (date_naissance <= CURRENT_DATE)))"
            },
            {
              "name": "profiles_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (id) REFERENCES auth.users(id) ON DELETE CASCADE"
            },
            {
              "name": "profiles_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "profiles_pseudo_unique",
              "type": "u",
              "definition": "UNIQUE (pseudo)"
            }
          ],
          "triggers": [
            {
              "name": "set_profiles_updated_at",
              "enabled": "O",
              "definition": "CREATE TRIGGER set_profiles_updated_at BEFORE INSERT OR UPDATE ON profiles FOR EACH ROW EXECUTE FUNCTION set_updated_at()",
              "function_name": "set_updated_at"
            }
          ],
          "estimates": {
            "row_estimate": 5,
            "size_pretty": "104 kB",
            "size_bytes": 106496
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "recompenses"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "label",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "description",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "points_requis",
              "data_type": "integer",
              "is_nullable": "NO",
              "default": "0"
            },
            {
              "column_name": "icone",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "couleur",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "imagepath",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "selected",
              "data_type": "boolean",
              "is_nullable": "NO",
              "default": "false"
            },
            {
              "column_name": "visible_en_demo",
              "data_type": "boolean",
              "is_nullable": "NO",
              "default": "false"
            },
            {
              "column_name": "user_id",
              "data_type": "uuid",
              "is_nullable": "YES",
              "default": "auth.uid()"
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": true
          },
          "policies": [
            {
              "policyname": "recompenses_delete_unified",
              "command": "DELETE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
              "with_check": null
            },
            {
              "policyname": "recompenses_insert_unified",
              "command": "INSERT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": null,
              "with_check": "(is_admin() OR ((user_id = ( SELECT auth.uid() AS uid)) AND check_user_quota(( SELECT auth.uid() AS uid), 'reward'::text, 'total'::text) AND check_user_quota(( SELECT auth.uid() AS uid), 'reward'::text, 'monthly'::text)))"
            },
            {
              "policyname": "recompenses_select_demo",
              "command": "SELECT",
              "roles": ["anon"],
              "mode": "PERMISSIVE",
              "using": "(visible_en_demo = true)",
              "with_check": null
            },
            {
              "policyname": "recompenses_select_unified",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)) OR ((user_id IS NULL) AND (visible_en_demo = true)))",
              "with_check": null
            },
            {
              "policyname": "recompenses_update_unified",
              "command": "UPDATE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
              "with_check": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))"
            }
          ],
          "indexes": [
            {
              "name": "idx_recompenses_user_created",
              "def": "CREATE INDEX idx_recompenses_user_created ON public.recompenses USING btree (user_id, created_at)"
            },
            {
              "name": "recompenses_one_selected_per_user",
              "def": "CREATE UNIQUE INDEX recompenses_one_selected_per_user ON public.recompenses USING btree (user_id) WHERE ((selected IS TRUE) AND (user_id IS NOT NULL))"
            },
            {
              "name": "recompenses_pkey",
              "def": "CREATE UNIQUE INDEX recompenses_pkey ON public.recompenses USING btree (id)"
            },
            {
              "name": "recompenses_points_requis_idx",
              "def": "CREATE INDEX recompenses_points_requis_idx ON public.recompenses USING btree (points_requis)"
            },
            {
              "name": "recompenses_selected_idx",
              "def": "CREATE INDEX recompenses_selected_idx ON public.recompenses USING btree (selected)"
            },
            {
              "name": "recompenses_user_id_idx",
              "def": "CREATE INDEX recompenses_user_id_idx ON public.recompenses USING btree (user_id)"
            },
            {
              "name": "recompenses_user_selected_idx",
              "def": "CREATE INDEX recompenses_user_selected_idx ON public.recompenses USING btree (user_id, selected)"
            },
            {
              "name": "recompenses_visible_en_demo_idx",
              "def": "CREATE INDEX recompenses_visible_en_demo_idx ON public.recompenses USING btree (visible_en_demo)"
            }
          ],
          "constraints": [
            {
              "name": "recompenses_description_length_check",
              "type": "c",
              "definition": "CHECK (((description IS NULL) OR (length(description) <= 1000)))"
            },
            {
              "name": "recompenses_imagepath_length_check",
              "type": "c",
              "definition": "CHECK (((imagepath IS NULL) OR (length(imagepath) <= 2048)))"
            },
            {
              "name": "recompenses_label_length_check",
              "type": "c",
              "definition": "CHECK ((length(label) <= 200))"
            },
            {
              "name": "recompenses_label_not_blank",
              "type": "c",
              "definition": "CHECK (((label IS NOT NULL) AND (btrim(label) <> ''::text)))"
            },
            {
              "name": "recompenses_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "recompenses_points_requis_positive",
              "type": "c",
              "definition": "CHECK ((points_requis >= 0))"
            },
            {
              "name": "recompenses_user_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE"
            }
          ],
          "triggers": [
            {
              "name": "a00_recompenses_set_user_id_before",
              "enabled": "O",
              "definition": "CREATE TRIGGER a00_recompenses_set_user_id_before BEFORE INSERT ON recompenses FOR EACH ROW EXECUTE FUNCTION tg_recompenses_set_user_id()",
              "function_name": "tg_recompenses_set_user_id"
            },
            {
              "name": "a99_recompenses_set_updated_at",
              "enabled": "O",
              "definition": "CREATE TRIGGER a99_recompenses_set_updated_at BEFORE UPDATE ON recompenses FOR EACH ROW EXECUTE FUNCTION set_updated_at()",
              "function_name": "set_updated_at"
            },
            {
              "name": "recompenses_normalize",
              "enabled": "O",
              "definition": "CREATE TRIGGER recompenses_normalize BEFORE INSERT OR UPDATE ON recompenses FOR EACH ROW EXECUTE FUNCTION tg_recompenses_normalize()",
              "function_name": "tg_recompenses_normalize"
            },
            {
              "name": "trg_recompenses_ctr_del",
              "enabled": "O",
              "definition": "CREATE TRIGGER trg_recompenses_ctr_del AFTER DELETE ON recompenses FOR EACH ROW EXECUTE FUNCTION recompenses_counter_del()",
              "function_name": "recompenses_counter_del"
            },
            {
              "name": "trg_recompenses_ctr_ins",
              "enabled": "O",
              "definition": "CREATE TRIGGER trg_recompenses_ctr_ins AFTER INSERT ON recompenses FOR EACH ROW EXECUTE FUNCTION recompenses_counter_ins()",
              "function_name": "recompenses_counter_ins"
            }
          ],
          "estimates": {
            "row_estimate": 0,
            "size_pretty": "152 kB",
            "size_bytes": 155648
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "role_permissions"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "role_id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "feature_id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "can_access",
              "data_type": "boolean",
              "is_nullable": "NO",
              "default": "false"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "role_permissions_select_unified",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (EXISTS ( SELECT 1\n   FROM user_roles ur\n  WHERE ((ur.user_id = ( SELECT auth.uid() AS uid)) AND (ur.role_id = role_permissions.role_id) AND (ur.is_active = true)))))",
              "with_check": null
            }
          ],
          "indexes": [
            {
              "name": "idx_role_permissions_feature_id",
              "def": "CREATE INDEX idx_role_permissions_feature_id ON public.role_permissions USING btree (feature_id)"
            },
            {
              "name": "idx_role_permissions_role_access",
              "def": "CREATE INDEX idx_role_permissions_role_access ON public.role_permissions USING btree (role_id, can_access)"
            },
            {
              "name": "role_permissions_pkey",
              "def": "CREATE UNIQUE INDEX role_permissions_pkey ON public.role_permissions USING btree (id)"
            },
            {
              "name": "role_permissions_role_id_feature_id_key",
              "def": "CREATE UNIQUE INDEX role_permissions_role_id_feature_id_key ON public.role_permissions USING btree (role_id, feature_id)"
            }
          ],
          "constraints": [
            {
              "name": "role_permissions_feature_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (feature_id) REFERENCES features(id) ON DELETE CASCADE"
            },
            {
              "name": "role_permissions_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "role_permissions_role_id_feature_id_key",
              "type": "u",
              "definition": "UNIQUE (role_id, feature_id)"
            },
            {
              "name": "role_permissions_role_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (role_id) REFERENCES roles(id) ON DELETE CASCADE"
            }
          ],
          "triggers": [
            {
              "name": "audit_role_permissions_changes",
              "enabled": "O",
              "definition": "CREATE TRIGGER audit_role_permissions_changes AFTER INSERT OR DELETE OR UPDATE ON role_permissions FOR EACH ROW EXECUTE FUNCTION tg_audit_permission_change()",
              "function_name": "tg_audit_permission_change"
            },
            {
              "name": "set_role_permissions_updated_at",
              "enabled": "O",
              "definition": "CREATE TRIGGER set_role_permissions_updated_at BEFORE INSERT OR UPDATE ON role_permissions FOR EACH ROW EXECUTE FUNCTION set_updated_at()",
              "function_name": "set_updated_at"
            }
          ],
          "estimates": {
            "row_estimate": 2,
            "size_pretty": "88 kB",
            "size_bytes": 90112
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "role_quotas"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "role_id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "quota_type",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "quota_limit",
              "data_type": "integer",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "quota_period",
              "data_type": "text",
              "is_nullable": "YES",
              "default": "'monthly'::text"
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "role_quotas_select_public",
              "command": "SELECT",
              "roles": ["public"],
              "mode": "PERMISSIVE",
              "using": "true",
              "with_check": null
            }
          ],
          "indexes": [
            {
              "name": "idx_role_quotas_role_type",
              "def": "CREATE INDEX idx_role_quotas_role_type ON public.role_quotas USING btree (role_id, quota_type)"
            },
            {
              "name": "role_quotas_pkey",
              "def": "CREATE UNIQUE INDEX role_quotas_pkey ON public.role_quotas USING btree (id)"
            },
            {
              "name": "role_quotas_role_id_quota_type_quota_period_key",
              "def": "CREATE UNIQUE INDEX role_quotas_role_id_quota_type_quota_period_key ON public.role_quotas USING btree (role_id, quota_type, quota_period)"
            }
          ],
          "constraints": [
            {
              "name": "role_quotas_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "role_quotas_quota_period_check",
              "type": "c",
              "definition": "CHECK ((quota_period = ANY (ARRAY['monthly'::text, 'total'::text, 'daily'::text])))"
            },
            {
              "name": "role_quotas_role_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (role_id) REFERENCES roles(id) ON DELETE CASCADE"
            },
            {
              "name": "role_quotas_role_id_quota_type_quota_period_key",
              "type": "u",
              "definition": "UNIQUE (role_id, quota_type, quota_period)"
            }
          ],
          "triggers": [],
          "estimates": {
            "row_estimate": 8,
            "size_pretty": "64 kB",
            "size_bytes": 65536
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "roles"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "name",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "description",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "display_name",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "priority",
              "data_type": "integer",
              "is_nullable": "YES",
              "default": "0"
            },
            {
              "column_name": "is_active",
              "data_type": "boolean",
              "is_nullable": "NO",
              "default": "true"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "roles_select_unified",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (is_active = true))",
              "with_check": null
            }
          ],
          "indexes": [
            {
              "name": "idx_roles_is_active",
              "def": "CREATE INDEX idx_roles_is_active ON public.roles USING btree (is_active) WHERE (is_active = true)"
            },
            {
              "name": "idx_roles_priority_name",
              "def": "CREATE INDEX idx_roles_priority_name ON public.roles USING btree (priority DESC, name)"
            },
            {
              "name": "roles_name_key",
              "def": "CREATE UNIQUE INDEX roles_name_key ON public.roles USING btree (name)"
            },
            {
              "name": "roles_pkey",
              "def": "CREATE UNIQUE INDEX roles_pkey ON public.roles USING btree (id)"
            }
          ],
          "constraints": [
            {
              "name": "roles_name_key",
              "type": "u",
              "definition": "UNIQUE (name)"
            },
            {
              "name": "roles_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            }
          ],
          "triggers": [
            {
              "name": "audit_roles_changes",
              "enabled": "O",
              "definition": "CREATE TRIGGER audit_roles_changes AFTER INSERT OR DELETE OR UPDATE ON roles FOR EACH ROW EXECUTE FUNCTION tg_audit_permission_change()",
              "function_name": "tg_audit_permission_change"
            },
            {
              "name": "prevent_system_role_delete_trigger",
              "enabled": "O",
              "definition": "CREATE TRIGGER prevent_system_role_delete_trigger BEFORE DELETE ON roles FOR EACH ROW EXECUTE FUNCTION prevent_system_role_delete()",
              "function_name": "prevent_system_role_delete"
            },
            {
              "name": "prevent_system_role_deletion_trigger",
              "enabled": "O",
              "definition": "CREATE TRIGGER prevent_system_role_deletion_trigger BEFORE UPDATE ON roles FOR EACH ROW EXECUTE FUNCTION prevent_system_role_deletion()",
              "function_name": "prevent_system_role_deletion"
            },
            {
              "name": "set_roles_updated_at",
              "enabled": "O",
              "definition": "CREATE TRIGGER set_roles_updated_at BEFORE UPDATE ON roles FOR EACH ROW EXECUTE FUNCTION set_updated_at()",
              "function_name": "set_updated_at"
            }
          ],
          "estimates": {
            "row_estimate": 5,
            "size_pretty": "80 kB",
            "size_bytes": 81920
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "stations"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "label",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "ligne",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "ordre",
              "data_type": "integer",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "type",
              "data_type": "USER-DEFINED",
              "is_nullable": "NO",
              "default": "'metro'::transport_type"
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": true
          },
          "policies": [
            {
              "policyname": "stations_select_anon",
              "command": "SELECT",
              "roles": ["anon"],
              "mode": "PERMISSIVE",
              "using": "true",
              "with_check": null
            },
            {
              "policyname": "stations_select_unified",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "true",
              "with_check": null
            }
          ],
          "indexes": [
            {
              "name": "stations_label_idx",
              "def": "CREATE INDEX stations_label_idx ON public.stations USING btree (label)"
            },
            {
              "name": "stations_ligne_type_idx",
              "def": "CREATE INDEX stations_ligne_type_idx ON public.stations USING btree (ligne, type)"
            },
            {
              "name": "stations_pkey",
              "def": "CREATE UNIQUE INDEX stations_pkey ON public.stations USING btree (id)"
            },
            {
              "name": "stations_type_ligne_label_unique",
              "def": "CREATE UNIQUE INDEX stations_type_ligne_label_unique ON public.stations USING btree (type, ligne, label)"
            },
            {
              "name": "stations_type_ligne_ordre_idx",
              "def": "CREATE INDEX stations_type_ligne_ordre_idx ON public.stations USING btree (type, ligne, ordre)"
            },
            {
              "name": "stations_type_ligne_ordre_unique",
              "def": "CREATE UNIQUE INDEX stations_type_ligne_ordre_unique ON public.stations USING btree (type, ligne, ordre)"
            }
          ],
          "constraints": [
            {
              "name": "stations_label_length_check",
              "type": "c",
              "definition": "CHECK ((length(label) <= 150))"
            },
            {
              "name": "stations_label_not_blank",
              "type": "c",
              "definition": "CHECK (((label IS NOT NULL) AND (btrim(label) <> ''::text)))"
            },
            {
              "name": "stations_ligne_format_check",
              "type": "c",
              "definition": "CHECK ((ligne ~ '^[0-9]+(\\s+(bis|ter))?$'::text))"
            },
            {
              "name": "stations_ligne_length_check",
              "type": "c",
              "definition": "CHECK ((length(ligne) <= 20))"
            },
            {
              "name": "stations_ligne_not_blank",
              "type": "c",
              "definition": "CHECK (((ligne IS NOT NULL) AND (btrim(ligne) <> ''::text)))"
            },
            {
              "name": "stations_ordre_max_check",
              "type": "c",
              "definition": "CHECK ((ordre <= 50))"
            },
            {
              "name": "stations_ordre_positive",
              "type": "c",
              "definition": "CHECK ((ordre > 0))"
            },
            {
              "name": "stations_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            }
          ],
          "triggers": [
            {
              "name": "stations_set_updated_at",
              "enabled": "O",
              "definition": "CREATE TRIGGER stations_set_updated_at BEFORE UPDATE ON stations FOR EACH ROW EXECUTE FUNCTION set_updated_at()",
              "function_name": "set_updated_at"
            }
          ],
          "estimates": {
            "row_estimate": 84,
            "size_pretty": "152 kB",
            "size_bytes": 155648
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "subscription_logs"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "user_id",
              "data_type": "uuid",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "event_type",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "details",
              "data_type": "jsonb",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "timestamp",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "logs_select_user_or_admin",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "((user_id = ( SELECT auth.uid() AS uid)) OR is_admin())",
              "with_check": null
            }
          ],
          "indexes": [
            {
              "name": "subscription_logs_pkey",
              "def": "CREATE UNIQUE INDEX subscription_logs_pkey ON public.subscription_logs USING btree (id)"
            },
            {
              "name": "subscription_logs_user_event_time_idx",
              "def": "CREATE INDEX subscription_logs_user_event_time_idx ON public.subscription_logs USING btree (user_id, event_type, \"timestamp\" DESC)"
            },
            {
              "name": "subscription_logs_user_time_idx",
              "def": "CREATE INDEX subscription_logs_user_time_idx ON public.subscription_logs USING btree (user_id, \"timestamp\" DESC)"
            }
          ],
          "constraints": [
            {
              "name": "subscription_logs_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "subscription_logs_user_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE SET NULL"
            }
          ],
          "triggers": [],
          "estimates": {
            "row_estimate": 14,
            "size_pretty": "64 kB",
            "size_bytes": 65536
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "taches"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "label",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "description",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "categorie",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "categorie_id",
              "data_type": "uuid",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "points",
              "data_type": "integer",
              "is_nullable": "NO",
              "default": "0"
            },
            {
              "column_name": "icone",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "couleur",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "aujourdhui",
              "data_type": "boolean",
              "is_nullable": "NO",
              "default": "false"
            },
            {
              "column_name": "fait",
              "data_type": "boolean",
              "is_nullable": "NO",
              "default": "false"
            },
            {
              "column_name": "position",
              "data_type": "integer",
              "is_nullable": "NO",
              "default": "0"
            },
            {
              "column_name": "imagepath",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "visible_en_demo",
              "data_type": "boolean",
              "is_nullable": "NO",
              "default": "false"
            },
            {
              "column_name": "user_id",
              "data_type": "uuid",
              "is_nullable": "YES",
              "default": "auth.uid()"
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": true
          },
          "policies": [
            {
              "policyname": "taches_delete_unified",
              "command": "DELETE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
              "with_check": null
            },
            {
              "policyname": "taches_insert_unified",
              "command": "INSERT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": null,
              "with_check": "(is_admin() OR ((user_id = ( SELECT auth.uid() AS uid)) AND check_user_quota(( SELECT auth.uid() AS uid), 'task'::text, 'total'::text) AND check_user_quota(( SELECT auth.uid() AS uid), 'task'::text, 'monthly'::text)))"
            },
            {
              "policyname": "taches_select_demo",
              "command": "SELECT",
              "roles": ["anon"],
              "mode": "PERMISSIVE",
              "using": "(visible_en_demo = true)",
              "with_check": null
            },
            {
              "policyname": "taches_select_owner_or_admin",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "((user_id = ( SELECT auth.uid() AS uid)) OR is_admin())",
              "with_check": null
            },
            {
              "policyname": "taches_update_unified",
              "command": "UPDATE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
              "with_check": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))"
            }
          ],
          "indexes": [
            {
              "name": "idx_taches_user_created",
              "def": "CREATE INDEX idx_taches_user_created ON public.taches USING btree (user_id, created_at)"
            },
            {
              "name": "taches_categorie_id_idx",
              "def": "CREATE INDEX taches_categorie_id_idx ON public.taches USING btree (categorie_id)"
            },
            {
              "name": "taches_categorie_idx",
              "def": "CREATE INDEX taches_categorie_idx ON public.taches USING btree (categorie)"
            },
            {
              "name": "taches_fait_idx",
              "def": "CREATE INDEX taches_fait_idx ON public.taches USING btree (fait)"
            },
            {
              "name": "taches_pkey",
              "def": "CREATE UNIQUE INDEX taches_pkey ON public.taches USING btree (id)"
            },
            {
              "name": "taches_user_aujourdhui_idx",
              "def": "CREATE INDEX taches_user_aujourdhui_idx ON public.taches USING btree (user_id, aujourdhui)"
            },
            {
              "name": "taches_user_fait_idx",
              "def": "CREATE INDEX taches_user_fait_idx ON public.taches USING btree (user_id, fait)"
            },
            {
              "name": "taches_user_fait_true_idx",
              "def": "CREATE INDEX taches_user_fait_true_idx ON public.taches USING btree (user_id) WHERE (fait IS TRUE)"
            },
            {
              "name": "taches_user_id_idx",
              "def": "CREATE INDEX taches_user_id_idx ON public.taches USING btree (user_id)"
            },
            {
              "name": "taches_user_position_idx",
              "def": "CREATE INDEX taches_user_position_idx ON public.taches USING btree (user_id, \"position\")"
            },
            {
              "name": "taches_visible_en_demo_idx",
              "def": "CREATE INDEX taches_visible_en_demo_idx ON public.taches USING btree (visible_en_demo)"
            }
          ],
          "constraints": [
            {
              "name": "taches_categorie_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (categorie_id) REFERENCES categories(id) ON DELETE SET NULL"
            },
            {
              "name": "taches_description_length_check",
              "type": "c",
              "definition": "CHECK ((length(description) <= 1000))"
            },
            {
              "name": "taches_label_length_check",
              "type": "c",
              "definition": "CHECK ((length(label) <= 200))"
            },
            {
              "name": "taches_label_not_blank",
              "type": "c",
              "definition": "CHECK (((label IS NOT NULL) AND (btrim(label) <> ''::text)))"
            },
            {
              "name": "taches_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "taches_points_positive",
              "type": "c",
              "definition": "CHECK ((points >= 0))"
            },
            {
              "name": "taches_position_positive",
              "type": "c",
              "definition": "CHECK ((\"position\" >= 0))"
            },
            {
              "name": "taches_user_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE"
            }
          ],
          "triggers": [
            {
              "name": "a00_taches_set_user_id_before",
              "enabled": "O",
              "definition": "CREATE TRIGGER a00_taches_set_user_id_before BEFORE INSERT ON taches FOR EACH ROW EXECUTE FUNCTION tg_taches_set_user_id()",
              "function_name": "tg_taches_set_user_id"
            },
            {
              "name": "a10_taches_normalize_categorie",
              "enabled": "O",
              "definition": "CREATE TRIGGER a10_taches_normalize_categorie BEFORE INSERT OR UPDATE OF categorie ON taches FOR EACH ROW EXECUTE FUNCTION tg_taches_normalize_categorie()",
              "function_name": "tg_taches_normalize_categorie"
            },
            {
              "name": "a20_taches_sync_categorie",
              "enabled": "O",
              "definition": "CREATE TRIGGER a20_taches_sync_categorie BEFORE INSERT OR UPDATE OF categorie, user_id ON taches FOR EACH ROW EXECUTE FUNCTION tg_taches_sync_categorie()",
              "function_name": "tg_taches_sync_categorie"
            },
            {
              "name": "a99_taches_set_updated_at",
              "enabled": "O",
              "definition": "CREATE TRIGGER a99_taches_set_updated_at BEFORE UPDATE ON taches FOR EACH ROW EXECUTE FUNCTION set_updated_at()",
              "function_name": "set_updated_at"
            },
            {
              "name": "taches_sync_categorie",
              "enabled": "D",
              "definition": "CREATE TRIGGER taches_sync_categorie BEFORE INSERT OR UPDATE ON taches FOR EACH ROW EXECUTE FUNCTION tg_taches_sync_categorie()",
              "function_name": "tg_taches_sync_categorie"
            },
            {
              "name": "trg_taches_ctr_del",
              "enabled": "O",
              "definition": "CREATE TRIGGER trg_taches_ctr_del AFTER DELETE ON taches FOR EACH ROW EXECUTE FUNCTION taches_counter_del()",
              "function_name": "taches_counter_del"
            },
            {
              "name": "trg_taches_ctr_ins",
              "enabled": "O",
              "definition": "CREATE TRIGGER trg_taches_ctr_ins AFTER INSERT ON taches FOR EACH ROW EXECUTE FUNCTION taches_counter_ins()",
              "function_name": "taches_counter_ins"
            }
          ],
          "estimates": {
            "row_estimate": 0,
            "size_pretty": "208 kB",
            "size_bytes": 212992
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "user_assets"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "user_id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "asset_type",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "file_path",
              "data_type": "text",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "file_size",
              "data_type": "bigint",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "mime_type",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "dimensions",
              "data_type": "text",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "user_assets_delete_unified",
              "command": "DELETE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (( SELECT auth.uid() AS uid) = user_id))",
              "with_check": null
            },
            {
              "policyname": "user_assets_insert_self",
              "command": "INSERT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": null,
              "with_check": "(( SELECT auth.uid() AS uid) = user_id)"
            },
            {
              "policyname": "user_assets_select_unified",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (( SELECT auth.uid() AS uid) = user_id))",
              "with_check": null
            },
            {
              "policyname": "user_assets_update_unified",
              "command": "UPDATE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (( SELECT auth.uid() AS uid) = user_id))",
              "with_check": "(is_admin() OR (( SELECT auth.uid() AS uid) = user_id))"
            }
          ],
          "indexes": [
            {
              "name": "idx_user_assets_created",
              "def": "CREATE INDEX idx_user_assets_created ON public.user_assets USING btree (created_at)"
            },
            {
              "name": "idx_user_assets_type",
              "def": "CREATE INDEX idx_user_assets_type ON public.user_assets USING btree (user_id, asset_type)"
            },
            {
              "name": "idx_user_assets_user_created_desc",
              "def": "CREATE INDEX idx_user_assets_user_created_desc ON public.user_assets USING btree (user_id, created_at DESC)"
            },
            {
              "name": "idx_user_assets_user_id",
              "def": "CREATE INDEX idx_user_assets_user_id ON public.user_assets USING btree (user_id)"
            },
            {
              "name": "unique_user_file_path",
              "def": "CREATE UNIQUE INDEX unique_user_file_path ON public.user_assets USING btree (user_id, file_path)"
            },
            {
              "name": "user_assets_pkey",
              "def": "CREATE UNIQUE INDEX user_assets_pkey ON public.user_assets USING btree (id)"
            }
          ],
          "constraints": [
            {
              "name": "unique_user_file_path",
              "type": "u",
              "definition": "UNIQUE (user_id, file_path)"
            },
            {
              "name": "user_assets_asset_type_check",
              "type": "c",
              "definition": "CHECK ((asset_type = ANY (ARRAY['task_image'::text, 'reward_image'::text])))"
            },
            {
              "name": "user_assets_file_size_nonneg",
              "type": "c",
              "definition": "CHECK ((file_size >= 0))"
            },
            {
              "name": "user_assets_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "user_assets_user_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE"
            }
          ],
          "triggers": [
            {
              "name": "trg_user_assets_updated_at",
              "enabled": "O",
              "definition": "CREATE TRIGGER trg_user_assets_updated_at BEFORE UPDATE ON user_assets FOR EACH ROW EXECUTE FUNCTION set_updated_at()",
              "function_name": "set_updated_at"
            }
          ],
          "estimates": {
            "row_estimate": 4,
            "size_pretty": "112 kB",
            "size_bytes": 114688
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "user_prefs"
          },
          "columns": [
            {
              "column_name": "user_id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "timezone",
              "data_type": "text",
              "is_nullable": "NO",
              "default": "'Europe/Paris'::text"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "user_prefs_select_self",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(( SELECT auth.uid() AS uid) = user_id)",
              "with_check": null
            },
            {
              "policyname": "user_prefs_update_self",
              "command": "UPDATE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(( SELECT auth.uid() AS uid) = user_id)",
              "with_check": "(( SELECT auth.uid() AS uid) = user_id)"
            },
            {
              "policyname": "user_prefs_upsert_self",
              "command": "INSERT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": null,
              "with_check": "(( SELECT auth.uid() AS uid) = user_id)"
            }
          ],
          "indexes": [
            {
              "name": "idx_user_prefs_tz",
              "def": "CREATE INDEX idx_user_prefs_tz ON public.user_prefs USING btree (timezone)"
            },
            {
              "name": "user_prefs_pkey",
              "def": "CREATE UNIQUE INDEX user_prefs_pkey ON public.user_prefs USING btree (user_id)"
            }
          ],
          "constraints": [
            {
              "name": "user_prefs_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (user_id)"
            },
            {
              "name": "user_prefs_user_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE"
            }
          ],
          "triggers": [],
          "estimates": {
            "row_estimate": 3,
            "size_pretty": "80 kB",
            "size_bytes": 81920
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "user_roles"
          },
          "columns": [
            {
              "column_name": "id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": "gen_random_uuid()"
            },
            {
              "column_name": "user_id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "role_id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "is_active",
              "data_type": "boolean",
              "is_nullable": "NO",
              "default": "true"
            },
            {
              "column_name": "created_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            },
            {
              "column_name": "assigned_by",
              "data_type": "uuid",
              "is_nullable": "YES",
              "default": null
            },
            {
              "column_name": "assigned_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": "now()"
            },
            {
              "column_name": "expires_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "YES",
              "default": null
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "user_roles_insert_unified",
              "command": "INSERT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": null,
              "with_check": "(is_admin() OR ((user_id = ( SELECT auth.uid() AS uid)) AND (role_id IN ( SELECT roles.id\n   FROM roles\n  WHERE ((roles.name = 'free'::text) AND (roles.is_active = true))))))"
            },
            {
              "policyname": "user_roles_select_unified",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
              "with_check": null
            },
            {
              "policyname": "user_roles_update_unified",
              "command": "UPDATE",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(is_admin() OR (user_id = ( SELECT auth.uid() AS uid)))",
              "with_check": "(is_admin() OR ((user_id = ( SELECT auth.uid() AS uid)) AND (role_id IN ( SELECT roles.id\n   FROM roles\n  WHERE ((roles.name = 'free'::text) AND (roles.is_active = true))))))"
            }
          ],
          "indexes": [
            {
              "name": "idx_user_roles_expires_at",
              "def": "CREATE INDEX idx_user_roles_expires_at ON public.user_roles USING btree (expires_at)"
            },
            {
              "name": "idx_user_roles_expiring_active",
              "def": "CREATE INDEX idx_user_roles_expiring_active ON public.user_roles USING btree (expires_at) WHERE (is_active = true)"
            },
            {
              "name": "idx_user_roles_is_active",
              "def": "CREATE INDEX idx_user_roles_is_active ON public.user_roles USING btree (is_active)"
            },
            {
              "name": "idx_user_roles_role_active",
              "def": "CREATE INDEX idx_user_roles_role_active ON public.user_roles USING btree (role_id, is_active)"
            },
            {
              "name": "idx_user_roles_role_id",
              "def": "CREATE INDEX idx_user_roles_role_id ON public.user_roles USING btree (role_id)"
            },
            {
              "name": "idx_user_roles_user_active",
              "def": "CREATE INDEX idx_user_roles_user_active ON public.user_roles USING btree (user_id, is_active) WHERE (is_active = true)"
            },
            {
              "name": "idx_user_roles_user_active_inc",
              "def": "CREATE INDEX idx_user_roles_user_active_inc ON public.user_roles USING btree (user_id, is_active) INCLUDE (role_id)"
            },
            {
              "name": "idx_user_roles_user_id",
              "def": "CREATE INDEX idx_user_roles_user_id ON public.user_roles USING btree (user_id)"
            },
            {
              "name": "uq_user_roles_one_active",
              "def": "CREATE UNIQUE INDEX uq_user_roles_one_active ON public.user_roles USING btree (user_id) WHERE (is_active = true)"
            },
            {
              "name": "user_roles_pkey",
              "def": "CREATE UNIQUE INDEX user_roles_pkey ON public.user_roles USING btree (id)"
            },
            {
              "name": "user_roles_user_id_role_id_key",
              "def": "CREATE UNIQUE INDEX user_roles_user_id_role_id_key ON public.user_roles USING btree (user_id, role_id)"
            }
          ],
          "constraints": [
            {
              "name": "user_roles_assigned_by_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (assigned_by) REFERENCES auth.users(id) ON DELETE SET NULL"
            },
            {
              "name": "user_roles_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (id)"
            },
            {
              "name": "user_roles_role_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (role_id) REFERENCES roles(id) ON DELETE CASCADE"
            },
            {
              "name": "user_roles_user_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE"
            },
            {
              "name": "user_roles_user_id_role_id_key",
              "type": "u",
              "definition": "UNIQUE (user_id, role_id)"
            }
          ],
          "triggers": [
            {
              "name": "audit_user_roles_changes",
              "enabled": "O",
              "definition": "CREATE TRIGGER audit_user_roles_changes AFTER INSERT OR DELETE OR UPDATE ON user_roles FOR EACH ROW EXECUTE FUNCTION tg_audit_permission_change()",
              "function_name": "tg_audit_permission_change"
            },
            {
              "name": "set_user_roles_updated_at",
              "enabled": "O",
              "definition": "CREATE TRIGGER set_user_roles_updated_at BEFORE UPDATE ON user_roles FOR EACH ROW EXECUTE FUNCTION set_updated_at()",
              "function_name": "set_updated_at"
            }
          ],
          "estimates": {
            "row_estimate": 8,
            "size_pretty": "184 kB",
            "size_bytes": 188416
          }
        },
        {
          "table": {
            "schema": "public",
            "name": "user_usage_counters"
          },
          "columns": [
            {
              "column_name": "user_id",
              "data_type": "uuid",
              "is_nullable": "NO",
              "default": null
            },
            {
              "column_name": "tasks",
              "data_type": "integer",
              "is_nullable": "NO",
              "default": "0"
            },
            {
              "column_name": "rewards",
              "data_type": "integer",
              "is_nullable": "NO",
              "default": "0"
            },
            {
              "column_name": "categories",
              "data_type": "integer",
              "is_nullable": "NO",
              "default": "0"
            },
            {
              "column_name": "updated_at",
              "data_type": "timestamp with time zone",
              "is_nullable": "NO",
              "default": "now()"
            }
          ],
          "rls": {
            "rls_enabled": true,
            "rls_forced": false
          },
          "policies": [
            {
              "policyname": "user_usage_counters_select_self",
              "command": "SELECT",
              "roles": ["authenticated"],
              "mode": "PERMISSIVE",
              "using": "(( SELECT auth.uid() AS uid) = user_id)",
              "with_check": null
            }
          ],
          "indexes": [
            {
              "name": "user_usage_counters_pkey",
              "def": "CREATE UNIQUE INDEX user_usage_counters_pkey ON public.user_usage_counters USING btree (user_id)"
            }
          ],
          "constraints": [
            {
              "name": "user_usage_counters_pkey",
              "type": "p",
              "definition": "PRIMARY KEY (user_id)"
            },
            {
              "name": "user_usage_counters_user_id_fkey",
              "type": "f",
              "definition": "FOREIGN KEY (user_id) REFERENCES auth.users(id) ON DELETE CASCADE"
            }
          ],
          "triggers": [],
          "estimates": {
            "row_estimate": 5,
            "size_pretty": "56 kB",
            "size_bytes": 57344
          }
        }
      ],
      "storage_objects": {
        "table": {
          "schema": "storage",
          "name": "objects"
        },
        "columns": [
          {
            "column_name": "id",
            "data_type": "uuid",
            "is_nullable": "NO",
            "default": "gen_random_uuid()"
          },
          {
            "column_name": "bucket_id",
            "data_type": "text",
            "is_nullable": "YES",
            "default": null
          },
          {
            "column_name": "name",
            "data_type": "text",
            "is_nullable": "YES",
            "default": null
          },
          {
            "column_name": "owner",
            "data_type": "uuid",
            "is_nullable": "YES",
            "default": null
          },
          {
            "column_name": "created_at",
            "data_type": "timestamp with time zone",
            "is_nullable": "YES",
            "default": "now()"
          },
          {
            "column_name": "updated_at",
            "data_type": "timestamp with time zone",
            "is_nullable": "YES",
            "default": "now()"
          },
          {
            "column_name": "last_accessed_at",
            "data_type": "timestamp with time zone",
            "is_nullable": "YES",
            "default": "now()"
          },
          {
            "column_name": "metadata",
            "data_type": "jsonb",
            "is_nullable": "YES",
            "default": null
          },
          {
            "column_name": "path_tokens",
            "data_type": "ARRAY",
            "is_nullable": "YES",
            "default": null
          },
          {
            "column_name": "version",
            "data_type": "text",
            "is_nullable": "YES",
            "default": null
          },
          {
            "column_name": "owner_id",
            "data_type": "text",
            "is_nullable": "YES",
            "default": null
          },
          {
            "column_name": "user_metadata",
            "data_type": "jsonb",
            "is_nullable": "YES",
            "default": null
          },
          {
            "column_name": "level",
            "data_type": "integer",
            "is_nullable": "YES",
            "default": null
          }
        ],
        "rls": {
          "rls_enabled": true,
          "rls_forced": false
        },
        "policies": [
          {
            "policyname": "avatars_delete_admin",
            "command": "DELETE",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'avatars'::text) AND is_admin())",
            "with_check": null
          },
          {
            "policyname": "avatars_delete_own_files",
            "command": "DELETE",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'avatars'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))",
            "with_check": null
          },
          {
            "policyname": "avatars_select_admin",
            "command": "SELECT",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'avatars'::text) AND is_admin())",
            "with_check": null
          },
          {
            "policyname": "avatars_select_own_files",
            "command": "SELECT",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'avatars'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))",
            "with_check": null
          },
          {
            "policyname": "avatars_update_admin",
            "command": "UPDATE",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'avatars'::text) AND is_admin())",
            "with_check": "((bucket_id = 'avatars'::text) AND is_admin())"
          },
          {
            "policyname": "avatars_update_own_files",
            "command": "UPDATE",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'avatars'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))",
            "with_check": "((bucket_id = 'avatars'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))"
          },
          {
            "policyname": "avatars_upload_admin",
            "command": "INSERT",
            "roles": ["authenticated"],
            "using": null,
            "with_check": "((bucket_id = 'avatars'::text) AND is_admin())"
          },
          {
            "policyname": "avatars_upload_own_files",
            "command": "INSERT",
            "roles": ["authenticated"],
            "using": null,
            "with_check": "((bucket_id = 'avatars'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))"
          },
          {
            "policyname": "demo_images_delete_admin",
            "command": "DELETE",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'demo-images'::text) AND is_admin())",
            "with_check": null
          },
          {
            "policyname": "demo_images_insert_admin",
            "command": "INSERT",
            "roles": ["authenticated"],
            "using": null,
            "with_check": "((bucket_id = 'demo-images'::text) AND is_admin())"
          },
          {
            "policyname": "demo_images_select_public",
            "command": "SELECT",
            "roles": ["public"],
            "using": "(bucket_id = 'demo-images'::text)",
            "with_check": null
          },
          {
            "policyname": "demo_images_update_admin",
            "command": "UPDATE",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'demo-images'::text) AND is_admin())",
            "with_check": null
          },
          {
            "policyname": "images_delete_admin",
            "command": "DELETE",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'images'::text) AND is_admin())",
            "with_check": null
          },
          {
            "policyname": "images_delete_own_files",
            "command": "DELETE",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'images'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))",
            "with_check": null
          },
          {
            "policyname": "images_select_admin",
            "command": "SELECT",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'images'::text) AND is_admin())",
            "with_check": null
          },
          {
            "policyname": "images_select_own_files",
            "command": "SELECT",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'images'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))",
            "with_check": null
          },
          {
            "policyname": "images_update_admin",
            "command": "UPDATE",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'images'::text) AND is_admin())",
            "with_check": "((bucket_id = 'images'::text) AND is_admin())"
          },
          {
            "policyname": "images_update_own_files",
            "command": "UPDATE",
            "roles": ["authenticated"],
            "using": "((bucket_id = 'images'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))",
            "with_check": "((bucket_id = 'images'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))"
          },
          {
            "policyname": "images_upload_admin",
            "command": "INSERT",
            "roles": ["authenticated"],
            "using": null,
            "with_check": "((bucket_id = 'images'::text) AND is_admin())"
          },
          {
            "policyname": "images_upload_own_files",
            "command": "INSERT",
            "roles": ["authenticated"],
            "using": null,
            "with_check": "((bucket_id = 'images'::text) AND (split_part(name, '/'::text, 1) = (auth.uid())::text))"
          }
        ],
        "indexes": [
          {
            "name": "bucketid_objname",
            "def": "CREATE UNIQUE INDEX bucketid_objname ON storage.objects USING btree (bucket_id, name)"
          },
          {
            "name": "idx_name_bucket_level_unique",
            "def": "CREATE UNIQUE INDEX idx_name_bucket_level_unique ON storage.objects USING btree (name COLLATE \"C\", bucket_id, level)"
          },
          {
            "name": "idx_objects_bucket_id_name",
            "def": "CREATE INDEX idx_objects_bucket_id_name ON storage.objects USING btree (bucket_id, name COLLATE \"C\")"
          },
          {
            "name": "idx_objects_lower_name",
            "def": "CREATE INDEX idx_objects_lower_name ON storage.objects USING btree ((path_tokens[level]), lower(name) text_pattern_ops, bucket_id, level)"
          },
          {
            "name": "name_prefix_search",
            "def": "CREATE INDEX name_prefix_search ON storage.objects USING btree (name text_pattern_ops)"
          },
          {
            "name": "objects_bucket_id_level_idx",
            "def": "CREATE UNIQUE INDEX objects_bucket_id_level_idx ON storage.objects USING btree (bucket_id, level, name COLLATE \"C\")"
          },
          {
            "name": "objects_pkey",
            "def": "CREATE UNIQUE INDEX objects_pkey ON storage.objects USING btree (id)"
          }
        ],
        "constraints": [
          {
            "name": "objects_bucketId_fkey",
            "type": "f",
            "definition": "FOREIGN KEY (bucket_id) REFERENCES storage.buckets(id)"
          },
          {
            "name": "objects_pkey",
            "type": "p",
            "definition": "PRIMARY KEY (id)"
          }
        ],
        "triggers": [
          {
            "name": "objects_delete_delete_prefix",
            "enabled": "O",
            "definition": "CREATE TRIGGER objects_delete_delete_prefix AFTER DELETE ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.delete_prefix_hierarchy_trigger()",
            "function_name": "storage.delete_prefix_hierarchy_trigger"
          },
          {
            "name": "objects_insert_create_prefix",
            "enabled": "O",
            "definition": "CREATE TRIGGER objects_insert_create_prefix BEFORE INSERT ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.objects_insert_prefix_trigger()",
            "function_name": "storage.objects_insert_prefix_trigger"
          },
          {
            "name": "objects_update_create_prefix",
            "enabled": "O",
            "definition": "CREATE TRIGGER objects_update_create_prefix BEFORE UPDATE ON storage.objects FOR EACH ROW WHEN (new.name <> old.name OR new.bucket_id <> old.bucket_id) EXECUTE FUNCTION storage.objects_update_prefix_trigger()",
            "function_name": "storage.objects_update_prefix_trigger"
          },
          {
            "name": "update_objects_updated_at",
            "enabled": "O",
            "definition": "CREATE TRIGGER update_objects_updated_at BEFORE UPDATE ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.update_updated_at_column()",
            "function_name": "storage.update_updated_at_column"
          }
        ],
        "data_preview": [
          {
            "id": "4dd7654d-e244-4506-a938-49f7561c45ee",
            "bucket_id": "images",
            "name": "fbe8d0fe-347d-4b32-86f1-af640f75a307/task_images/1759389295798-tache_1759389293563.png",
            "owner": "fbe8d0fe-347d-4b32-86f1-af640f75a307",
            "created_at": "2025-10-02T07:14:56.456764+00:00",
            "updated_at": "2025-10-02T07:14:56.456764+00:00",
            "last_accessed_at": "2025-10-02T07:14:56.456764+00:00",
            "metadata": {
              "eTag": "\"24f76c09736602d1b8e60fd1feed3b14\"",
              "size": 21726,
              "mimetype": "image/png",
              "cacheControl": "max-age=31536000",
              "lastModified": "2025-10-02T07:14:57.000Z",
              "contentLength": 21726,
              "httpStatusCode": 200
            },
            "path_tokens": [
              "fbe8d0fe-347d-4b32-86f1-af640f75a307",
              "task_images",
              "1759389295798-tache_1759389293563.png"
            ],
            "version": "e8433b9b-8e37-4c5f-9817-a5fab2d4d6bf",
            "owner_id": "fbe8d0fe-347d-4b32-86f1-af640f75a307",
            "user_metadata": {},
            "level": 3
          },
          {
            "id": "3a9d9519-6bd0-4b68-9b64-06dd104d2843",
            "bucket_id": "images",
            "name": "fbe8d0fe-347d-4b32-86f1-af640f75a307/reward_images/1759396637618-tache_1759396636065.png",
            "owner": "fbe8d0fe-347d-4b32-86f1-af640f75a307",
            "created_at": "2025-10-02T09:17:18.075644+00:00",
            "updated_at": "2025-10-02T09:17:18.075644+00:00",
            "last_accessed_at": "2025-10-02T09:17:18.075644+00:00",
            "metadata": {
              "eTag": "\"fc3eb7b2f9dd3a75f443d3ee6a8764cf\"",
              "size": 27784,
              "mimetype": "image/png",
              "cacheControl": "max-age=31536000",
              "lastModified": "2025-10-02T09:17:19.000Z",
              "contentLength": 27784,
              "httpStatusCode": 200
            },
            "path_tokens": [
              "fbe8d0fe-347d-4b32-86f1-af640f75a307",
              "reward_images",
              "1759396637618-tache_1759396636065.png"
            ],
            "version": "9249d074-0425-48fa-9b9b-ff6f6bb4763f",
            "owner_id": "fbe8d0fe-347d-4b32-86f1-af640f75a307",
            "user_metadata": {},
            "level": 3
          },
          {
            "id": "6d3b2b99-3852-41c1-b72a-a214d93814b7",
            "bucket_id": "demo-images",
            "name": "pajamas.png",
            "owner": null,
            "created_at": "2025-09-12T12:05:49.593396+00:00",
            "updated_at": "2025-09-12T12:08:13.671867+00:00",
            "last_accessed_at": "2025-09-12T12:05:49.593396+00:00",
            "metadata": {
              "eTag": "\"1104e0b3ac90ef899e0ba9e378492fc9\"",
              "size": 25920,
              "mimetype": "image/png",
              "cacheControl": "max-age=3600",
              "lastModified": "2025-09-12T12:08:14.000Z",
              "contentLength": 25920,
              "httpStatusCode": 200
            },
            "path_tokens": ["pajamas.png"],
            "version": "501cbb72-931d-4ff5-b1b1-46e65cfcd37f",
            "owner_id": null,
            "user_metadata": null,
            "level": 1
          },
          {
            "id": "9c4e5a42-6024-4417-8412-bad13157d773",
            "bucket_id": "demo-images",
            "name": "brush-teeth.png",
            "owner": null,
            "created_at": "2025-09-12T12:17:27.736072+00:00",
            "updated_at": "2025-09-12T12:17:27.736072+00:00",
            "last_accessed_at": "2025-09-12T12:17:27.736072+00:00",
            "metadata": {
              "eTag": "\"065f2ed6bee3152eaf78602a808fc7e6-1\"",
              "size": 35445,
              "mimetype": "image/png",
              "cacheControl": "max-age=3600",
              "lastModified": "2025-09-12T12:17:28.000Z",
              "contentLength": 35445,
              "httpStatusCode": 200
            },
            "path_tokens": ["brush-teeth.png"],
            "version": "3b92b445-7034-44a1-9e8e-b29157ae31f4",
            "owner_id": null,
            "user_metadata": null,
            "level": 1
          },
          {
            "id": "672a7929-5ab8-4c68-91bb-6f3342878dfe",
            "bucket_id": "demo-images",
            "name": "wash-hands.png",
            "owner": null,
            "created_at": "2025-09-12T13:11:57.892285+00:00",
            "updated_at": "2025-09-12T13:11:57.892285+00:00",
            "last_accessed_at": "2025-09-12T13:11:57.892285+00:00",
            "metadata": {
              "eTag": "\"5366c1311562f3c4172f2ef0bd8d60c1-1\"",
              "size": 30591,
              "mimetype": "image/png",
              "cacheControl": "max-age=3600",
              "lastModified": "2025-09-12T13:11:58.000Z",
              "contentLength": 30591,
              "httpStatusCode": 200
            },
            "path_tokens": ["wash-hands.png"],
            "version": "b5aa3a88-a776-4e6e-95c2-ffc81bac0dad",
            "owner_id": null,
            "user_metadata": null,
            "level": 1
          },
          {
            "id": "885aeda5-bb66-4dd8-a1b2-615997881bb3",
            "bucket_id": "demo-images",
            "name": "tidy-room.png",
            "owner": null,
            "created_at": "2025-09-12T13:11:57.979009+00:00",
            "updated_at": "2025-09-12T13:11:57.979009+00:00",
            "last_accessed_at": "2025-09-12T13:11:57.979009+00:00",
            "metadata": {
              "eTag": "\"07cab9da0285140b64892570822d6b33-1\"",
              "size": 20052,
              "mimetype": "image/png",
              "cacheControl": "max-age=3600",
              "lastModified": "2025-09-12T13:11:58.000Z",
              "contentLength": 20052,
              "httpStatusCode": 200
            },
            "path_tokens": ["tidy-room.png"],
            "version": "25195321-2c6c-4a31-8234-b53b4554bc67",
            "owner_id": null,
            "user_metadata": null,
            "level": 1
          },
          {
            "id": "5abaca5a-9837-4949-b8cc-a3d8cde590df",
            "bucket_id": "demo-images",
            "name": "read-book.png",
            "owner": null,
            "created_at": "2025-09-12T13:12:44.352023+00:00",
            "updated_at": "2025-09-12T13:12:44.352023+00:00",
            "last_accessed_at": "2025-09-12T13:12:44.352023+00:00",
            "metadata": {
              "eTag": "\"add4c4758f0c93a07d83aa6965c9efd0-1\"",
              "size": 42191,
              "mimetype": "image/png",
              "cacheControl": "max-age=3600",
              "lastModified": "2025-09-12T13:12:44.000Z",
              "contentLength": 42191,
              "httpStatusCode": 200
            },
            "path_tokens": ["read-book.png"],
            "version": "8aad2f0b-062c-44f6-adc6-a4039b235c5e",
            "owner_id": null,
            "user_metadata": null,
            "level": 1
          },
          {
            "id": "611aca2d-9fad-4ad0-b2f5-9c2b0b251b27",
            "bucket_id": "demo-images",
            "name": "music.png",
            "owner": null,
            "created_at": "2025-09-12T16:53:42.722844+00:00",
            "updated_at": "2025-09-12T16:53:42.722844+00:00",
            "last_accessed_at": "2025-09-12T16:53:42.722844+00:00",
            "metadata": {
              "eTag": "\"c0b96776f9c1394e5cb3559055bae0d6-1\"",
              "size": 38473,
              "mimetype": "image/png",
              "cacheControl": "max-age=3600",
              "lastModified": "2025-09-12T16:53:43.000Z",
              "contentLength": 38473,
              "httpStatusCode": 200
            },
            "path_tokens": ["music.png"],
            "version": "540fe196-cdc8-4a8b-ad9f-c5fdc5a74c9e",
            "owner_id": null,
            "user_metadata": null,
            "level": 1
          },
          {
            "id": "cda4c80a-d2d3-45f3-b206-32dde597e01f",
            "bucket_id": "demo-images",
            "name": "hug.png",
            "owner": null,
            "created_at": "2025-09-12T16:53:42.749868+00:00",
            "updated_at": "2025-09-12T16:53:42.749868+00:00",
            "last_accessed_at": "2025-09-12T16:53:42.749868+00:00",
            "metadata": {
              "eTag": "\"15e7606a24b538bd506ceaa4c1eee457-1\"",
              "size": 47486,
              "mimetype": "image/png",
              "cacheControl": "max-age=3600",
              "lastModified": "2025-09-12T16:53:43.000Z",
              "contentLength": 47486,
              "httpStatusCode": 200
            },
            "path_tokens": ["hug.png"],
            "version": "a8a7466b-6448-4371-bed9-a39987104eb3",
            "owner_id": null,
            "user_metadata": null,
            "level": 1
          },
          {
            "id": "4a88f0b5-4af3-4c4a-a14a-7850554a1f78",
            "bucket_id": "demo-images",
            "name": "cartoon.png",
            "owner": null,
            "created_at": "2025-09-12T16:53:42.755625+00:00",
            "updated_at": "2025-09-12T16:53:42.755625+00:00",
            "last_accessed_at": "2025-09-12T16:53:42.755625+00:00",
            "metadata": {
              "eTag": "\"736acc99621e270b00dfc47e868f25f6-1\"",
              "size": 34988,
              "mimetype": "image/png",
              "cacheControl": "max-age=3600",
              "lastModified": "2025-09-12T16:53:43.000Z",
              "contentLength": 34988,
              "httpStatusCode": 200
            },
            "path_tokens": ["cartoon.png"],
            "version": "aed16cce-6c37-4614-852e-b16209986c6f",
            "owner_id": null,
            "user_metadata": null,
            "level": 1
          },
          {
            "id": "591a47dd-97c6-4e55-b368-79ed8aa37ab8",
            "bucket_id": "demo-images",
            "name": "toy.png",
            "owner": null,
            "created_at": "2025-09-12T16:53:42.799604+00:00",
            "updated_at": "2025-09-12T16:53:42.799604+00:00",
            "last_accessed_at": "2025-09-12T16:53:42.799604+00:00",
            "metadata": {
              "eTag": "\"7661e679bfb65cedd4beaf261431ad8e-1\"",
              "size": 37801,
              "mimetype": "image/png",
              "cacheControl": "max-age=3600",
              "lastModified": "2025-09-12T16:53:43.000Z",
              "contentLength": 37801,
              "httpStatusCode": 200
            },
            "path_tokens": ["toy.png"],
            "version": "b3f71a22-f95b-4e0f-9826-4c31b54060e5",
            "owner_id": null,
            "user_metadata": null,
            "level": 1
          },
          {
            "id": "07c85f45-6ba0-4022-8aeb-855b3792bc6a",
            "bucket_id": "demo-images",
            "name": "candy.png",
            "owner": null,
            "created_at": "2025-09-12T16:53:43.23123+00:00",
            "updated_at": "2025-09-12T16:53:43.23123+00:00",
            "last_accessed_at": "2025-09-12T16:53:43.23123+00:00",
            "metadata": {
              "eTag": "\"a7a5e420720bebcad8f942263010ec38-1\"",
              "size": 29729,
              "mimetype": "image/png",
              "cacheControl": "max-age=3600",
              "lastModified": "2025-09-12T16:53:43.000Z",
              "contentLength": 29729,
              "httpStatusCode": 200
            },
            "path_tokens": ["candy.png"],
            "version": "b6092b88-bf09-4a2c-89e6-37509461fb7a",
            "owner_id": null,
            "user_metadata": null,
            "level": 1
          },
          {
            "id": "12d003df-2677-489c-a894-626b285308c5",
            "bucket_id": "demo-images",
            "name": "bravo.png",
            "owner": null,
            "created_at": "2025-09-12T16:57:27.096293+00:00",
            "updated_at": "2025-09-12T16:57:27.096293+00:00",
            "last_accessed_at": "2025-09-12T16:57:27.096293+00:00",
            "metadata": {
              "eTag": "\"4e8f7fa679025a1cc82553bca8d82a29-1\"",
              "size": 42078,
              "mimetype": "image/png",
              "cacheControl": "max-age=3600",
              "lastModified": "2025-09-12T16:57:25.000Z",
              "contentLength": 42078,
              "httpStatusCode": 200
            },
            "path_tokens": ["bravo.png"],
            "version": "9ee882d0-ae7c-48b7-a4cd-f3bd2c2952b0",
            "owner_id": null,
            "user_metadata": null,
            "level": 1
          },
          {
            "id": "88da8270-2d12-4d2e-85a4-33a2280c21a3",
            "bucket_id": "images",
            "name": "fbe8d0fe-347d-4b32-86f1-af640f75a307/reward_images/1759390363735-tache_1759390362609.png",
            "owner": "fbe8d0fe-347d-4b32-86f1-af640f75a307",
            "created_at": "2025-10-02T07:32:44.152996+00:00",
            "updated_at": "2025-10-02T07:32:44.152996+00:00",
            "last_accessed_at": "2025-10-02T07:32:44.152996+00:00",
            "metadata": {
              "eTag": "\"fc3eb7b2f9dd3a75f443d3ee6a8764cf\"",
              "size": 27784,
              "mimetype": "image/png",
              "cacheControl": "max-age=31536000",
              "lastModified": "2025-10-02T07:32:45.000Z",
              "contentLength": 27784,
              "httpStatusCode": 200
            },
            "path_tokens": [
              "fbe8d0fe-347d-4b32-86f1-af640f75a307",
              "reward_images",
              "1759390363735-tache_1759390362609.png"
            ],
            "version": "d940eb02-b0a9-44a3-9daa-e9a429c4119c",
            "owner_id": "fbe8d0fe-347d-4b32-86f1-af640f75a307",
            "user_metadata": {},
            "level": 3
          },
          {
            "id": "f71e9dc5-2216-4bac-bd3e-97d8aa66ab38",
            "bucket_id": "images",
            "name": "d691b0fd-6968-41f4-b307-233c2a2252c2/task_images/1759419226999-tache_1759419225339.png",
            "owner": "d691b0fd-6968-41f4-b307-233c2a2252c2",
            "created_at": "2025-10-02T15:33:47.840548+00:00",
            "updated_at": "2025-10-02T15:33:47.840548+00:00",
            "last_accessed_at": "2025-10-02T15:33:47.840548+00:00",
            "metadata": {
              "eTag": "\"65c46bb20bd6d427bdd473259b087bce\"",
              "size": 17627,
              "mimetype": "image/png",
              "cacheControl": "max-age=31536000",
              "lastModified": "2025-10-02T15:33:48.000Z",
              "contentLength": 17627,
              "httpStatusCode": 200
            },
            "path_tokens": [
              "d691b0fd-6968-41f4-b307-233c2a2252c2",
              "task_images",
              "1759419226999-tache_1759419225339.png"
            ],
            "version": "e0dfeb2c-b967-426d-b052-5bee581046dc",
            "owner_id": "d691b0fd-6968-41f4-b307-233c2a2252c2",
            "user_metadata": {},
            "level": 3
          },
          {
            "id": "3b683bdb-3397-4060-8018-987229ca6d15",
            "bucket_id": "images",
            "name": "d691b0fd-6968-41f4-b307-233c2a2252c2/reward_images/1759419244833-tache_1759419242768.png",
            "owner": "d691b0fd-6968-41f4-b307-233c2a2252c2",
            "created_at": "2025-10-02T15:34:05.280694+00:00",
            "updated_at": "2025-10-02T15:34:05.280694+00:00",
            "last_accessed_at": "2025-10-02T15:34:05.280694+00:00",
            "metadata": {
              "eTag": "\"9408d510e4f04a7fb4a343c11263d7ff\"",
              "size": 23485,
              "mimetype": "image/png",
              "cacheControl": "max-age=31536000",
              "lastModified": "2025-10-02T15:34:06.000Z",
              "contentLength": 23485,
              "httpStatusCode": 200
            },
            "path_tokens": [
              "d691b0fd-6968-41f4-b307-233c2a2252c2",
              "reward_images",
              "1759419244833-tache_1759419242768.png"
            ],
            "version": "747a6f20-af7b-400e-bd4a-77c5141a77e1",
            "owner_id": "d691b0fd-6968-41f4-b307-233c2a2252c2",
            "user_metadata": {},
            "level": 3
          }
        ]
      },
      "storage_buckets": {
        "table": {
          "schema": "storage",
          "name": "buckets"
        },
        "columns": [
          {
            "column_name": "id",
            "data_type": "text",
            "is_nullable": "NO",
            "default": null
          },
          {
            "column_name": "name",
            "data_type": "text",
            "is_nullable": "NO",
            "default": null
          },
          {
            "column_name": "owner",
            "data_type": "uuid",
            "is_nullable": "YES",
            "default": null
          },
          {
            "column_name": "created_at",
            "data_type": "timestamp with time zone",
            "is_nullable": "YES",
            "default": "now()"
          },
          {
            "column_name": "updated_at",
            "data_type": "timestamp with time zone",
            "is_nullable": "YES",
            "default": "now()"
          },
          {
            "column_name": "public",
            "data_type": "boolean",
            "is_nullable": "YES",
            "default": "false"
          },
          {
            "column_name": "avif_autodetection",
            "data_type": "boolean",
            "is_nullable": "YES",
            "default": "false"
          },
          {
            "column_name": "file_size_limit",
            "data_type": "bigint",
            "is_nullable": "YES",
            "default": null
          },
          {
            "column_name": "allowed_mime_types",
            "data_type": "ARRAY",
            "is_nullable": "YES",
            "default": null
          },
          {
            "column_name": "owner_id",
            "data_type": "text",
            "is_nullable": "YES",
            "default": null
          },
          {
            "column_name": "type",
            "data_type": "USER-DEFINED",
            "is_nullable": "NO",
            "default": "'STANDARD'::storage.buckettype"
          }
        ],
        "rls": {
          "rls_enabled": true,
          "rls_forced": false
        },
        "policies": [
          {
            "policyname": "buckets_admin_all",
            "command": "ALL",
            "roles": ["authenticated"],
            "using": "is_admin()",
            "with_check": "is_admin()"
          },
          {
            "policyname": "buckets_select_authenticated",
            "command": "SELECT",
            "roles": ["authenticated"],
            "using": "true",
            "with_check": null
          }
        ],
        "indexes": [
          {
            "name": "bname",
            "def": "CREATE UNIQUE INDEX bname ON storage.buckets USING btree (name)"
          },
          {
            "name": "buckets_pkey",
            "def": "CREATE UNIQUE INDEX buckets_pkey ON storage.buckets USING btree (id)"
          }
        ],
        "constraints": [
          {
            "name": "buckets_pkey",
            "type": "p",
            "definition": "PRIMARY KEY (id)"
          }
        ],
        "triggers": [
          {
            "name": "enforce_bucket_name_length_trigger",
            "enabled": "O",
            "definition": "CREATE TRIGGER enforce_bucket_name_length_trigger BEFORE INSERT OR UPDATE OF name ON storage.buckets FOR EACH ROW EXECUTE FUNCTION storage.enforce_bucket_name_length()",
            "function_name": "storage.enforce_bucket_name_length"
          }
        ],
        "data_preview": [
          {
            "id": "images",
            "name": "images",
            "owner": null,
            "created_at": "2025-07-24T07:49:53.183201+00:00",
            "updated_at": "2025-07-24T07:49:53.183201+00:00",
            "public": false,
            "avif_autodetection": false,
            "file_size_limit": null,
            "allowed_mime_types": null,
            "owner_id": null,
            "type": "STANDARD"
          },
          {
            "id": "avatars",
            "name": "avatars",
            "owner": null,
            "created_at": "2025-07-29T09:23:00.509638+00:00",
            "updated_at": "2025-07-29T09:23:00.509638+00:00",
            "public": false,
            "avif_autodetection": false,
            "file_size_limit": null,
            "allowed_mime_types": null,
            "owner_id": null,
            "type": "STANDARD"
          },
          {
            "id": "demo-images",
            "name": "demo-images",
            "owner": null,
            "created_at": "2025-09-12T12:03:19.590071+00:00",
            "updated_at": "2025-09-12T12:03:19.590071+00:00",
            "public": true,
            "avif_autodetection": false,
            "file_size_limit": 5242880,
            "allowed_mime_types": [
              "image/jpeg",
              "image/png",
              "image/webp",
              "image/gif"
            ],
            "owner_id": null,
            "type": "STANDARD"
          }
        ]
      },
      "extensions": [
        {
          "extension": "pg_graphql",
          "version": "1.5.11",
          "schema": "graphql"
        },
        {
          "extension": "pg_stat_statements",
          "version": "1.11",
          "schema": "extensions"
        },
        {
          "extension": "pgcrypto",
          "version": "1.3",
          "schema": "extensions"
        },
        {
          "extension": "plpgsql",
          "version": "1.0",
          "schema": "pg_catalog"
        },
        {
          "extension": "supabase_vault",
          "version": "0.3.1",
          "schema": "vault"
        },
        {
          "extension": "uuid-ossp",
          "version": "1.1",
          "schema": "extensions"
        }
      ],
      "event_triggers": [
        {
          "trigger_name": "graphql_watch_ddl",
          "enabled": "O",
          "event": "ddl_command_end",
          "function_name": "graphql.increment_schema_version"
        },
        {
          "trigger_name": "graphql_watch_drop",
          "enabled": "O",
          "event": "sql_drop",
          "function_name": "graphql.increment_schema_version"
        },
        {
          "trigger_name": "issue_graphql_placeholder",
          "enabled": "O",
          "event": "sql_drop",
          "function_name": "set_graphql_placeholder"
        },
        {
          "trigger_name": "issue_pg_cron_access",
          "enabled": "O",
          "event": "ddl_command_end",
          "function_name": "grant_pg_cron_access"
        },
        {
          "trigger_name": "issue_pg_graphql_access",
          "enabled": "O",
          "event": "ddl_command_end",
          "function_name": "grant_pg_graphql_access"
        },
        {
          "trigger_name": "issue_pg_net_access",
          "enabled": "O",
          "event": "ddl_command_end",
          "function_name": "grant_pg_net_access"
        },
        {
          "trigger_name": "pgrst_ddl_watch",
          "enabled": "O",
          "event": "ddl_command_end",
          "function_name": "pgrst_ddl_watch"
        },
        {
          "trigger_name": "pgrst_drop_watch",
          "enabled": "O",
          "event": "sql_drop",
          "function_name": "pgrst_drop_watch"
        }
      ],
      "publications": [
        {
          "publication": "supabase_realtime",
          "alltables": false,
          "insert": true,
          "update": true,
          "delete": true,
          "truncate": true,
          "viaroot": false
        },
        {
          "publication": "supabase_realtime_messages_publication",
          "alltables": false,
          "insert": true,
          "update": true,
          "delete": true,
          "truncate": true,
          "viaroot": false
        }
      ],
      "publication_tables": [
        {
          "publication": "supabase_realtime_messages_publication",
          "schema": "realtime",
          "table": "messages"
        }
      ],
      "fdw_servers": null,
      "fdw_user_mappings": null,
      "foreign_tables": null,
      "instance_settings": [
        {
          "name": "DateStyle",
          "setting": "ISO, MDY",
          "unit": null,
          "context": "user",
          "vartype": "string"
        },
        {
          "name": "log_min_duration_statement",
          "setting": "-1",
          "unit": "ms",
          "context": "superuser",
          "vartype": "integer"
        },
        {
          "name": "log_statement",
          "setting": "ddl",
          "unit": null,
          "context": "superuser",
          "vartype": "enum"
        },
        {
          "name": "max_connections",
          "setting": "60",
          "unit": null,
          "context": "postmaster",
          "vartype": "integer"
        },
        {
          "name": "row_security",
          "setting": "on",
          "unit": null,
          "context": "user",
          "vartype": "bool"
        },
        {
          "name": "search_path",
          "setting": "\"\\$user\", public, extensions",
          "unit": null,
          "context": "user",
          "vartype": "string"
        },
        {
          "name": "server_version",
          "setting": "17.6",
          "unit": null,
          "context": "internal",
          "vartype": "string"
        },
        {
          "name": "shared_preload_libraries",
          "setting": "pg_stat_statements, pgaudit, plpgsql, plpgsql_check, pg_cron, pg_net, pgsodium, auto_explain, pg_tle, plan_filter, supabase_vault",
          "unit": null,
          "context": "postmaster",
          "vartype": "string"
        },
        {
          "name": "TimeZone",
          "setting": "UTC",
          "unit": null,
          "context": "user",
          "vartype": "string"
        }
      ]
    }
  }
]
